import{a as Me,b as Ce,c as ei,d as We,e as ti,f as ni}from"./chunk-QTJOCEBO.js";import{a as Pe,b as re,c as Xn,d as At}from"./chunk-2HGWPNOR.js";import{a as ii,b as ri,c as oi,d as ai,e as li,f as Ge}from"./chunk-335G52LP.js";import{$ as W,A as Ne,B as Zn,C as jt,D as X,E as G,F as Z,G as J,J as ye,K as he,P as U,S as q,T as H,W as ee,X as te,Z as R,_ as j,aa as O,ba as B,ca as Ve,da as ve,fa as Wt,ga as _t,ha as ft,qa as ht,ra as z,v as Ut,w as Ft,x as ut,y as se,z as gt}from"./chunk-NXZNIJBN.js";import{Cb as wt,F as Hn,Oa as M,Ob as dt,Rb as V,Sa as $,Sb as N,Ta as Bt,Xb as Q,Yb as A,_a as zn,a as Wn,b as pt,c as Te,db as Y,gb as D,i as mt,ib as k,l as P,nb as Yn,ob as Qn,pb as Gn,q as Ie,sb as L,ub as Jn,vb as Kn,x as $n,z as qn}from"./chunk-EFEB7SMV.js";import{$ as Dn,$b as it,Ab as u,Ac as x,Bb as r,Cb as o,Db as h,Hb as An,Ib as Un,Kb as C,Ob as _,Pb as p,Qa as Vn,Ta as c,Tb as Be,Ub as Ae,Vb as Ue,Y as Lt,Yb as Fn,Z as Nn,Zb as Rt,a as kt,aa as kn,ac as Ot,ba as Vt,bc as l,cb as w,cc as f,dc as K,e as Ee,ec as ke,fc as jn,ga as m,gc as y,ha as d,hb as I,hc as v,ia as Ln,ib as Rn,ic as S,jb as On,lb as ct,lc as F,mb as Bn,mc as E,nb as b,ua as fn,ub as hn,wc as Fe,yc as je}from"./chunk-ZDEZPEUG.js";var ne=Ee(Pe());var Ti=["dt"],Ii=()=>[10,20,30],Pi=()=>({"min-width":"70rem"});function Ni(a,t){if(a&1){let e=C();r(0,"div",8)(1,"p-button",9),_("onClick",function(){m(e);let i=p();return d(i.openNewUserDialog())}),o(),r(2,"p-button",10),_("onClick",function(){m(e);let i=p();return d(i.deleteSelectedUsers())}),o()()}if(a&2){let e=p();c(2),u("disabled",!e.selectedUsers.length)}}function Di(a,t){if(a&1){let e=C();r(0,"p-select",17),S("ngModelChange",function(i){m(e);let s=p(2);return v(s.selectedCampus,i)||(s.selectedCampus=i),d(i)}),_("onChange",function(){m(e);let i=p(2);return d(i.filterUsers())}),o()}if(a&2){let e=p(2);y("ngModel",e.selectedCampus),u("options",e.campuses)("showClear",!0)}}function ki(a,t){if(a&1){let e=C();r(0,"div",8),b(1,Di,1,3,"p-select",11),r(2,"p-iconfield"),h(3,"p-inputicon",12),r(4,"input",13),S("ngModelChange",function(i){m(e);let s=p();return v(s.searchValue,i)||(s.searchValue=i),d(i)}),_("input",function(){m(e);let i=p();return d(i.filterUsers())}),o()(),r(5,"p-button",14),_("onClick",function(){m(e);let i=p();return d(i.exportToExcel())}),o(),r(6,"p-button",15),_("onClick",function(){m(e);let i=p();return d(i.exportToPdf())}),o(),r(7,"p-button",16),_("onClick",function(){m(e);let i=p();return d(i.printUsers())}),o()()}if(a&2){let e=p();c(),u("ngIf",e.isSuperAdmin()),c(3),y("ngModel",e.searchValue),c(),u("rounded",!0)("text",!0),c(),u("rounded",!0)("text",!0),c(),u("rounded",!0)("text",!0)}}function Li(a,t){a&1&&(r(0,"tr")(1,"th",18),h(2,"p-tableHeaderCheckbox"),o(),r(3,"th",19),l(4,"ID "),h(5,"p-sortIcon",20),o(),r(6,"th",21),l(7,"Name "),h(8,"p-sortIcon",22),o(),r(9,"th",23),l(10,"Campus "),h(11,"p-sortIcon",24),o(),r(12,"th",25),l(13,"Role "),h(14,"p-sortIcon",26),o(),r(15,"th",27),l(16,"Status "),h(17,"p-sortIcon",28),o(),r(18,"th",29),l(19,"Actions"),o()())}function Vi(a,t){if(a&1){let e=C();r(0,"tr")(1,"td",18),h(2,"p-tableCheckbox",30),o(),r(3,"td"),l(4),o(),r(5,"td"),l(6),o(),r(7,"td"),l(8),o(),r(9,"td"),l(10),o(),r(11,"td"),h(12,"p-tag",31),o(),r(13,"td")(14,"div",32)(15,"p-button",33),_("onClick",function(){let i=m(e).$implicit,s=p();return d(s.viewUser(i))}),o(),r(16,"p-button",34),_("onClick",function(){let i=m(e).$implicit,s=p();return d(s.editUser(i))}),o(),r(17,"p-button",35),_("onClick",function(){let i=m(e).$implicit,s=p();return d(s.deleteUser(i))}),o()()()()}if(a&2){let e=t.$implicit;c(2),u("value",e),c(2),f(e.userId),c(2),jn("",e.firstName," ",e.middleName||""," ",e.lastName),c(2),f((e.campus==null?null:e.campus.campusName)||"N/A"),c(2),f(e.role),c(2),u("value",e.isActive?"Active":"Inactive")("severity",e.isActive?"success":"danger"),c(3),u("rounded",!0)("text",!0),c(),u("rounded",!0)("text",!0),c(),u("rounded",!0)("text",!0)}}function Ri(a,t){a&1&&(r(0,"tr")(1,"td",36),l(2,"No users found"),o()())}var $t=class a{constructor(t,e,n){this.userService=t;this.messageService=e;this.userContextService=n}table;users=[];filteredUsers=[];selectedUsers=[];searchValue="";selectedCampus=null;loading=!1;currentUserRole="";campuses=[];departments=[];ngOnInit(){this.loadUsers(),this.loadCurrentUserRole(),this.loadCampuses(),this.loadDepartments()}loadDepartments(){this.userService.getDepartments().subscribe({next:t=>{this.departments=Array.isArray(t)?t:t.data||[]},error:t=>{console.error("Error loading departments:",t)}})}loadCampuses(){this.userService.getCampuses().subscribe({next:t=>{this.campuses=Array.isArray(t)?t:t.data||[]},error:t=>{console.error("Error loading campuses:",t)}})}loadCurrentUserRole(){let t=localStorage.getItem("currentUser");if(t)try{let n=JSON.parse(t);if(this.currentUserRole=n.role||"",this.currentUserRole)return}catch(n){console.error("Error parsing currentUser:",n)}let e=this.userContextService.getUserId();e&&this.userService.getUserById(e).subscribe({next:n=>{this.currentUserRole=n.role||""},error:n=>{console.error("Error loading current user:",n)}})}loadUsers(){this.loading=!0,this.userService.getAllUsers().subscribe({next:t=>{this.users=Array.isArray(t)?t:t.data||[],this.filteredUsers=[...this.users],this.loading=!1},error:t=>{console.error("Error loading users:",t),ne.default.fire({title:"Error",text:"Failed to load users: "+(t.error?.message||t.message),icon:"error"}),this.loading=!1}})}isSuperAdmin(){return this.currentUserRole==="SuperAdmin"}isCampusAdmin(){return this.currentUserRole==="CampusAdmin"}canResetPassword(){return this.isSuperAdmin()||this.isCampusAdmin()}resetPassword(t){ne.default.fire({title:"Reset Password",html:`
                <div style="text-align: center;">
                    <i class="pi pi-exclamation-triangle" style="font-size: 48px; color: #f59e0b; margin-bottom: 16px;"></i>
                    <p style="margin: 0; color: #666; font-size: 14px;">Are you sure you want to reset the password for</p>
                    <p style="margin: 8px 0 0 0; font-weight: 600; color: #333; font-size: 16px;">${t.firstName} ${t.lastName}</p>
                    <p style="margin: 8px 0 0 0; color: #888; font-size: 13px;">${t.email}</p>
                </div>
            `,width:"400px",showCancelButton:!0,confirmButtonText:"Yes, Reset Password",cancelButtonText:"Cancel",confirmButtonColor:"#f59e0b",cancelButtonColor:"#6b7280"}).then(e=>{e.isConfirmed&&this.userService.resetPassword(t.userId).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"Success",detail:`Password reset successfully for ${t.firstName} ${t.lastName}`})},error:n=>{this.messageService.add({severity:"error",summary:"Error",detail:"Failed to reset password: "+(n.error?.message||n.message)})}})})}filterUsers(){let t=[...this.users];if(this.selectedCampus&&(t=t.filter(e=>e.campus?.campusId===this.selectedCampus)),this.searchValue.trim()){let e=this.searchValue.toLowerCase();t=t.filter(n=>String(n.userId||"").toLowerCase().includes(e)||String(n.firstName||"").toLowerCase().includes(e)||String(n.lastName||"").toLowerCase().includes(e)||String(n.middleName||"").toLowerCase().includes(e)||String(n.campus?.campusName||"").toLowerCase().includes(e)||String(n.role||"").toLowerCase().includes(e))}this.filteredUsers=t}onSelectionChange(t){this.selectedUsers&&this.selectedUsers.length>0}viewUser(t){let e=new Date(t.userCreated).toLocaleDateString();ne.default.fire({title:t.firstName+" "+(t.middleName||"")+" "+t.lastName,html:`
                <div style="text-align: left;">
                    <p><strong>Email:</strong> ${t.email}</p>
                    <p><strong>Contact Number:</strong> ${t.contactNumber||"N/A"}</p>
                    <p><strong>Role:</strong> ${t.role||"N/A"}</p>
                    <p><strong>Active:</strong> <span style="color: ${t.isActive?"green":"red"}">${t.isActive?"Yes":"No"}</span></p>
                    <p><strong>Created:</strong> ${e}</p>
                </div>
            `,icon:"info",confirmButtonText:"Close"})}editUser(t){let e={firstName:t.firstName,middleName:t.middleName,lastName:t.lastName,email:t.email,contactNumber:t.contactNumber,role:t.role,isActive:t.isActive};ne.default.fire({title:"",titleText:"",html:`
                <div style="text-align: left; width: 100%; max-width: 700px; margin: 4 auto;">
                    <div style="background: #f5f5f5; color: #333; padding: 16px; margin: -16px -16px 16px -16px; border-radius: 8px 8px 0 0;">
                        <h2 style="margin: 0; font-size: 18px; font-weight: 600; letter-spacing: 0.5px;">\u270E Edit User</h2>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; margin-bottom: 16px;">
                        <div>
                            <label style="display: block; font-weight: 500; margin-bottom: 6px; color: #555; font-size: 13px;">First Name</label>
                            <input id="firstName" type="text" value="${e.firstName||""}" placeholder="First" style="width: 100%; padding: 8px 10px; border: none; border-bottom: 1.5px solid #e0e0e0; border-radius: 0; font-size: 13px; box-sizing: border-box; background: transparent; transition: border-color 0.2s;" onmouseover="this.style.borderBottomColor='#667eea'" onmouseout="this.style.borderBottomColor='#e0e0e0'" onfocus="this.style.borderBottomColor='#667eea'" onblur="this.style.borderBottomColor='#e0e0e0'" />
                        </div>
                        <div>
                            <label style="display: block; font-weight: 500; margin-bottom: 6px; color: #555; font-size: 13px;">Middle Name</label>
                            <input id="middleName" type="text" value="${e.middleName||""}" placeholder="Middle" style="width: 100%; padding: 8px 10px; border: none; border-bottom: 1.5px solid #e0e0e0; border-radius: 0; font-size: 13px; box-sizing: border-box; background: transparent; transition: border-color 0.2s;" onmouseover="this.style.borderBottomColor='#667eea'" onmouseout="this.style.borderBottomColor='#e0e0e0'" onfocus="this.style.borderBottomColor='#667eea'" onblur="this.style.borderBottomColor='#e0e0e0'" />
                        </div>
                        <div>
                            <label style="display: block; font-weight: 500; margin-bottom: 6px; color: #555; font-size: 13px;">Last Name</label>
                            <input id="lastName" type="text" value="${e.lastName||""}" placeholder="Last" style="width: 100%; padding: 8px 10px; border: none; border-bottom: 1.5px solid #e0e0e0; border-radius: 0; font-size: 13px; box-sizing: border-box; background: transparent; transition: border-color 0.2s;" onmouseover="this.style.borderBottomColor='#667eea'" onmouseout="this.style.borderBottomColor='#e0e0e0'" onfocus="this.style.borderBottomColor='#667eea'" onblur="this.style.borderBottomColor='#e0e0e0'" />
                        </div>
                    </div>
                    <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 12px; margin-bottom: 16px;">
                        <div>
                            <label style="display: block; font-weight: 500; margin-bottom: 6px; color: #555; font-size: 13px;">Email</label>
                            <input id="email" type="email" value="${e.email||""}" placeholder="email@example.com" style="width: 100%; padding: 8px 10px; border: none; border-bottom: 1.5px solid #e0e0e0; border-radius: 0; font-size: 13px; box-sizing: border-box; background: transparent; transition: border-color 0.2s;" onmouseover="this.style.borderBottomColor='#667eea'" onmouseout="this.style.borderBottomColor='#e0e0e0'" onfocus="this.style.borderBottomColor='#667eea'" onblur="this.style.borderBottomColor='#e0e0e0'" />
                        </div>
                        <div>
                            <label style="display: block; font-weight: 500; margin-bottom: 6px; color: #555; font-size: 13px;">Contact</label>
                            <input id="contactNumber" type="text" value="${e.contactNumber||""}" placeholder="+63" style="width: 100%; padding: 8px 10px; border: none; border-bottom: 1.5px solid #e0e0e0; border-radius: 0; font-size: 13px; box-sizing: border-box; background: transparent; transition: border-color 0.2s;" onmouseover="this.style.borderBottomColor='#667eea'" onmouseout="this.style.borderBottomColor='#e0e0e0'" onfocus="this.style.borderBottomColor='#667eea'" onblur="this.style.borderBottomColor='#e0e0e0'" />
                        </div>
                        <div>
                            <label style="display: block; font-weight: 500; margin-bottom: 6px; color: #555; font-size: 13px;">Role</label>
                            <select id="role" style="width: 100%; padding: 8px 10px; border: none; border-bottom: 1.5px solid #e0e0e0; border-radius: 0; font-size: 13px; box-sizing: border-box; background: transparent; cursor: pointer; transition: border-color 0.2s;" onfocus="this.style.borderBottomColor='#667eea'" onblur="this.style.borderBottomColor='#e0e0e0'">
                                <option value="CampusAdmin" ${e.role==="CampusAdmin"?"selected":""}>CampusAdmin</option>
                                <option value="Faculty" ${e.role==="Faculty"?"selected":""}>Faculty</option>
                                <option value="LabTech" ${e.role==="LabTech"?"selected":""}>LabTech</option>
                            </select>
                        </div>
                    </div>
                    <div style="display: flex; align-items: center; justify-content: space-between; padding-top: 12px; border-top: 1px solid #f0f0f0;">
                        <div style="display: flex; align-items: center; gap: 12px; cursor: pointer;" onclick="document.getElementById('isActive').click();">
                            <label style="font-weight: 500; color: #555; margin: 0; font-size: 13px; cursor: pointer;">Active Status</label>
                            <div style="position: relative; display: inline-block; width: 48px; height: 24px;">
                                <input id="isActive" type="checkbox" ${e.isActive?"checked":""} style="opacity: 0; width: 0; height: 0; cursor: pointer;" />
                                <span style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: ${e.isActive?"#667eea":"#ddd"}; transition: 0.3s; border-radius: 24px;"></span>
                                <span style="position: absolute; content: ''; height: 20px; width: 20px; left: ${e.isActive?"24px":"2px"}; bottom: 2px; background-color: white; transition: 0.3s; border-radius: 50%;"></span>
                            </div>
                            <span id="statusText" style="font-size: 12px; color: ${e.isActive?"#22c55e":"#ef4444"}; font-weight: 500;">${e.isActive?"Active":"Inactive"}</span>
                        </div>
                        ${this.canResetPassword()?`<button id="resetPasswordBtn" type="button" style="display: flex; align-items: center; gap: 6px; padding: 8px 14px; background: #f59e0b; color: white; border: none; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer; transition: background 0.2s;" onmouseover="this.style.background='#d97706'" onmouseout="this.style.background='#f59e0b'"><i class="pi pi-key" style="font-size: 12px;"></i> Reset Password</button>`:""}
                    </div>
                </div>
            `,width:"750px",showCancelButton:!0,confirmButtonText:"Save",cancelButtonText:"Cancel",confirmButtonColor:"#667eea",cancelButtonColor:"#e0e0e0",didOpen:()=>{let n=document.getElementById("firstName");n&&n.focus();let i=document.getElementById("isActive"),s=i?.parentElement?.parentElement,g=i?.parentElement?.querySelector("span:nth-child(2)"),T=i?.parentElement?.querySelector("span:nth-child(3)"),le=document.getElementById("statusText");i&&g&&T&&s&&(i.addEventListener("change",()=>{g.style.backgroundColor=i.checked?"#667eea":"#ddd",T.style.left=i.checked?"24px":"2px",le&&(le.textContent=i.checked?"Active":"Inactive",le.style.color=i.checked?"#22c55e":"#ef4444")}),s.addEventListener("click",oe=>{oe.target!==i&&(i.checked=!i.checked,i.dispatchEvent(new Event("change",{bubbles:!0})))}),g?.addEventListener("click",()=>{i.checked=!i.checked,i.dispatchEvent(new Event("change",{bubbles:!0}))}),T?.addEventListener("click",()=>{i.checked=!i.checked,i.dispatchEvent(new Event("change",{bubbles:!0}))}));let pe=document.getElementById("resetPasswordBtn");pe&&pe.addEventListener("click",oe=>{oe.preventDefault(),oe.stopPropagation(),ne.default.close(),setTimeout(()=>this.resetPassword(t),300)})}}).then(n=>{if(n.isConfirmed){let i=document.getElementById("firstName").value,s=document.getElementById("middleName").value,g=document.getElementById("lastName").value,T=document.getElementById("email").value,le=document.getElementById("contactNumber").value,pe=document.getElementById("role").value,oe=document.getElementById("isActive").checked,ie={firstName:i||t.firstName,middleName:s||t.middleName,lastName:g||t.lastName,email:T||t.email,contactNumber:le||t.contactNumber,role:pe||t.role,isActive:oe};this.userService.updateUser(t.userId,ie).subscribe({next:()=>{ne.default.fire({title:"Success!",text:"User updated successfully",icon:"success"}),this.loadUsers()},error:De=>{ne.default.fire({title:"Error",text:"Failed to update user: "+(De.error?.message||De.message),icon:"error"})}})}})}deleteUser(t){let e=t.userId||t.user_id;ne.default.fire({title:"Confirm Delete",text:"Are you sure you want to delete this user?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, Delete",cancelButtonText:"Cancel",confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d"}).then(n=>{n.isConfirmed&&this.userService.deleteUser(e).subscribe({next:()=>{ne.default.fire({title:"Deleted!",text:"User has been deleted successfully.",icon:"success"}),this.loadUsers()},error:i=>{console.error("Error deleting user:",e,i),ne.default.fire({title:"Error",text:"Failed to delete user: "+(i.error?.message||i.message),icon:"error"})}})})}openNewUserDialog(){let t=this.userContextService.getUserId();if(!t){let e=localStorage.getItem("currentUser");if(e){let n=JSON.parse(e);t=n.userId||n.user_id||n.id}}if(!t){ne.default.fire({title:"Error",text:"User ID not found. Please log in again.",icon:"error"});return}this.userService.getUserById(t).subscribe({next:e=>{sessionStorage.setItem("loggedInUserData",JSON.stringify(e)),this.showNewUserDialog()},error:e=>{console.error("Error fetching user data:",e),this.showNewUserDialog()}})}showNewUserDialog(){let t={userName:"",email:"",password:"",firstName:"",lastName:"",middleName:"",contactNumber:"",department:"",campus:"",role:"CampusAdmin",isActive:!0,isStaff:!1,isSuperUser:!1},e=this.userContextService.getUserId(),n=JSON.parse(sessionStorage.getItem("loggedInUserData")||"{}"),i=n.role||this.currentUserRole||"",s=i==="CampusAdmin",g=i==="SuperAdmin",T=n.campus?.campusId||n.campusId||"",le=n.campus?.campusName||n.campusName||"";!le&&T&&(le=this.campuses.find(ie=>ie.campusId===T)?.campusName||"");let pe=s?this.departments.filter(oe=>oe.campus?.campusId===T):this.departments;ne.default.fire({title:"",titleText:"",html:`
                <div style="text-align: left; width: 100%; max-width: 700px; margin: 0 auto;">
                    <div style="background: #f5f5f5; color: #333; padding: 16px; margin: -16px -16px 16px -16px; border-radius: 8px 8px 0 0;">
                        <h2 style="margin: 0; font-size: 18px; font-weight: 600; letter-spacing: 0.5px;">\u2795 Add New User</h2>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; margin-bottom: 16px;">
                        <div>
                            <label style="display: block; font-weight: 500; margin-bottom: 6px; color: #555; font-size: 13px;">First Name *</label>
                            <input id="newFirstName" type="text" placeholder="First" style="width: 100%; padding: 8px 10px; border: none; border-bottom: 1.5px solid #e0e0e0; border-radius: 0; font-size: 13px; box-sizing: border-box; background: transparent;" onfocus="this.style.borderBottomColor='#667eea'" onblur="this.style.borderBottomColor='#e0e0e0'" />
                        </div>
                        <div>
                            <label style="display: block; font-weight: 500; margin-bottom: 6px; color: #555; font-size: 13px;">Middle Name</label>
                            <input id="newMiddleName" type="text" placeholder="Middle" style="width: 100%; padding: 8px 10px; border: none; border-bottom: 1.5px solid #e0e0e0; border-radius: 0; font-size: 13px; box-sizing: border-box; background: transparent;" onfocus="this.style.borderBottomColor='#667eea'" onblur="this.style.borderBottomColor='#e0e0e0'" />
                        </div>
                        <div>
                            <label style="display: block; font-weight: 500; margin-bottom: 6px; color: #555; font-size: 13px;">Last Name *</label>
                            <input id="newLastName" type="text" placeholder="Last" style="width: 100%; padding: 8px 10px; border: none; border-bottom: 1.5px solid #e0e0e0; border-radius: 0; font-size: 13px; box-sizing: border-box; background: transparent;" onfocus="this.style.borderBottomColor='#667eea'" onblur="this.style.borderBottomColor='#e0e0e0'" />
                        </div>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; margin-bottom: 16px;">
                        <div>
                            <label style="display: block; font-weight: 500; margin-bottom: 6px; color: #555; font-size: 13px;">User ID *</label>
                            <input id="newUserId" type="text" placeholder="user123" style="width: 100%; padding: 8px 10px; border: none; border-bottom: 1.5px solid #e0e0e0; border-radius: 0; font-size: 13px; box-sizing: border-box; background: transparent;" onfocus="this.style.borderBottomColor='#667eea'" onblur="this.style.borderBottomColor='#e0e0e0'" />
                        </div>
                        <div>
                            <label style="display: block; font-weight: 500; margin-bottom: 6px; color: #555; font-size: 13px;">Username *</label>
                            <input id="newUserName" type="text" placeholder="username" style="width: 100%; padding: 8px 10px; border: none; border-bottom: 1.5px solid #e0e0e0; border-radius: 0; font-size: 13px; box-sizing: border-box; background: transparent;" onfocus="this.style.borderBottomColor='#667eea'" onblur="this.style.borderBottomColor='#e0e0e0'" />
                        </div>
                        <div>
                            <label style="display: block; font-weight: 500; margin-bottom: 6px; color: #555; font-size: 13px;">Email *</label>
                            <input id="newEmail" type="email" placeholder="email@example.com" style="width: 100%; padding: 8px 10px; border: none; border-bottom: 1.5px solid #e0e0e0; border-radius: 0; font-size: 13px; box-sizing: border-box; background: transparent;" onfocus="this.style.borderBottomColor='#667eea'" onblur="this.style.borderBottomColor='#e0e0e0'" />
                        </div>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 16px;">
                        <div>
                            <label style="display: block; font-weight: 500; margin-bottom: 6px; color: #555; font-size: 13px;">Password *</label>
                            <input id="newPassword" type="password" placeholder="\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022" style="width: 100%; padding: 8px 10px; border: none; border-bottom: 1.5px solid #e0e0e0; border-radius: 0; font-size: 13px; box-sizing: border-box; background: transparent;" onfocus="this.style.borderBottomColor='#667eea'" onblur="this.style.borderBottomColor='#e0e0e0'" />
                        </div>
                        <div>
                            <label style="display: block; font-weight: 500; margin-bottom: 6px; color: #555; font-size: 13px;">Contact Number</label>
                            <input id="newContactNumber" type="text" placeholder="+63" style="width: 100%; padding: 8px 10px; border: none; border-bottom: 1.5px solid #e0e0e0; border-radius: 0; font-size: 13px; box-sizing: border-box; background: transparent;" onfocus="this.style.borderBottomColor='#667eea'" onblur="this.style.borderBottomColor='#e0e0e0'" />
                        </div>
                    </div>
                    ${g?`
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 16px;">
                        <div>
                            <label style="display: block; font-weight: 500; margin-bottom: 6px; color: #555; font-size: 13px;">Campus *</label>
                            <select id="newCampus" style="width: 100%; padding: 8px 10px; border: none; border-bottom: 1.5px solid #e0e0e0; border-radius: 0; font-size: 13px; box-sizing: border-box; background: transparent;" onfocus="this.style.borderBottomColor='#667eea'" onblur="this.style.borderBottomColor='#e0e0e0'">
                                <option value="">-- Select Campus --</option>
                                ${this.campuses.map(oe=>`<option value="${oe.campusId}">${oe.campusName}</option>`).join("")}
                            </select>
                        </div>
                        <div>
                            <label style="display: block; font-weight: 500; margin-bottom: 6px; color: #555; font-size: 13px;">Role * <span style="color: #999; font-size: 11px;">(Auto)</span></label>
                            <input id="newRole" type="text" value="CampusAdmin" placeholder="Role" style="width: 100%; padding: 8px 10px; border: none; border-bottom: 1.5px solid #ccc; border-radius: 0; font-size: 13px; box-sizing: border-box; background: transparent; color: #999; cursor: not-allowed;" disabled />
                        </div>
                    </div>
                    `:s?`
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; margin-bottom: 16px;">
                        <div>
                            <label style="display: block; font-weight: 500; margin-bottom: 6px; color: #555; font-size: 13px;">Department *</label>
                            <select id="newDepartment" style="width: 100%; padding: 8px 10px; border: none; border-bottom: 1.5px solid #e0e0e0; border-radius: 0; font-size: 13px; box-sizing: border-box; background: transparent;" onfocus="this.style.borderBottomColor='#667eea'" onblur="this.style.borderBottomColor='#e0e0e0'">
                                <option value="">-- Select Department --</option>
                                ${pe.map(oe=>`<option value="${oe.departmentId}">${oe.departmentName}</option>`).join("")}
                            </select>
                        </div>
                        <div>
                            <label style="display: block; font-weight: 500; margin-bottom: 6px; color: #555; font-size: 13px;">Campus <span style="color: #999; font-size: 11px;">(Auto)</span></label>
                            <input id="newCampus" type="text" value="${le}" placeholder="Campus" style="width: 100%; padding: 8px 10px; border: none; border-bottom: 1.5px solid #ccc; border-radius: 0; font-size: 13px; box-sizing: border-box; background: transparent; color: #999; cursor: not-allowed;" disabled />
                            <input id="newCampusHidden" type="hidden" value="${T}" />
                        </div>
                        <div>
                            <label style="display: block; font-weight: 500; margin-bottom: 6px; color: #555; font-size: 13px;">Role *</label>
                            <select id="newRole" style="width: 100%; padding: 8px 10px; border: none; border-bottom: 1.5px solid #e0e0e0; border-radius: 0; font-size: 13px; box-sizing: border-box; background: transparent;" onfocus="this.style.borderBottomColor='#667eea'" onblur="this.style.borderBottomColor='#e0e0e0'">
                                <option value="Faculty">Faculty</option>
                                <option value="LabTech">LabTech</option>
                            </select>
                        </div>
                    </div>
                    <input id="newCampusHidden" type="hidden" value="${T}" />
                    `:`
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; margin-bottom: 16px;">
                        <div>
                            <label style="display: block; font-weight: 500; margin-bottom: 6px; color: #555; font-size: 13px;">Department * <span style="color: #999; font-size: 11px;">(Auto)</span></label>
                            <input id="newDepartment" type="text" value="Default Department" placeholder="Department" style="width: 100%; padding: 8px 10px; border: none; border-bottom: 1.5px solid #ccc; border-radius: 0; font-size: 13px; box-sizing: border-box; background: transparent; color: #999; cursor: not-allowed;" disabled />
                            <input id="newDepartmentId" type="hidden" value="DEPT-001" />
                        </div>
                        <div>
                            <label style="display: block; font-weight: 500; margin-bottom: 6px; color: #555; font-size: 13px;">Campus *</label>
                            <select id="newCampus" style="width: 100%; padding: 8px 10px; border: none; border-bottom: 1.5px solid #e0e0e0; border-radius: 0; font-size: 13px; box-sizing: border-box; background: transparent;" onfocus="this.style.borderBottomColor='#667eea'" onblur="this.style.borderBottomColor='#e0e0e0'">
                                <option value="">-- Select Campus --</option>
                                ${this.campuses.map(oe=>`<option value="${oe.campusId}">${oe.campusName}</option>`).join("")}
                            </select>
                        </div>
                        <div>
                            <label style="display: block; font-weight: 500; margin-bottom: 6px; color: #555; font-size: 13px;">Role * <span style="color: #999; font-size: 11px;">(Auto)</span></label>
                            <input id="newRole" type="text" value="CampusAdmin" placeholder="Role" style="width: 100%; padding: 8px 10px; border: none; border-bottom: 1.5px solid #ccc; border-radius: 0; font-size: 13px; box-sizing: border-box; background: transparent; color: #999; cursor: not-allowed;" disabled />
                        </div>
                    </div>
                    `}
                    <div style="display: flex; align-items: center; gap: 12px; padding-top: 12px; border-top: 1px solid #f0f0f0;">
                        <div style="position: relative; display: inline-block; width: 48px; height: 24px;">
                            <input id="newIsActive" type="checkbox" checked style="opacity: 0; width: 0; height: 0; cursor: pointer;" />
                            <span style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #667eea; transition: 0.3s; border-radius: 24px;"></span>
                            <span style="position: absolute; content: ''; height: 20px; width: 20px; left: 24px; bottom: 2px; background-color: white; transition: 0.3s; border-radius: 50%;"></span>
                        </div>
                        <label style="font-weight: 500; color: #555; margin: 0; font-size: 13px;">Active Status</label>
                        <div style="margin-left: auto; display: flex; gap: 8px;">
                            <button id="cancelUserBtn" type="button" style="padding: 8px 20px; border: 1px solid #e0e0e0; border-radius: 6px; background: #fff; color: #666; font-size: 13px; cursor: pointer; transition: all 0.2s;">Cancel</button>
                            <button id="createUserBtn" type="button" style="padding: 8px 20px; border: none; border-radius: 6px; background: #667eea; color: #fff; font-size: 13px; cursor: pointer; transition: all 0.2s;">Create User</button>
                        </div>
                    </div>
                </div>
            `,width:"750px",showCancelButton:!1,showConfirmButton:!1,didOpen:()=>{let oe=document.getElementById("newFirstName");if(oe&&oe.focus(),!s){let nt=document.getElementById("newCampus"),we=document.getElementById("newDepartment"),vt=document.getElementById("deptLockStatus");nt&&we&&nt.addEventListener("change",Sn=>{let St=Sn.target.value;if(St){let Pt=this.departments.filter(Qe=>Qe.campus&&Qe.campus.campusId===St);we.innerHTML='<option value="">-- Select Department --</option>',Pt.forEach(Qe=>{let st=document.createElement("option");st.value=Qe.departmentId,st.textContent=Qe.departmentName,we.appendChild(st)}),we.disabled=!1,we.style.color="#333",we.style.borderBottomColor="#e0e0e0",we.style.cursor="pointer",vt.textContent=""}else we.disabled=!0,we.innerHTML='<option value="">-- Select Department --</option>',we.style.color="#999",we.style.borderBottomColor="#ccc",we.style.cursor="not-allowed",vt.textContent="(Select Campus First)"})}let ie=document.getElementById("newIsActive"),De=ie?.parentElement?.parentElement,at=ie?.parentElement?.querySelector("span:nth-child(2)"),lt=ie?.parentElement?.querySelector("span:nth-child(3)");ie&&at&&lt&&De&&(ie.addEventListener("change",()=>{at.style.backgroundColor=ie.checked?"#667eea":"#ddd",lt.style.left=ie.checked?"24px":"2px"}),De.addEventListener("click",nt=>{nt.target!==ie&&(ie.checked=!ie.checked,ie.dispatchEvent(new Event("change",{bubbles:!0})))}),at?.addEventListener("click",()=>{ie.checked=!ie.checked,ie.dispatchEvent(new Event("change",{bubbles:!0}))}),lt?.addEventListener("click",()=>{ie.checked=!ie.checked,ie.dispatchEvent(new Event("change",{bubbles:!0}))}));let $e=document.getElementById("createUserBtn"),qe=document.getElementById("cancelUserBtn");$e&&($e.addEventListener("click",()=>{ne.default.clickConfirm()}),$e.addEventListener("mouseenter",()=>{$e.style.background="#5a67d8"}),$e.addEventListener("mouseleave",()=>{$e.style.background="#667eea"})),qe&&(qe.addEventListener("click",()=>{ne.default.close()}),qe.addEventListener("mouseenter",()=>{qe.style.background="#f5f5f5"}),qe.addEventListener("mouseleave",()=>{qe.style.background="#fff"}))}}).then(oe=>{if(oe.isConfirmed){let ie=document.getElementById("newUserId"),De=document.getElementById("newFirstName"),at=document.getElementById("newLastName"),lt=document.getElementById("newUserName"),$e=document.getElementById("newEmail"),qe=document.getElementById("newPassword"),nt=document.getElementById("newMiddleName"),we=document.getElementById("newContactNumber"),vt=document.getElementById("newDepartment"),Sn=document.getElementById("newDepartmentId"),St=ie?ie.value.trim():"",Pt=De?De.value.trim():"",Qe=at?at.value.trim():"",st=lt?lt.value.trim():"",gn=$e?$e.value.trim():"",_n=qe?qe.value.trim():"",Si=nt?nt.value.trim():"",wi=we?we.value.trim():"",Nt="";s?Nt=vt?vt.value:"":Nt="";let wn=document.getElementById("newCampus"),Mn=document.getElementById("newCampusHidden"),Dt="";s?Dt=Mn?Mn.value:T:Dt=wn?wn.value:"";let En=document.getElementById("newRole"),Mi=En?En.value:"",Tn=document.getElementById("newIsActive"),Ei=Tn?Tn.checked:!0;if(!St){ne.default.fire({title:"Error",text:"User ID is required",icon:"error"});return}if(!Pt){ne.default.fire({title:"Error",text:"First Name is required",icon:"error"});return}if(!Qe){ne.default.fire({title:"Error",text:"Last Name is required",icon:"error"});return}if(!st){ne.default.fire({title:"Error",text:"Username is required",icon:"error"});return}if(!gn||!this.isValidEmail(gn)){ne.default.fire({title:"Error",text:"Valid email is required",icon:"error"});return}if(!_n||_n.length<6){ne.default.fire({title:"Error",text:"Password must be at least 6 characters",icon:"error"});return}if(s&&!Nt){ne.default.fire({title:"Error",text:"Department is required",icon:"error"});return}if(!Dt){ne.default.fire({title:"Error",text:"Campus is required",icon:"error"});return}let In={userId:St,userName:st,email:gn,password:_n,firstName:Pt,lastName:Qe,middleName:Si||void 0,contactNumber:wi||void 0,campus:Dt,role:Mi,isActive:Ei,profilePicture:void 0};s&&(In.department=Nt),this.userService.createUser(In).subscribe({next:()=>{ne.default.fire({title:"Success!",text:"User created successfully",icon:"success"}),this.loadUsers()},error:Pn=>{ne.default.fire({title:"Error",text:"Failed to create user: "+(Pn.error?.message||Pn.message),icon:"error"})}})}})}isValidEmail(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)}deleteSelectedUsers(){if(!this.selectedUsers||this.selectedUsers.length===0){this.messageService.add({severity:"warn",summary:"Warning",detail:"Please select users to delete"});return}ne.default.fire({title:"Confirm Delete",text:`Are you sure you want to delete ${this.selectedUsers.length} user(s)?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, Delete All",cancelButtonText:"Cancel"}).then(t=>{if(t.isConfirmed){let e=0,n=0;this.selectedUsers.forEach(i=>{let s=i.userId||i.user_id;this.userService.deleteUser(s).subscribe({next:()=>{e++,e+n===this.selectedUsers.length&&(this.selectedUsers=[],this.loadUsers(),ne.default.fire({title:"Deleted!",text:`${e} user(s) deleted successfully.`,icon:"success"}))},error:g=>{n++,console.error(`Failed to delete user ${s}:`,g),e+n===this.selectedUsers.length&&(this.selectedUsers=[],this.loadUsers(),ne.default.fire({title:"Partial Delete",text:`${e} user(s) deleted, ${n} failed.`,icon:"warning"}))}})})}})}exportToExcel(){if(this.filteredUsers.length===0){this.messageService.add({severity:"warn",summary:"Warning",detail:"No data to export"});return}let t=this.filteredUsers.map(pe=>({"User ID":pe.userId||"","First Name":pe.firstName||"","Middle Name":pe.middleName||"","Last Name":pe.lastName||"",Email:pe.email||"",Contact:pe.contactNumber||"",Campus:pe.campus?.campusName||"",Department:pe.department?.departmentName||"",Role:pe.role||"",Status:pe.isActive?"Active":"Inactive"})),e=Object.keys(t[0]||{}),n=[e.join(","),...t.map(pe=>e.map(oe=>{let ie=pe[oe]||"",De=String(ie).replace(/"/g,'""');return De.includes(",")||De.includes('"')?`"${De}"`:De}).join(","))].join(`
`),i=new Blob([n],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a"),g=URL.createObjectURL(i),le=`users_${this.selectedCampus?this.campuses.find(pe=>pe.campusId===this.selectedCampus)?.campusName||"filtered":"all"}_${new Date().toISOString().split("T")[0]}.csv`;s.setAttribute("href",g),s.setAttribute("download",le),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s),this.messageService.add({severity:"success",summary:"Exported",detail:`${this.filteredUsers.length} users exported to ${le}`,life:3e3})}exportToPdf(){if(this.filteredUsers.length===0){this.messageService.add({severity:"warn",summary:"Warning",detail:"No data to export"});return}let t=this.selectedCampus?this.campuses.find(i=>i.campusId===this.selectedCampus)?.campusName||"Filtered":"All Campuses",e=`
            <!DOCTYPE html>
            <html>
            <head>
                <title>Users Report - ${t}</title>
                <style>
                    @page { 
                        size: A4 landscape; 
                        margin: 10mm; 
                    }
                    body { 
                        font-family: Arial, sans-serif; 
                        padding: 15px;
                        -webkit-print-color-adjust: exact;
                        print-color-adjust: exact;
                    }
                    .header { 
                        text-align: center; 
                        margin-bottom: 20px;
                        border-bottom: 2px solid #333;
                        padding-bottom: 10px;
                    }
                    .header h1 { 
                        margin: 0; 
                        font-size: 24px; 
                        color: #333;
                    }
                    .header h3 { 
                        margin: 5px 0 0 0; 
                        font-size: 16px; 
                        color: #666; 
                        font-weight: normal;
                    }
                    .meta-info {
                        display: flex;
                        justify-content: space-between;
                        font-size: 11px;
                        color: #888;
                        margin-bottom: 15px;
                    }
                    table { 
                        width: 100%; 
                        border-collapse: collapse; 
                        font-size: 10px; 
                    }
                    th { 
                        background-color: #2563eb !important; 
                        color: white !important;
                        padding: 10px 6px; 
                        text-align: left; 
                        font-weight: bold;
                        border: 1px solid #1d4ed8;
                    }
                    td { 
                        border: 1px solid #ddd; 
                        padding: 8px 6px; 
                        text-align: left; 
                    }
                    tr:nth-child(even) { background-color: #f8fafc !important; }
                    .footer { 
                        margin-top: 15px; 
                        padding-top: 10px;
                        border-top: 1px solid #ddd;
                        display: flex;
                        justify-content: space-between;
                        font-size: 12px;
                    }
                    .total { font-weight: bold; }
                    .status-active { color: #16a34a; font-weight: 500; }
                    .status-inactive { color: #dc2626; font-weight: 500; }
                    @media print {
                        body { margin: 0; }
                        table { page-break-inside: auto; }
                        tr { page-break-inside: avoid; page-break-after: auto; }
                        thead { display: table-header-group; }
                    }
                </style>
            </head>
            <body>
                <div class="header">
                    <h1>User Management</h1>
                    <h3>Users Report - ${t}</h3>
                </div>
                <div class="meta-info">
                    <span>Generated: ${new Date().toLocaleString()}</span>
                    <span>Total Records: ${this.filteredUsers.length}</span>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>User ID</th>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Contact</th>
                            <th>Campus</th>
                            <th>Department</th>
                            <th>Role</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${this.filteredUsers.map(i=>`
                            <tr>
                                <td>${i.userId||""}</td>
                                <td>${i.firstName||""} ${i.middleName||""} ${i.lastName||""}</td>
                                <td>${i.email||""}</td>
                                <td>${i.contactNumber||""}</td>
                                <td>${i.campus?.campusName||""}</td>
                                <td>${i.department?.departmentName||""}</td>
                                <td>${i.role||""}</td>
                                <td class="${i.isActive?"status-active":"status-inactive"}">${i.isActive?"Active":"Inactive"}</td>
                            </tr>
                        `).join("")}
                    </tbody>
                </table>
                <div class="footer">
                    <span class="total">Total Users: ${this.filteredUsers.length}</span>
                    <span>LAMS - User Management</span>
                </div>
                <script>
                    window.onload = function() { window.print(); }
                <\/script>
            </body>
            </html>
        `,n=window.open("","_blank");n&&(n.document.write(e),n.document.close())}printUsers(){if(this.filteredUsers.length===0){this.messageService.add({severity:"warn",summary:"Warning",detail:"No data to print"});return}let t=this.selectedCampus?this.campuses.find(i=>i.campusId===this.selectedCampus)?.campusName||"Filtered":"All Campuses",e=`
            <!DOCTYPE html>
            <html>
            <head>
                <title>Users Report - ${t}</title>
                <style>
                    body { font-family: Arial, sans-serif; padding: 20px; }
                    h1 { text-align: center; margin-bottom: 5px; }
                    h3 { text-align: center; color: #666; margin-top: 0; }
                    table { width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 12px; }
                    th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                    th { background-color: #f4f4f4; font-weight: bold; }
                    tr:nth-child(even) { background-color: #f9f9f9; }
                    .print-date { text-align: right; font-size: 11px; color: #888; margin-bottom: 10px; }
                    .total { margin-top: 10px; font-weight: bold; }
                    .status-active { color: green; }
                    .status-inactive { color: red; }
                    @media print {
                        body { margin: 0; }
                        table { page-break-inside: auto; }
                        tr { page-break-inside: avoid; page-break-after: auto; }
                    }
                </style>
            </head>
            <body>
                <h1>Users Report</h1>
                <h3>${t}</h3>
                <div class="print-date">Generated: ${new Date().toLocaleString()}</div>
                <table>
                    <thead>
                        <tr>
                            <th>User ID</th>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Contact</th>
                            <th>Campus</th>
                            <th>Role</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${this.filteredUsers.map(i=>`
                            <tr>
                                <td>${i.userId||""}</td>
                                <td>${i.firstName||""} ${i.middleName||""} ${i.lastName||""}</td>
                                <td>${i.email||""}</td>
                                <td>${i.contactNumber||""}</td>
                                <td>${i.campus?.campusName||""}</td>
                                <td>${i.role||""}</td>
                                <td class="${i.isActive?"status-active":"status-inactive"}">${i.isActive?"Active":"Inactive"}</td>
                            </tr>
                        `).join("")}
                    </tbody>
                </table>
                <div class="total">Total Users: ${this.filteredUsers.length}</div>
            </body>
            </html>
        `,n=window.open("","_blank");n&&(n.document.write(e),n.document.close(),n.onload=()=>{n.print()})}static \u0275fac=function(e){return new(e||a)(w(Ce),w(M),w(Xn))};static \u0275cmp=I({type:a,selectors:[["app-users"]],viewQuery:function(e,n){if(e&1&&Be(Ti,5),e&2){let i;Ae(i=Ue())&&(n.table=i.first)}},features:[F([M])],decls:12,vars:11,consts:[["start",""],["end",""],["dt",""],["body",""],["styleClass","mb-4"],["dataKey","userId","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} users",3,"selectionChange","value","rows","paginator","rowsPerPageOptions","rowHover","loading","selection","showCurrentPageReport","tableStyle"],["pTemplate","header"],["pTemplate","emptymessage"],[1,"flex","items-center","gap-2"],["label","New","icon","pi pi-plus","severity","secondary",3,"onClick"],["label","Delete Selected","icon","pi pi-trash","severity","secondary","outlined","",3,"onClick","disabled"],["optionLabel","campusName","optionValue","campusId","placeholder","Filter by Campus","class","w-56","appendTo","body",3,"ngModel","options","showClear","ngModelChange","onChange",4,"ngIf"],["styleClass","pi pi-search"],["pInputText","","type","text","placeholder","Search users...",3,"ngModelChange","input","ngModel"],["icon","pi pi-file-excel","severity","success","pTooltip","Export to Excel",3,"onClick","rounded","text"],["icon","pi pi-file-pdf","severity","danger","pTooltip","Export to PDF",3,"onClick","rounded","text"],["icon","pi pi-print","severity","info","pTooltip","Print",3,"onClick","rounded","text"],["optionLabel","campusName","optionValue","campusId","placeholder","Filter by Campus","appendTo","body",1,"w-56",3,"ngModelChange","onChange","ngModel","options","showClear"],[2,"width","3rem"],["pSortableColumn","userId",2,"min-width","10rem"],["field","userId"],["pSortableColumn","firstName",2,"min-width","15rem"],["field","firstName"],["pSortableColumn","campus.campusName",2,"min-width","12rem"],["field","campus.campusName"],["pSortableColumn","role",2,"min-width","10rem"],["field","role"],["pSortableColumn","isActive",2,"min-width","8rem"],["field","isActive"],[2,"min-width","10rem"],[3,"value"],[3,"value","severity"],[1,"flex","gap-2"],["icon","pi pi-eye","severity","info","pTooltip","View",3,"onClick","rounded","text"],["icon","pi pi-pencil","severity","secondary","pTooltip","Edit",3,"onClick","rounded","text"],["icon","pi pi-trash","severity","danger","pTooltip","Delete",3,"onClick","rounded","text"],["colspan","7",1,"text-center","py-5"]],template:function(e,n){if(e&1){let i=C();h(0,"p-toast"),r(1,"p-toolbar",4),b(2,Ni,3,1,"ng-template",null,0,x)(4,ki,8,8,"ng-template",null,1,x),o(),r(6,"p-table",5,2),S("selectionChange",function(g){return m(i),v(n.selectedUsers,g)||(n.selectedUsers=g),d(g)}),_("selectionChange",function(g){return m(i),d(n.onSelectionChange(g))}),b(8,Li,20,0,"ng-template",6)(9,Vi,18,15,"ng-template",null,3,x)(11,Ri,3,0,"ng-template",7),o()}e&2&&(c(6),u("value",n.filteredUsers)("rows",10)("paginator",!0)("rowsPerPageOptions",E(9,Ii))("rowHover",!0)("loading",n.loading),y("selection",n.selectedUsers),u("showCurrentPageReport",!0)("tableStyle",E(10,Pi)))},dependencies:[P,Te,z,$,N,V,R,U,q,H,ee,te,A,Q,se,ut,B,O,W,j,G,X,J,Z,ve,Ve,he,ye,L,Y,D,k],styles:[".users-container[_ngcontent-%COMP%]{width:100%}.users-table[_ngcontent-%COMP%]   .p-datatable[_ngcontent-%COMP%]   .p-datatable-thead[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > th[_ngcontent-%COMP%]{background-color:#f8f9fa;color:#495057;font-weight:600;border-bottom:2px solid #dee2e6;padding:1rem}.users-table[_ngcontent-%COMP%]   .p-datatable[_ngcontent-%COMP%]   .p-datatable-thead[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > th[_ngcontent-%COMP%]:hover{background-color:#f1f3f5}.users-table[_ngcontent-%COMP%]   .p-datatable[_ngcontent-%COMP%]   .p-datatable-tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%]{border-bottom:1px solid #dee2e6;transition:background-color .2s ease}.users-table[_ngcontent-%COMP%]   .p-datatable[_ngcontent-%COMP%]   .p-datatable-tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%]:hover{background-color:var(--highlight-bg)!important;cursor:pointer}.users-table[_ngcontent-%COMP%]   .p-datatable[_ngcontent-%COMP%]   .p-datatable-tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1rem;color:#212529;vertical-align:middle}.users-table[_ngcontent-%COMP%]   .p-datatable[_ngcontent-%COMP%]   .p-datatable-tbody[_ngcontent-%COMP%] > tr.row-selected[_ngcontent-%COMP%]{background-color:var(--primary-color-text)!important;color:var(--primary-color)!important;border-left:3px solid var(--primary-color)!important}.users-table[_ngcontent-%COMP%]   .p-datatable[_ngcontent-%COMP%]   .p-datatable-tbody[_ngcontent-%COMP%] > tr.row-selected[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:var(--primary-color)!important}.users-table[_ngcontent-%COMP%]   .p-datatable[_ngcontent-%COMP%]   .p-datatable-emptymessage[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:#999;background-color:#f8f9fa}.users-table[_ngcontent-%COMP%]   .p-paginator[_ngcontent-%COMP%]{background-color:#f8f9fa;border-top:1px solid #dee2e6;padding:1rem}.users-table[_ngcontent-%COMP%]   .p-paginator[_ngcontent-%COMP%]   .p-paginator-left-content[_ngcontent-%COMP%], .users-table[_ngcontent-%COMP%]   .p-paginator[_ngcontent-%COMP%]   .p-paginator-right-content[_ngcontent-%COMP%]{color:#495057}.users-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem;padding:0}.users-header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;color:#1a1a1a;margin:0;display:flex;align-items:center;gap:.5rem}.users-header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#667eea}.users-search-bar[_ngcontent-%COMP%]{margin-bottom:1.5rem}.users-search-bar[_ngcontent-%COMP%]   .p-input-icon-left[_ngcontent-%COMP%]{width:100%}.users-search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.75rem 1rem .75rem 2.5rem;border:2px solid #dee2e6;border-radius:6px;font-size:1rem;transition:all .3s ease}.users-search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#667eea;box-shadow:0 0 0 3px #667eea1a;background-color:#f8f9ff}.users-search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#adb5bd}.users-search-bar[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#adb5bd;left:.75rem}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:.5rem;justify-content:center}.action-buttons[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]     .p-button.p-button-rounded{width:2.5rem;height:2.5rem}.action-buttons[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]     .p-button.p-button-rounded:hover{transform:scale(1.05)}.action-buttons[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]     .p-button.p-button-info{background-color:#17a2b8;border-color:#17a2b8}.action-buttons[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]     .p-button.p-button-info:hover{background-color:#138496}.action-buttons[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]     .p-button.p-button-warning{background-color:#ffc107;border-color:#ffc107;color:#000}.action-buttons[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]     .p-button.p-button-warning:hover{background-color:#e0a800}.action-buttons[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]     .p-button.p-button-danger{background-color:#dc3545;border-color:#dc3545}.action-buttons[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]     .p-button.p-button-danger:hover{background-color:#c82333}.card[_ngcontent-%COMP%]{border-radius:8px;border:none;box-shadow:0 2px 8px #00000014;overflow:hidden}.card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{padding:1.5rem;border-bottom:1px solid #f0f0f0;background-color:#fff}.card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;color:#1a1a1a;margin:0}@media (max-width: 768px){.users-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:1rem}.users-table[_ngcontent-%COMP%]   .p-datatable[_ngcontent-%COMP%]   .p-datatable-thead[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > th[_ngcontent-%COMP%]{font-size:.875rem;padding:.75rem}.users-table[_ngcontent-%COMP%]   .p-datatable[_ngcontent-%COMP%]   .p-datatable-tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%]{padding:.75rem;font-size:.875rem}}"]})};var fe=Ee(Pe());var Oi=["dt"],Bi=()=>[10,20,30],Ai=()=>({"min-width":"70rem"});function Ui(a,t){if(a&1){let e=C();r(0,"div",7)(1,"p-button",8),_("onClick",function(){m(e);let i=p();return d(i.openNewCampusDialog())}),o(),r(2,"p-button",9),_("onClick",function(){m(e);let i=p();return d(i.deleteSelectedCampuses())}),o()()}if(a&2){let e=p();c(2),u("disabled",!e.selectedCampuses.length)}}function Fi(a,t){if(a&1){let e=C();r(0,"div",7)(1,"p-button",10),_("onClick",function(){m(e);let i=p();return d(i.exportCSV())}),o(),r(2,"p-iconfield"),h(3,"p-inputicon",11),r(4,"input",12),S("ngModelChange",function(i){m(e);let s=p();return v(s.searchValue,i)||(s.searchValue=i),d(i)}),_("input",function(){m(e);let i=p();return d(i.filterCampuses())}),o()()()}if(a&2){let e=p();c(4),y("ngModel",e.searchValue)}}function ji(a,t){a&1&&(r(0,"tr")(1,"th",13),h(2,"p-tableHeaderCheckbox"),o(),r(3,"th",14),l(4,"ID"),o(),r(5,"th",15),l(6,"Campus "),h(7,"p-sortIcon",16),o(),r(8,"th",17),l(9,"Campus Director "),h(10,"p-sortIcon",18),o(),r(11,"th",19),l(12,"Actions"),o()())}function Wi(a,t){if(a&1){let e=C();r(0,"tr")(1,"td"),h(2,"p-tableCheckbox",20),o(),r(3,"td"),l(4),o(),r(5,"td"),l(6),o(),r(7,"td"),l(8),o(),r(9,"td")(10,"div",21)(11,"p-button",22),_("onClick",function(){let i=m(e).$implicit,s=p();return d(s.editCampus(i))}),o(),r(12,"p-button",23),_("onClick",function(){let i=m(e).$implicit,s=p();return d(s.deleteCampus(i))}),o()()()()}if(a&2){let e=t.$implicit,n=p();c(2),u("value",e),c(2),f(n.formatId(e.campusId)),c(2),f(e.campusName),c(2),f(e.campusDirector||"N/A"),c(3),u("rounded",!0)("text",!0),c(),u("rounded",!0)("text",!0)}}function $i(a,t){a&1&&(r(0,"tr")(1,"td",24),l(2,"No campuses found"),o()())}var qt=class a{constructor(t,e){this.userService=t;this.messageService=e}table;campuses=[];filteredCampuses=[];selectedCampuses=[];searchValue="";loading=!1;ngOnInit(){this.loadCampuses()}loadCampuses(){this.loading=!0,this.userService.getCampuses().subscribe({next:t=>{this.campuses=Array.isArray(t)?t:t.data||[],this.filteredCampuses=[...this.campuses],this.loading=!1},error:t=>{console.error("Error loading campuses:",t),fe.default.fire({title:"Error",text:"Failed to load campuses: "+(t.error?.message||t.message),icon:"error"}),this.loading=!1}})}filterCampuses(){if(!this.searchValue.trim()){this.filteredCampuses=[...this.campuses];return}let t=this.searchValue.toLowerCase();this.filteredCampuses=this.campuses.filter(e=>e.campusName?.toLowerCase().includes(t)||e.campusDirector?.toLowerCase().includes(t))}onSelectionChange(t){this.selectedCampuses&&this.selectedCampuses.length>0}viewCampus(t){let e=new Date(t.campusCreated).toLocaleDateString(),n=new Date(t.campusUpdated).toLocaleDateString();fe.default.fire({title:t.campusName,html:`
                <div style="text-align: left;">
                    <p><strong>Campus Director:</strong> ${t.campusDirector||"N/A"}</p>
                    <p><strong>Created:</strong> ${e}</p>
                    <p><strong>Updated:</strong> ${n}</p>
                </div>
            `,icon:"info",confirmButtonText:"Close"})}editCampus(t){let e={campusName:t.campusName,campusDirector:t.campusDirector};fe.default.fire({title:"",titleText:"",html:`
                <div style="text-align: left; width: 100%; max-width: 500px; margin: 0 auto;">
                    <div style="background: #f5f5f5; color: #333; padding: 16px; margin: -16px -16px 16px -16px; border-radius: 8px 8px 0 0;">
                        <h2 style="margin: 0; font-size: 18px; font-weight: 600; letter-spacing: 0.5px;">\u270E Edit Campus</h2>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr; gap: 12px; margin-bottom: 16px;">
                        <div>
                            <label style="display: block; font-weight: 500; margin-bottom: 6px; color: #555; font-size: 13px;">Campus Name *</label>
                            <input id="campusName" type="text" value="${e.campusName}" placeholder="Campus Name" style="width: 100%; padding: 8px 10px; border: none; border-bottom: 1.5px solid #e0e0e0; border-radius: 0; font-size: 13px; box-sizing: border-box; background: transparent;" onfocus="this.style.borderBottomColor='#667eea'" onblur="this.style.borderBottomColor='#e0e0e0'" />
                        </div>
                        <div>
                            <label style="display: block; font-weight: 500; margin-bottom: 6px; color: #555; font-size: 13px;">Campus Director *</label>
                            <input id="campusDirector" type="text" value="${e.campusDirector}" placeholder="Director Name" style="width: 100%; padding: 8px 10px; border: none; border-bottom: 1.5px solid #e0e0e0; border-radius: 0; font-size: 13px; box-sizing: border-box; background: transparent;" onfocus="this.style.borderBottomColor='#667eea'" onblur="this.style.borderBottomColor='#e0e0e0'" />
                        </div>
                    </div>
                </div>
            `,width:"550px",showCancelButton:!0,confirmButtonText:"Update Campus",cancelButtonText:"Cancel",confirmButtonColor:"#667eea",cancelButtonColor:"#e0e0e0",didOpen:()=>{let n=document.getElementById("campusName");n&&n.focus()}}).then(n=>{if(n.isConfirmed){let i=document.getElementById("campusName").value.trim(),s=document.getElementById("campusDirector").value.trim();if(!i){fe.default.fire({title:"Error",text:"Campus Name is required",icon:"error"});return}if(!s){fe.default.fire({title:"Error",text:"Campus Director is required",icon:"error"});return}let g={campusName:i,campusDirector:s};this.userService.updateCampus(t.campusId,g).subscribe({next:()=>{fe.default.fire({title:"Success!",text:"Campus updated successfully",icon:"success"}),this.loadCampuses()},error:T=>{fe.default.fire({title:"Error",text:"Failed to update campus: "+(T.error?.message||T.message),icon:"error"})}})}})}deleteCampus(t){let e=t.campusId;fe.default.fire({title:"Confirm Delete",text:"Are you sure you want to delete this campus?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, Delete",cancelButtonText:"Cancel",confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d"}).then(n=>{n.isConfirmed&&this.userService.deleteCampus(e).subscribe({next:()=>{fe.default.fire({title:"Deleted!",text:"Campus has been deleted successfully.",icon:"success"}),this.loadCampuses()},error:i=>{console.error("Error deleting campus:",e,i),fe.default.fire({title:"Error",text:"Failed to delete campus: "+(i.error?.message||i.message),icon:"error"})}})})}openNewCampusDialog(){fe.default.fire({title:"",titleText:"",html:`
                <div style="text-align: left; width: 100%; max-width: 500px; margin: 0 auto;">
                    <div style="background: #f5f5f5; color: #333; padding: 16px; margin: -16px -16px 16px -16px; border-radius: 8px 8px 0 0;">
                        <h2 style="margin: 0; font-size: 18px; font-weight: 600; letter-spacing: 0.5px;">\u2795 Add New Campus</h2>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr; gap: 12px; margin-bottom: 16px;">
                        <div>
                            <label style="display: block; font-weight: 500; margin-bottom: 6px; color: #555; font-size: 13px;">Campus Name *</label>
                            <input id="newCampusName" type="text" placeholder="Campus Name" style="width: 100%; padding: 8px 10px; border: none; border-bottom: 1.5px solid #e0e0e0; border-radius: 0; font-size: 13px; box-sizing: border-box; background: transparent;" onfocus="this.style.borderBottomColor='#667eea'" onblur="this.style.borderBottomColor='#e0e0e0'" />
                        </div>
                        <div>
                            <label style="display: block; font-weight: 500; margin-bottom: 6px; color: #555; font-size: 13px;">Campus Director *</label>
                            <input id="newCampusDirector" type="text" placeholder="Director Name" style="width: 100%; padding: 8px 10px; border: none; border-bottom: 1.5px solid #e0e0e0; border-radius: 0; font-size: 13px; box-sizing: border-box; background: transparent;" onfocus="this.style.borderBottomColor='#667eea'" onblur="this.style.borderBottomColor='#e0e0e0'" />
                        </div>
                    </div>
                </div>
            `,width:"550px",showCancelButton:!0,confirmButtonText:"Create Campus",cancelButtonText:"Cancel",confirmButtonColor:"#667eea",cancelButtonColor:"#e0e0e0",didOpen:()=>{let t=document.getElementById("newCampusName");t&&t.focus()}}).then(t=>{if(t.isConfirmed){let e=document.getElementById("newCampusName").value.trim(),n=document.getElementById("newCampusDirector").value.trim();if(!e){fe.default.fire({title:"Error",text:"Campus Name is required",icon:"error"});return}if(!n){fe.default.fire({title:"Error",text:"Campus Director is required",icon:"error"});return}let i={campusName:e,campusDirector:n};this.userService.createCampus(i).subscribe({next:()=>{fe.default.fire({title:"Success!",text:"Campus created successfully",icon:"success"}),this.loadCampuses()},error:s=>{fe.default.fire({title:"Error",text:"Failed to create campus: "+(s.error?.message||s.message),icon:"error"})}})}})}deleteSelectedCampuses(){if(!this.selectedCampuses||this.selectedCampuses.length===0){this.messageService.add({severity:"warn",summary:"Warning",detail:"Please select campuses to delete"});return}fe.default.fire({title:"Confirm Delete",text:`Are you sure you want to delete ${this.selectedCampuses.length} campus(es)?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, Delete All",cancelButtonText:"Cancel"}).then(t=>{if(t.isConfirmed){let e=0,n=0;this.selectedCampuses.forEach(i=>{let s=i.campusId;this.userService.deleteCampus(s).subscribe({next:()=>{e++,e+n===this.selectedCampuses.length&&(this.selectedCampuses=[],this.loadCampuses(),fe.default.fire({title:"Deleted!",text:`${e} campus(es) deleted successfully.`,icon:"success"}))},error:g=>{n++,console.error(`Failed to delete campus ${s}:`,g),e+n===this.selectedCampuses.length&&(this.selectedCampuses=[],this.loadCampuses(),fe.default.fire({title:"Partial Delete",text:`${e} campus(es) deleted, ${n} failed.`,icon:"warning"}))}})})}})}exportCSV(){if(this.filteredCampuses.length===0){this.messageService.add({severity:"warn",summary:"Warning",detail:"No data to export"});return}let t=this.generateCSV(this.filteredCampuses),e=new Blob([t],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a"),i=URL.createObjectURL(e);n.setAttribute("href",i),n.setAttribute("download","campuses_export.csv"),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n),this.messageService.add({severity:"success",summary:"Success",detail:"Campuses exported to CSV"})}generateCSV(t){let e=["Campus Name","Campus Director"],n=t.map(s=>[s.campusName||"",s.campusDirector||""]);return[e.join(","),...n.map(s=>s.map(g=>`"${g}"`).join(","))].join(`
`)}formatId(t){return t?t.replace(/[^0-9]/g,""):""}static \u0275fac=function(e){return new(e||a)(w(Ce),w(M))};static \u0275cmp=I({type:a,selectors:[["app-campuses"]],viewQuery:function(e,n){if(e&1&&Be(Oi,5),e&2){let i;Ae(i=Ue())&&(n.table=i.first)}},features:[F([M])],decls:10,vars:11,consts:[["start",""],["end",""],["styleClass","mb-4"],["dataKey","campusId","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} campuses",3,"selectionChange","value","rows","paginator","rowsPerPageOptions","loading","rowHover","selection","showCurrentPageReport","tableStyle"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"flex","items-center","gap-2"],["label","New","icon","pi pi-plus","severity","secondary",3,"onClick"],["label","Delete Selected","icon","pi pi-trash","severity","secondary","outlined","",3,"onClick","disabled"],["label","Export","icon","pi pi-upload","severity","secondary",3,"onClick"],["styleClass","pi pi-search"],["pInputText","","type","text","placeholder","Search campuses...",3,"ngModelChange","input","ngModel"],[2,"width","3rem"],[2,"min-width","20rem"],["pSortableColumn","campusName",2,"min-width","15rem"],["field","campusName"],["pSortableColumn","campusDirector",2,"min-width","15rem"],["field","campusDirector"],[2,"min-width","12rem"],[3,"value"],[1,"flex","gap-2"],["icon","pi pi-pencil","severity","secondary",3,"onClick","rounded","text"],["icon","pi pi-trash","severity","danger",3,"onClick","rounded","text"],["colspan","5",1,"text-center","py-5"]],template:function(e,n){if(e&1){let i=C();h(0,"p-toast"),r(1,"p-toolbar",2),b(2,Ui,3,1,"ng-template",null,0,x)(4,Fi,5,1,"ng-template",null,1,x),o(),r(6,"p-table",3),S("selectionChange",function(g){return m(i),v(n.selectedCampuses,g)||(n.selectedCampuses=g),d(g)}),_("selectionChange",function(g){return m(i),d(n.onSelectionChange(g))}),b(7,ji,13,0,"ng-template",4)(8,Wi,13,8,"ng-template",5)(9,$i,3,0,"ng-template",6),o()}e&2&&(c(6),u("value",n.filteredCampuses)("rows",10)("paginator",!0)("rowsPerPageOptions",E(9,Bi))("loading",n.loading)("rowHover",!0),y("selection",n.selectedCampuses),u("showCurrentPageReport",!0)("tableStyle",E(10,Ai)))},dependencies:[P,z,$,N,V,R,U,q,H,ee,te,A,Q,se,B,O,W,j,G,X,J,Z,L,Y,D,k],styles:[".action-buttons[_ngcontent-%COMP%]{display:flex;gap:.5rem;justify-content:flex-start}.action-buttons[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]:hover{opacity:.8}p-table[_ngcontent-%COMP%]     .p-datatable .p-datatable-tbody>tr:hover{background-color:#f8f9fa}p-table[_ngcontent-%COMP%]     .p-input-icon-left>input{padding-left:2.5rem}p-table[_ngcontent-%COMP%]     .p-input-icon-left>.p-input-icon{left:.75rem}"]})};var xe=Ee(Pe());var Hi=["dt"],zi=()=>[10,20,30],Yi=()=>({"min-width":"70rem"});function Qi(a,t){if(a&1){let e=C();r(0,"div",7)(1,"p-button",8),_("onClick",function(){m(e);let i=p();return d(i.openNewDepartmentDialog())}),o(),r(2,"p-button",9),_("onClick",function(){m(e);let i=p();return d(i.deleteSelectedDepartments())}),o()()}if(a&2){let e=p();c(2),u("disabled",!e.selectedDepartments.length)}}function Gi(a,t){if(a&1){let e=C();r(0,"div",7)(1,"p-button",10),_("onClick",function(){m(e);let i=p();return d(i.exportCSV())}),o(),r(2,"p-iconfield"),h(3,"p-inputicon",11),r(4,"input",12),S("ngModelChange",function(i){m(e);let s=p();return v(s.searchValue,i)||(s.searchValue=i),d(i)}),_("input",function(){m(e);let i=p();return d(i.filterDepartments())}),o()()()}if(a&2){let e=p();c(4),y("ngModel",e.searchValue)}}function Ji(a,t){a&1&&(r(0,"tr")(1,"th",13),h(2,"p-tableHeaderCheckbox"),o(),r(3,"th",14),l(4,"ID"),o(),r(5,"th",15),l(6,"Department "),h(7,"p-sortIcon",16),o(),r(8,"th",17),l(9,"Campus "),h(10,"p-sortIcon",18),o(),r(11,"th",19),l(12,"Actions"),o()())}function Ki(a,t){if(a&1){let e=C();r(0,"tr")(1,"td"),h(2,"p-tableCheckbox",20),o(),r(3,"td"),l(4),o(),r(5,"td"),l(6),o(),r(7,"td"),l(8),o(),r(9,"td")(10,"div",21)(11,"p-button",22),_("onClick",function(){let i=m(e).$implicit,s=p();return d(s.editDepartment(i))}),o(),r(12,"p-button",23),_("onClick",function(){let i=m(e).$implicit,s=p();return d(s.deleteDepartment(i))}),o()()()()}if(a&2){let e=t.$implicit,n=p();c(2),u("value",e),c(2),f(n.formatId(e.departmentId)),c(2),f(e.departmentName),c(2),f((e.campus==null?null:e.campus.campusName)||"N/A"),c(3),u("rounded",!0)("text",!0),c(),u("rounded",!0)("text",!0)}}function Xi(a,t){a&1&&(r(0,"tr")(1,"td",24),l(2,"No departments found"),o()())}var Ht=class a{constructor(t,e,n){this.userService=t;this.messageService=e;this.authService=n}table;departments=[];filteredDepartments=[];selectedDepartments=[];campuses=[];searchValue="";loading=!1;ngOnInit(){this.loadDepartments(),this.loadCampuses()}loadDepartments(){this.loading=!0,this.userService.getDepartments().subscribe({next:t=>{this.departments=Array.isArray(t)?t:t.data||[],this.filteredDepartments=[...this.departments],this.loading=!1},error:t=>{console.error("Error loading departments:",t),xe.default.fire({title:"Error",text:"Failed to load departments: "+(t.error?.message||t.message),icon:"error"}),this.loading=!1}})}loadCampuses(){this.userService.getCampuses().subscribe({next:t=>{this.campuses=Array.isArray(t)?t:t.data||[]},error:t=>{console.error("Error loading campuses:",t)}})}filterDepartments(){if(!this.searchValue.trim()){this.filteredDepartments=[...this.departments];return}let t=this.searchValue.toLowerCase();this.filteredDepartments=this.departments.filter(e=>e.departmentName?.toLowerCase().includes(t)||e.campus?.campusName?.toLowerCase().includes(t))}onSelectionChange(t){this.selectedDepartments&&this.selectedDepartments.length>0}viewDepartment(t){let e=new Date(t.departmentCreated).toLocaleDateString(),n=new Date(t.departmentUpdated).toLocaleDateString();xe.default.fire({title:t.departmentName,html:`
                <div style="text-align: left;">
                    <p><strong>Campus:</strong> ${t.campus?.campusName||"N/A"}</p>
                    <p><strong>Created:</strong> ${e}</p>
                    <p><strong>Updated:</strong> ${n}</p>
                </div>
            `,icon:"info",confirmButtonText:"Close"})}editDepartment(t){let e={departmentName:t.departmentName};xe.default.fire({title:"",titleText:"",html:`
                <div style="text-align: left; width: 100%; max-width: 500px; margin: 0 auto;">
                    <div style="background: #f5f5f5; color: #333; padding: 16px; margin: -16px -16px 16px -16px; border-radius: 8px 8px 0 0;">
                        <h2 style="margin: 0; font-size: 18px; font-weight: 600; letter-spacing: 0.5px;">\u270E Edit Department</h2>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr; gap: 12px; margin-bottom: 16px;">
                        <div>
                            <label style="display: block; font-weight: 500; margin-bottom: 6px; color: #555; font-size: 13px;">Department Name *</label>
                            <input id="departmentName" type="text" value="${e.departmentName}" placeholder="Department Name" style="width: 100%; padding: 8px 10px; border: none; border-bottom: 1.5px solid #e0e0e0; border-radius: 0; font-size: 13px; box-sizing: border-box; background: transparent;" onfocus="this.style.borderBottomColor='#667eea'" onblur="this.style.borderBottomColor='#e0e0e0'" />
                        </div>
                    </div>
                </div>
            `,width:"550px",showCancelButton:!0,confirmButtonText:"Update Department",cancelButtonText:"Cancel",confirmButtonColor:"#667eea",cancelButtonColor:"#e0e0e0",didOpen:()=>{let n=document.getElementById("departmentName");n&&n.focus()}}).then(n=>{if(n.isConfirmed){let i=document.getElementById("departmentName").value.trim();if(!i){xe.default.fire({title:"Error",text:"Department Name is required",icon:"error"});return}let s={departmentName:i};this.userService.updateDepartment(t.departmentId,s).subscribe({next:()=>{xe.default.fire({title:"Success!",text:"Department updated successfully",icon:"success"}),this.loadDepartments()},error:g=>{xe.default.fire({title:"Error",text:"Failed to update department: "+(g.error?.message||g.message),icon:"error"})}})}})}deleteDepartment(t){let e=t.departmentId;xe.default.fire({title:"Confirm Delete",text:"Are you sure you want to delete this department?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, Delete",cancelButtonText:"Cancel",confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d"}).then(n=>{n.isConfirmed&&this.userService.deleteDepartment(e).subscribe({next:()=>{xe.default.fire({title:"Deleted!",text:"Department has been deleted successfully.",icon:"success"}),this.loadDepartments()},error:i=>{console.error("Error deleting department:",e,i),xe.default.fire({title:"Error",text:"Failed to delete department: "+(i.error?.message||i.message),icon:"error"})}})})}openNewDepartmentDialog(){xe.default.fire({title:"",titleText:"",html:`
                <div style="text-align: left; width: 100%; max-width: 500px; margin: 0 auto;">
                    <div style="background: #f5f5f5; color: #333; padding: 16px; margin: -16px -16px 16px -16px; border-radius: 8px 8px 0 0;">
                        <h2 style="margin: 0; font-size: 18px; font-weight: 600; letter-spacing: 0.5px;">\u2795 Add New Department</h2>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr; gap: 12px; margin-bottom: 16px;">
                        <div>
                            <label style="display: block; font-weight: 500; margin-bottom: 6px; color: #555; font-size: 13px;">Department Name *</label>
                            <input id="newDepartmentName" type="text" placeholder="Department Name" style="width: 100%; padding: 8px 10px; border: none; border-bottom: 1.5px solid #e0e0e0; border-radius: 0; font-size: 13px; box-sizing: border-box; background: transparent;" onfocus="this.style.borderBottomColor='#667eea'" onblur="this.style.borderBottomColor='#e0e0e0'" />
                        </div>
                    </div>
                </div>
            `,width:"550px",showCancelButton:!0,confirmButtonText:"Create Department",cancelButtonText:"Cancel",confirmButtonColor:"#667eea",cancelButtonColor:"#e0e0e0",didOpen:()=>{let t=document.getElementById("newDepartmentName");t&&t.focus()}}).then(t=>{if(t.isConfirmed){let e=document.getElementById("newDepartmentName").value.trim();if(!e){xe.default.fire({title:"Error",text:"Department Name is required",icon:"error"});return}let n={departmentName:e};this.userService.createDepartment(n).subscribe({next:()=>{xe.default.fire({title:"Success!",text:"Department created successfully",icon:"success"}),this.loadDepartments()},error:i=>{xe.default.fire({title:"Error",text:"Failed to create department: "+(i.error?.message||i.message),icon:"error"})}})}})}deleteSelectedDepartments(){if(!this.selectedDepartments||this.selectedDepartments.length===0){this.messageService.add({severity:"warn",summary:"Warning",detail:"Please select departments to delete"});return}xe.default.fire({title:"Confirm Delete",text:`Are you sure you want to delete ${this.selectedDepartments.length} department(s)?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, Delete All",cancelButtonText:"Cancel"}).then(t=>{if(t.isConfirmed){let e=0,n=0;this.selectedDepartments.forEach(i=>{let s=i.departmentId;this.userService.deleteDepartment(s).subscribe({next:()=>{e++,e+n===this.selectedDepartments.length&&(this.selectedDepartments=[],this.loadDepartments(),xe.default.fire({title:"Deleted!",text:`${e} department(s) deleted successfully.`,icon:"success"}))},error:g=>{n++,console.error(`Failed to delete department ${s}:`,g),e+n===this.selectedDepartments.length&&(this.selectedDepartments=[],this.loadDepartments(),xe.default.fire({title:"Partial Delete",text:`${e} department(s) deleted, ${n} failed.`,icon:"warning"}))}})})}})}exportCSV(){if(this.filteredDepartments.length===0){this.messageService.add({severity:"warn",summary:"Warning",detail:"No data to export"});return}let t=this.generateCSV(this.filteredDepartments),e=new Blob([t],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a"),i=URL.createObjectURL(e);n.setAttribute("href",i),n.setAttribute("download","departments_export.csv"),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n),this.messageService.add({severity:"success",summary:"Success",detail:"Departments exported to CSV"})}generateCSV(t){let e=["Department Name","Campus Name"],n=t.map(s=>[s.departmentName||"",s.campus?.campusName||""]);return[e.join(","),...n.map(s=>s.map(g=>`"${g}"`).join(","))].join(`
`)}formatId(t){return t?t.replace(/[^0-9]/g,""):""}static \u0275fac=function(e){return new(e||a)(w(Ce),w(M),w(At))};static \u0275cmp=I({type:a,selectors:[["app-departments"]],viewQuery:function(e,n){if(e&1&&Be(Hi,5),e&2){let i;Ae(i=Ue())&&(n.table=i.first)}},features:[F([M])],decls:10,vars:11,consts:[["start",""],["end",""],["styleClass","mb-4"],["dataKey","departmentId","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} departments",3,"selectionChange","value","rows","paginator","rowsPerPageOptions","loading","rowHover","selection","showCurrentPageReport","tableStyle"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"flex","items-center","gap-2"],["label","New","icon","pi pi-plus","severity","secondary",3,"onClick"],["label","Delete Selected","icon","pi pi-trash","severity","secondary","outlined","",3,"onClick","disabled"],["label","Export","icon","pi pi-upload","severity","secondary",3,"onClick"],["styleClass","pi pi-search"],["pInputText","","type","text","placeholder","Search departments...",3,"ngModelChange","input","ngModel"],[2,"width","3rem"],[2,"min-width","10rem"],["pSortableColumn","departmentName",2,"min-width","15rem"],["field","departmentName"],["pSortableColumn","campus.campusName",2,"min-width","15rem"],["field","campus.campusName"],[2,"min-width","12rem"],[3,"value"],[1,"flex","gap-2"],["icon","pi pi-pencil","severity","secondary",3,"onClick","rounded","text"],["icon","pi pi-trash","severity","danger",3,"onClick","rounded","text"],["colspan","5",1,"text-center","py-5"]],template:function(e,n){if(e&1){let i=C();h(0,"p-toast"),r(1,"p-toolbar",2),b(2,Qi,3,1,"ng-template",null,0,x)(4,Gi,5,1,"ng-template",null,1,x),o(),r(6,"p-table",3),S("selectionChange",function(g){return m(i),v(n.selectedDepartments,g)||(n.selectedDepartments=g),d(g)}),_("selectionChange",function(g){return m(i),d(n.onSelectionChange(g))}),b(7,Ji,13,0,"ng-template",4)(8,Ki,13,8,"ng-template",5)(9,Xi,3,0,"ng-template",6),o()}e&2&&(c(6),u("value",n.filteredDepartments)("rows",10)("paginator",!0)("rowsPerPageOptions",E(9,zi))("loading",n.loading)("rowHover",!0),y("selection",n.selectedDepartments),u("showCurrentPageReport",!0)("tableStyle",E(10,Yi)))},dependencies:[P,z,$,N,V,R,U,q,H,ee,te,A,Q,se,B,O,W,j,G,X,J,Z,L,Y,D,k],styles:[".action-buttons[_ngcontent-%COMP%]{display:flex;gap:.5rem;justify-content:flex-start}.action-buttons[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]:hover{opacity:.8}p-table[_ngcontent-%COMP%]     .p-datatable .p-datatable-tbody>tr:hover{background-color:#f8f9fa}p-table[_ngcontent-%COMP%]     .p-input-icon-left>input{padding-left:2.5rem}p-table[_ngcontent-%COMP%]     .p-input-icon-left>.p-input-icon{left:.75rem}"]})};var He=Ee(Pe());var Zi=()=>[10,20,30],er=()=>({"min-width":"70rem"});function tr(a,t){if(a&1){let e=C();r(0,"div",7)(1,"p-button",8),_("onClick",function(){m(e);let i=p();return d(i.openNewDialog())}),o(),r(2,"p-button",9),_("onClick",function(){m(e);let i=p();return d(i.deleteSelected())}),o()()}if(a&2){let e=p();c(2),u("disabled",!e.selectedItems.length)}}function nr(a,t){if(a&1){let e=C();r(0,"div",7)(1,"p-button",10),_("onClick",function(){m(e);let i=p();return d(i.exportCSV())}),o(),r(2,"p-iconfield"),h(3,"p-inputicon",11),r(4,"input",12),S("ngModelChange",function(i){m(e);let s=p();return v(s.searchValue,i)||(s.searchValue=i),d(i)}),_("input",function(){m(e);let i=p();return d(i.filter())}),o()()()}if(a&2){let e=p();c(4),y("ngModel",e.searchValue)}}function ir(a,t){a&1&&(r(0,"tr")(1,"th",13),h(2,"p-tableHeaderCheckbox"),o(),r(3,"th",14),l(4,"ID"),o(),r(5,"th",15),l(6,"Brand "),h(7,"p-sortIcon",16),o(),r(8,"th",17),l(9,"Actions"),o()())}function rr(a,t){if(a&1){let e=C();r(0,"tr")(1,"td"),h(2,"p-tableCheckbox",18),o(),r(3,"td"),l(4),o(),r(5,"td"),l(6),o(),r(7,"td")(8,"div",19)(9,"p-button",20),_("onClick",function(){let i=m(e).$implicit,s=p();return d(s.edit(i))}),o(),r(10,"p-button",21),_("onClick",function(){let i=m(e).$implicit,s=p();return d(s.delete(i))}),o()()()()}if(a&2){let e=t.$implicit;c(2),u("value",e),c(2),f(e.brandId),c(2),f(e.brandName),c(3),u("rounded",!0)("text",!0),c(),u("rounded",!0)("text",!0)}}function or(a,t){a&1&&(r(0,"tr")(1,"td",22),l(2,"No brands found"),o()())}var zt=class a{constructor(t,e,n){this.userService=t;this.messageService=e;this.assetService=n}items=[];filteredItems=[];selectedItems=[];searchValue="";loading=!0;ngOnInit(){this.loadItems()}loadItems(){this.loading=!0,this.assetService.getBrands().subscribe({next:t=>{this.items=t||[],this.filteredItems=[...this.items],this.loading=!1},error:t=>{console.error("Error loading brands:",t),this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load brands"}),this.loading=!1}})}filter(){this.filteredItems=this.items.filter(t=>t.brandName?.toLowerCase().includes(this.searchValue.toLowerCase()))}onSelectionChange(t){}openNewDialog(){He.default.fire({title:"New Brand",html:'<input type="text" id="brandName" class="swal2-input" placeholder="Brand Name" />',confirmButtonText:"Create",cancelButtonText:"Cancel",showCancelButton:!0,preConfirm:()=>{let t=document.getElementById("brandName")?.value.trim();return t?{brandName:t}:(He.default.showValidationMessage("Brand name is required"),!1)}}).then(t=>{t.isConfirmed&&t.value&&this.assetService.createBrand(t.value).subscribe({next:e=>{this.items.push(e),this.filteredItems=[...this.items],He.default.fire({title:"Good job!",text:"Brand created successfully!",icon:"success"})},error:()=>this.messageService.add({severity:"error",summary:"Error",detail:"Create failed"})})})}view(t){He.default.fire({title:"Brand",html:`<strong>Name:</strong> ${t.brandName}`,icon:"info"})}edit(t){He.default.fire({title:"Edit Brand",html:`<input type="text" id="brandName" class="swal2-input" value="${t.brandName}" />`,confirmButtonText:"Update",cancelButtonText:"Cancel",showCancelButton:!0,preConfirm:()=>{let e=document.getElementById("brandName")?.value.trim();return e?{brandName:e}:(He.default.showValidationMessage("Brand name is required"),!1)}}).then(e=>{e.isConfirmed&&e.value&&this.assetService.updateBrand(t.brandId,e.value).subscribe({next:n=>{let i=this.items.findIndex(s=>s.brandId===n.brandId);i>-1&&(this.items[i]=n),this.filteredItems=[...this.items],this.messageService.add({severity:"success",summary:"Updated",detail:"Brand updated"})},error:()=>this.messageService.add({severity:"error",summary:"Error",detail:"Update failed"})})})}delete(t){He.default.fire({title:"Delete Brand",text:`Delete "${t.brandName}"?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Delete"}).then(e=>{e.isConfirmed&&this.assetService.deleteBrand(t.brandId).subscribe({next:()=>{this.items=this.items.filter(n=>n.brandId!==t.brandId),this.filteredItems=[...this.items],this.messageService.add({severity:"success",summary:"Deleted",detail:"Brand deleted"})},error:()=>this.messageService.add({severity:"error",summary:"Error",detail:"Delete failed"})})})}deleteSelected(){this.selectedItems?.length&&He.default.fire({title:"Delete Selected",text:`Delete ${this.selectedItems.length} brand(s)?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Delete"}).then(t=>{if(t.isConfirmed){let e=this.selectedItems.map(n=>n.brandId);Promise.all(e.map(n=>this.assetService.deleteBrand(n).toPromise())).then(()=>{this.items=this.items.filter(n=>!e.includes(n.brandId)),this.filteredItems=[...this.items],this.selectedItems=[],this.messageService.add({severity:"success",summary:"Deleted",detail:"Selected brands deleted"})}).catch(()=>this.messageService.add({severity:"error",summary:"Error",detail:"Bulk delete failed"}))}})}exportCSV(){let t=`Brand Name,ID
`;this.items.forEach(s=>{t+=`${(s.brandName||"").replace(/,/g,";")},${s.brandId}
`});let e=new Blob([t],{type:"text/csv"}),n=URL.createObjectURL(e),i=document.createElement("a");i.href=n,i.download="brands.csv",i.click(),URL.revokeObjectURL(n)}static \u0275fac=function(e){return new(e||a)(w(Ce),w(M),w(Me))};static \u0275cmp=I({type:a,selectors:[["app-brand"]],features:[F([M])],decls:10,vars:11,consts:[["start",""],["end",""],["styleClass","mb-4"],["dataKey","brandId","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} brands",3,"selectionChange","value","rows","paginator","rowsPerPageOptions","loading","rowHover","selection","showCurrentPageReport","tableStyle"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"flex","items-center","gap-2"],["label","New","icon","pi pi-plus","severity","secondary",3,"onClick"],["label","Delete Selected","icon","pi pi-trash","severity","secondary","outlined","",3,"onClick","disabled"],["label","Export","icon","pi pi-upload","severity","secondary",3,"onClick"],["styleClass","pi pi-search"],["pInputText","","type","text","placeholder","Search brands...",3,"ngModelChange","input","ngModel"],[2,"width","3rem"],[2,"min-width","25rem"],["pSortableColumn","brandName",2,"min-width","20rem"],["field","brandName"],[2,"min-width","12rem"],[3,"value"],[1,"flex","gap-2"],["icon","pi pi-pencil","severity","secondary",3,"onClick","rounded","text"],["icon","pi pi-trash","severity","danger",3,"onClick","rounded","text"],["colspan","4",1,"text-center","py-5"]],template:function(e,n){if(e&1){let i=C();h(0,"p-toast"),r(1,"p-toolbar",2),b(2,tr,3,1,"ng-template",null,0,x)(4,nr,5,1,"ng-template",null,1,x),o(),r(6,"p-table",3),S("selectionChange",function(g){return m(i),v(n.selectedItems,g)||(n.selectedItems=g),d(g)}),_("selectionChange",function(g){return m(i),d(n.onSelectionChange(g))}),b(7,ir,10,0,"ng-template",4)(8,rr,11,7,"ng-template",5)(9,or,3,0,"ng-template",6),o()}e&2&&(c(6),u("value",n.filteredItems)("rows",10)("paginator",!0)("rowsPerPageOptions",E(9,Zi))("loading",n.loading)("rowHover",!0),y("selection",n.selectedItems),u("showCurrentPageReport",!0)("tableStyle",E(10,er)))},dependencies:[P,z,$,N,V,R,U,q,H,ee,te,A,Q,se,B,O,W,j,G,X,J,Z,L,Y,D,k],styles:[".action-buttons[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center}.action-buttons[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]{margin:0}p-table[_ngcontent-%COMP%]     .p-datatable .p-datatable-thead>tr>th{padding:1rem;background-color:var(--primary-color);color:var(--primary-contrast-color);font-weight:600}p-table[_ngcontent-%COMP%]     .p-datatable .p-datatable-tbody>tr:hover{background-color:var(--surface-hover)}p-table[_ngcontent-%COMP%]     .p-datatable .p-datatable-tbody>tr>td{padding:1rem;vertical-align:middle}p-table[_ngcontent-%COMP%]     .p-datatable .p-datatable-emptymessage>tr>td{padding:2rem;text-align:center;color:var(--text-color-secondary)}p-table[_ngcontent-%COMP%]     .p-paginator{padding:1rem;background-color:var(--surface-overlay);border:1px solid var(--surface-border)}p-toolbar[_ngcontent-%COMP%]     .p-toolbar{padding:1rem;background-color:var(--surface-overlay);border:1px solid var(--surface-border);border-radius:var(--content-border-radius);margin-bottom:1.5rem}p-toolbar[_ngcontent-%COMP%]     .p-toolbar .p-toolbar-group-start, p-toolbar[_ngcontent-%COMP%]     .p-toolbar .p-toolbar-group-end{display:flex;gap:.5rem;align-items:center}p-tooltip[_ngcontent-%COMP%]     .p-tooltip{background-color:var(--surface-overlay);color:var(--text-color);border:1px solid var(--surface-border)}p-iconfield[_ngcontent-%COMP%]     input{width:250px;padding:.75rem 1rem .75rem 2.5rem;border:1px solid var(--surface-border);border-radius:var(--content-border-radius);background-color:var(--surface-card);color:var(--text-color);transition:border-color var(--element-transition-duration)}p-iconfield[_ngcontent-%COMP%]     input:focus{border-color:var(--primary-color);outline:none}p-iconfield[_ngcontent-%COMP%]     input::placeholder{color:var(--text-color-secondary)}"]})};var ze=Ee(Pe());var ar=()=>[10,20,30],lr=()=>({"min-width":"70rem"});function sr(a,t){if(a&1){let e=C();r(0,"div",7)(1,"p-button",8),_("onClick",function(){m(e);let i=p();return d(i.openNewDialog())}),o(),r(2,"p-button",9),_("onClick",function(){m(e);let i=p();return d(i.deleteSelected())}),o()()}if(a&2){let e=p();c(2),u("disabled",!e.selectedItems.length)}}function cr(a,t){if(a&1){let e=C();r(0,"div",7)(1,"p-button",10),_("onClick",function(){m(e);let i=p();return d(i.exportCSV())}),o(),r(2,"p-iconfield"),h(3,"p-inputicon",11),r(4,"input",12),S("ngModelChange",function(i){m(e);let s=p();return v(s.searchValue,i)||(s.searchValue=i),d(i)}),_("input",function(){m(e);let i=p();return d(i.filter())}),o()()()}if(a&2){let e=p();c(4),y("ngModel",e.searchValue)}}function pr(a,t){a&1&&(r(0,"tr")(1,"th",13),h(2,"p-tableHeaderCheckbox"),o(),r(3,"th",14),l(4,"ID"),o(),r(5,"th",15),l(6,"Color "),h(7,"p-sortIcon",16),o(),r(8,"th",17),l(9,"Actions"),o()())}function mr(a,t){if(a&1){let e=C();r(0,"tr")(1,"td"),h(2,"p-tableCheckbox",18),o(),r(3,"td"),l(4),o(),r(5,"td"),l(6),o(),r(7,"td")(8,"div",19)(9,"p-button",20),_("onClick",function(){let i=m(e).$implicit,s=p();return d(s.view(i))}),o(),r(10,"p-button",21),_("onClick",function(){let i=m(e).$implicit,s=p();return d(s.edit(i))}),o(),r(11,"p-button",22),_("onClick",function(){let i=m(e).$implicit,s=p();return d(s.delete(i))}),o()()()()}if(a&2){let e=t.$implicit;c(2),u("value",e),c(2),f(e.colorId),c(2),f(e.colorName),c(3),u("rounded",!0)("text",!0),c(),u("rounded",!0)("text",!0),c(),u("rounded",!0)("text",!0)}}function dr(a,t){a&1&&(r(0,"tr")(1,"td",23),l(2,"No colors found"),o()())}var Yt=class a{constructor(t,e,n){this.userService=t;this.messageService=e;this.assetService=n}items=[];filteredItems=[];selectedItems=[];searchValue="";loading=!0;ngOnInit(){this.loadItems()}loadItems(){this.loading=!0,this.assetService.getColors().subscribe({next:t=>{this.items=t||[],this.filteredItems=[...this.items],this.loading=!1},error:t=>{console.error("Error loading colors:",t),this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load colors"}),this.loading=!1}})}filter(){this.filteredItems=this.items.filter(t=>t.colorName?.toLowerCase().includes(this.searchValue.toLowerCase()))}onSelectionChange(t){}openNewDialog(){ze.default.fire({title:"New Color",html:'<input type="text" id="colorName" class="swal2-input" placeholder="Color Name" />',confirmButtonText:"Create",cancelButtonText:"Cancel",showCancelButton:!0,preConfirm:()=>{let t=document.getElementById("colorName")?.value.trim();return t?{colorName:t}:(ze.default.showValidationMessage("Color name is required"),!1)}}).then(t=>{t.isConfirmed&&t.value&&this.assetService.createColor(t.value).subscribe({next:e=>{this.items.push(e),this.filteredItems=[...this.items],ze.default.fire({title:"Good job!",text:"Brand created successfully!",icon:"success"})},error:e=>{console.error("Error creating color:",e);let n=e?.error?.message||e?.message||"Create failed";this.messageService.add({severity:"error",summary:"Error",detail:n})}})})}view(t){ze.default.fire({title:"Color",html:`<strong>Name:</strong> ${t.colorName}`,icon:"info"})}edit(t){ze.default.fire({title:"Edit Color",html:`<input type="text" id="colorName" class="swal2-input" value="${t.colorName}" />`,confirmButtonText:"Update",cancelButtonText:"Cancel",showCancelButton:!0,preConfirm:()=>{let e=document.getElementById("colorName")?.value.trim();return e?{colorName:e}:(ze.default.showValidationMessage("Color name is required"),!1)}}).then(e=>{e.isConfirmed&&e.value&&this.assetService.updateColor(t.colorId,e.value).subscribe({next:n=>{let i=this.items.findIndex(s=>s.colorId===n.colorId);i>-1&&(this.items[i]=n),this.filteredItems=[...this.items],this.messageService.add({severity:"success",summary:"Updated",detail:"Color updated"})},error:()=>this.messageService.add({severity:"error",summary:"Error",detail:"Update failed"})})})}delete(t){ze.default.fire({title:"Delete Color",text:`Delete "${t.colorName}"?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Delete"}).then(e=>{e.isConfirmed&&this.assetService.deleteColor(t.colorId).subscribe({next:()=>{this.items=this.items.filter(n=>n.colorId!==t.colorId),this.filteredItems=[...this.items],this.messageService.add({severity:"success",summary:"Deleted",detail:"Color deleted"})},error:()=>this.messageService.add({severity:"error",summary:"Error",detail:"Delete failed"})})})}deleteSelected(){this.selectedItems?.length&&ze.default.fire({title:"Delete Selected",text:`Delete ${this.selectedItems.length} color(s)?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Delete"}).then(t=>{if(t.isConfirmed){let e=this.selectedItems.map(n=>n.colorId);Promise.all(e.map(n=>this.assetService.deleteColor(n).toPromise())).then(()=>{this.items=this.items.filter(n=>!e.includes(n.colorId)),this.filteredItems=[...this.items],this.selectedItems=[],this.messageService.add({severity:"success",summary:"Deleted",detail:"Selected colors deleted"})}).catch(()=>this.messageService.add({severity:"error",summary:"Error",detail:"Bulk delete failed"}))}})}exportCSV(){let t=`Color Name,ID
`;this.items.forEach(s=>{t+=`${(s.colorName||"").replace(/,/g,";")},${s.colorId}
`});let e=new Blob([t],{type:"text/csv"}),n=URL.createObjectURL(e),i=document.createElement("a");i.href=n,i.download="colors.csv",i.click(),URL.revokeObjectURL(n)}static \u0275fac=function(e){return new(e||a)(w(Ce),w(M),w(Me))};static \u0275cmp=I({type:a,selectors:[["app-color"]],features:[F([M])],decls:10,vars:11,consts:[["start",""],["end",""],["styleClass","mb-4"],["dataKey","colorId","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} colors",3,"selectionChange","value","rows","paginator","rowsPerPageOptions","loading","rowHover","selection","showCurrentPageReport","tableStyle"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"flex","items-center","gap-2"],["label","New","icon","pi pi-plus","severity","secondary",3,"onClick"],["label","Delete Selected","icon","pi pi-trash","severity","secondary","outlined","",3,"onClick","disabled"],["label","Export","icon","pi pi-upload","severity","secondary",3,"onClick"],["styleClass","pi pi-search"],["pInputText","","type","text","placeholder","Search colors...",3,"ngModelChange","input","ngModel"],[2,"width","3rem"],[2,"min-width","25rem"],["pSortableColumn","colorName",2,"min-width","20rem"],["field","colorName"],[2,"min-width","12rem"],[3,"value"],[1,"flex","gap-2"],["icon","pi pi-eye","severity","info",3,"onClick","rounded","text"],["icon","pi pi-pencil","severity","secondary",3,"onClick","rounded","text"],["icon","pi pi-trash","severity","danger",3,"onClick","rounded","text"],["colspan","4",1,"text-center","py-5"]],template:function(e,n){if(e&1){let i=C();h(0,"p-toast"),r(1,"p-toolbar",2),b(2,sr,3,1,"ng-template",null,0,x)(4,cr,5,1,"ng-template",null,1,x),o(),r(6,"p-table",3),S("selectionChange",function(g){return m(i),v(n.selectedItems,g)||(n.selectedItems=g),d(g)}),_("selectionChange",function(g){return m(i),d(n.onSelectionChange(g))}),b(7,pr,10,0,"ng-template",4)(8,mr,12,9,"ng-template",5)(9,dr,3,0,"ng-template",6),o()}e&2&&(c(6),u("value",n.filteredItems)("rows",10)("paginator",!0)("rowsPerPageOptions",E(9,ar))("loading",n.loading)("rowHover",!0),y("selection",n.selectedItems),u("showCurrentPageReport",!0)("tableStyle",E(10,lr)))},dependencies:[P,z,$,N,V,R,U,q,H,ee,te,A,Q,se,B,O,W,j,G,X,J,Z,L,Y,D,k],styles:[".action-buttons[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center}.action-buttons[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]{margin:0}p-table[_ngcontent-%COMP%]     .p-datatable .p-datatable-thead>tr>th{padding:1rem;background-color:var(--primary-color);color:var(--primary-contrast-color);font-weight:600}p-table[_ngcontent-%COMP%]     .p-datatable .p-datatable-tbody>tr:hover{background-color:var(--surface-hover)}p-table[_ngcontent-%COMP%]     .p-datatable .p-datatable-tbody>tr>td{padding:1rem;vertical-align:middle}p-table[_ngcontent-%COMP%]     .p-datatable .p-datatable-emptymessage>tr>td{padding:2rem;text-align:center;color:var(--text-color-secondary)}p-table[_ngcontent-%COMP%]     .p-paginator{padding:1rem;background-color:var(--surface-overlay);border:1px solid var(--surface-border)}p-toolbar[_ngcontent-%COMP%]     .p-toolbar{padding:1rem;background-color:var(--surface-overlay);border:1px solid var(--surface-border);border-radius:var(--content-border-radius);margin-bottom:1.5rem}p-toolbar[_ngcontent-%COMP%]     .p-toolbar .p-toolbar-group-start, p-toolbar[_ngcontent-%COMP%]     .p-toolbar .p-toolbar-group-end{display:flex;gap:.5rem;align-items:center}p-tooltip[_ngcontent-%COMP%]     .p-tooltip{background-color:var(--surface-overlay);color:var(--text-color);border:1px solid var(--surface-border)}p-iconfield[_ngcontent-%COMP%]     input{width:250px;padding:.75rem 1rem .75rem 2.5rem;border:1px solid var(--surface-border);border-radius:var(--content-border-radius);background-color:var(--surface-card);color:var(--text-color);transition:border-color var(--element-transition-duration)}p-iconfield[_ngcontent-%COMP%]     input:focus{border-color:var(--primary-color);outline:none}p-iconfield[_ngcontent-%COMP%]     input::placeholder{color:var(--text-color-secondary)}"]})};var Je=Ee(Pe());var ur=()=>[10,20,30],gr=()=>({"min-width":"70rem"});function _r(a,t){if(a&1){let e=C();r(0,"div",7)(1,"p-button",8),_("onClick",function(){m(e);let i=p();return d(i.openNewDialog())}),o(),r(2,"p-button",9),_("onClick",function(){m(e);let i=p();return d(i.deleteSelected())}),o()()}if(a&2){let e=p();c(2),u("disabled",!e.selectedItems.length)}}function fr(a,t){if(a&1){let e=C();r(0,"div",7)(1,"p-button",10),_("onClick",function(){m(e);let i=p();return d(i.exportCSV())}),o(),r(2,"p-iconfield"),h(3,"p-inputicon",11),r(4,"input",12),S("ngModelChange",function(i){m(e);let s=p();return v(s.searchValue,i)||(s.searchValue=i),d(i)}),_("input",function(){m(e);let i=p();return d(i.filter())}),o()()()}if(a&2){let e=p();c(4),y("ngModel",e.searchValue)}}function hr(a,t){a&1&&(r(0,"tr")(1,"th",13),h(2,"p-tableHeaderCheckbox"),o(),r(3,"th",14),l(4,"ID"),o(),r(5,"th",15),l(6,"Status "),h(7,"p-sortIcon",16),o(),r(8,"th",17),l(9,"Actions"),o()())}function br(a,t){if(a&1){let e=C();r(0,"tr")(1,"td"),h(2,"p-tableCheckbox",18),o(),r(3,"td"),l(4),o(),r(5,"td"),l(6),o(),r(7,"td")(8,"div",19)(9,"p-button",20),_("onClick",function(){let i=m(e).$implicit,s=p();return d(s.view(i))}),o(),r(10,"p-button",21),_("onClick",function(){let i=m(e).$implicit,s=p();return d(s.edit(i))}),o(),r(11,"p-button",22),_("onClick",function(){let i=m(e).$implicit,s=p();return d(s.delete(i))}),o()()()()}if(a&2){let e=t.$implicit;c(2),u("value",e),c(2),f(e.statusId),c(2),f(e.statusName),c(3),u("rounded",!0)("text",!0),c(),u("rounded",!0)("text",!0),c(),u("rounded",!0)("text",!0)}}function Cr(a,t){a&1&&(r(0,"tr")(1,"td",23),l(2,"No statuses found"),o()())}var Qt=class a{constructor(t,e){this.messageService=t;this.assetService=e}items=[];filteredItems=[];selectedItems=[];searchValue="";loading=!0;ngOnInit(){this.loadItems()}loadItems(){this.loading=!0,this.assetService.getStatuses().subscribe({next:t=>{t&&t.length>0,this.items=t||[],this.filteredItems=[...this.items],this.loading=!1},error:t=>{console.error("\u274C Error loading statuses:",t),console.error("\u{1F6A8} Error status code:",t?.status),console.error("\u{1F4AC} Error message:",t?.message),console.error("\u{1F4DD} Error details:",t?.error),this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load statuses: "+(t?.error?.message||t?.message)}),this.loading=!1}})}filter(){this.filteredItems=this.items.filter(t=>t.statusName?.toLowerCase().includes(this.searchValue.toLowerCase()))}onSelectionChange(t){}openNewDialog(){Je.default.fire({title:"New Status",html:'<input type="text" id="statusName" class="swal2-input" placeholder="Status Name" />',confirmButtonText:"Create",cancelButtonText:"Cancel",showCancelButton:!0,preConfirm:()=>{let t=document.getElementById("statusName")?.value.trim();return t?{statusName:t}:(Je.default.showValidationMessage("Status name is required"),!1)}}).then(t=>{t.isConfirmed&&t.value&&this.assetService.createStatus(t.value).subscribe({next:e=>{this.items.push(e),this.filteredItems=[...this.items],this.messageService.add({severity:"success",summary:"Created",detail:"Status created"})},error:()=>this.messageService.add({severity:"error",summary:"Error",detail:"Create failed"})})})}view(t){Je.default.fire({title:"View Status",html:`
                <div style="text-align: left;">
                    <p><strong>Status Name:</strong> ${t.statusName}</p>
                </div>
            `,icon:"info"})}edit(t){Je.default.fire({title:"Edit Status",html:`<input type="text" id="statusName" class="swal2-input" value="${t.statusName}" />`,confirmButtonText:"Update",cancelButtonText:"Cancel",showCancelButton:!0,preConfirm:()=>{let e=document.getElementById("statusName")?.value.trim();return e?{statusName:e}:(Je.default.showValidationMessage("Status name is required"),!1)}}).then(e=>{e.isConfirmed&&e.value&&this.assetService.updateStatus(t.statusId,e.value).subscribe({next:n=>{let i=this.items.findIndex(s=>s.statusId===n.statusId);i>-1&&(this.items[i]=n),this.filteredItems=[...this.items],this.messageService.add({severity:"success",summary:"Updated",detail:"Status updated"})},error:()=>this.messageService.add({severity:"error",summary:"Error",detail:"Update failed"})})})}delete(t){Je.default.fire({title:"Delete Status",text:`Delete "${t.statusName}"?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Delete"}).then(e=>{e.isConfirmed&&this.assetService.deleteStatus(t.statusId).subscribe({next:()=>{this.items=this.items.filter(n=>n.statusId!==t.statusId),this.filteredItems=[...this.items],this.messageService.add({severity:"success",summary:"Deleted",detail:"Status deleted"})},error:()=>this.messageService.add({severity:"error",summary:"Error",detail:"Delete failed"})})})}deleteSelected(){this.selectedItems?.length&&Je.default.fire({title:"Delete Selected",text:`Delete ${this.selectedItems.length} status(es)?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Delete"}).then(t=>{if(t.isConfirmed){let e=this.selectedItems.map(n=>n.statusId);Promise.all(e.map(n=>this.assetService.deleteStatus(n).toPromise())).then(()=>{this.items=this.items.filter(n=>!e.includes(n.statusId)),this.filteredItems=[...this.items],this.selectedItems=[],this.messageService.add({severity:"success",summary:"Deleted",detail:"Selected statuses deleted"})}).catch(()=>this.messageService.add({severity:"error",summary:"Error",detail:"Bulk delete failed"}))}})}exportCSV(){let t=`Status Name,ID
`;this.items.forEach(s=>{t+=`${(s.statusName||"").replace(/,/g,";")},${s.statusId}
`});let e=new Blob([t],{type:"text/csv"}),n=URL.createObjectURL(e),i=document.createElement("a");i.href=n,i.download="statuses.csv",i.click(),URL.revokeObjectURL(n)}static \u0275fac=function(e){return new(e||a)(w(M),w(Me))};static \u0275cmp=I({type:a,selectors:[["app-status"]],features:[F([M])],decls:10,vars:11,consts:[["start",""],["end",""],["styleClass","mb-4"],["dataKey","statusId","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} statuses",3,"selectionChange","value","rows","paginator","rowsPerPageOptions","loading","rowHover","selection","showCurrentPageReport","tableStyle"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"flex","items-center","gap-2"],["label","New","icon","pi pi-plus","severity","secondary",3,"onClick"],["label","Delete Selected","icon","pi pi-trash","severity","secondary","outlined","",3,"onClick","disabled"],["label","Export","icon","pi pi-upload","severity","secondary",3,"onClick"],["styleClass","pi pi-search"],["pInputText","","type","text","placeholder","Search statuses...",3,"ngModelChange","input","ngModel"],[2,"width","3rem"],[2,"min-width","25rem"],["pSortableColumn","statusName",2,"min-width","20rem"],["field","statusName"],[2,"min-width","12rem"],[3,"value"],[1,"flex","gap-2"],["icon","pi pi-eye","severity","info",3,"onClick","rounded","text"],["icon","pi pi-pencil","severity","secondary",3,"onClick","rounded","text"],["icon","pi pi-trash","severity","danger",3,"onClick","rounded","text"],["colspan","4",1,"text-center","py-5"]],template:function(e,n){if(e&1){let i=C();h(0,"p-toast"),r(1,"p-toolbar",2),b(2,_r,3,1,"ng-template",null,0,x)(4,fr,5,1,"ng-template",null,1,x),o(),r(6,"p-table",3),S("selectionChange",function(g){return m(i),v(n.selectedItems,g)||(n.selectedItems=g),d(g)}),_("selectionChange",function(g){return m(i),d(n.onSelectionChange(g))}),b(7,hr,10,0,"ng-template",4)(8,br,12,9,"ng-template",5)(9,Cr,3,0,"ng-template",6),o()}e&2&&(c(6),u("value",n.filteredItems)("rows",10)("paginator",!0)("rowsPerPageOptions",E(9,ur))("loading",n.loading)("rowHover",!0),y("selection",n.selectedItems),u("showCurrentPageReport",!0)("tableStyle",E(10,gr)))},dependencies:[P,z,$,N,V,R,U,q,H,ee,te,A,Q,se,B,O,W,j,G,X,J,Z,L,Y,D,k],styles:[".action-buttons[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center}.action-buttons[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]{margin:0}p-table[_ngcontent-%COMP%]     .p-datatable .p-datatable-thead>tr>th{padding:1rem;background-color:var(--primary-color);color:var(--primary-contrast-color);font-weight:600}p-table[_ngcontent-%COMP%]     .p-datatable .p-datatable-tbody>tr:hover{background-color:var(--surface-hover)}p-table[_ngcontent-%COMP%]     .p-datatable .p-datatable-tbody>tr>td{padding:1rem;vertical-align:middle}p-table[_ngcontent-%COMP%]     .p-datatable .p-datatable-emptymessage>tr>td{padding:2rem;text-align:center;color:var(--text-color-secondary)}p-table[_ngcontent-%COMP%]     .p-paginator{padding:1rem;background-color:var(--surface-overlay);border:1px solid var(--surface-border)}p-toolbar[_ngcontent-%COMP%]     .p-toolbar{padding:1rem;background-color:var(--surface-overlay);border:1px solid var(--surface-border);border-radius:var(--content-border-radius);margin-bottom:1.5rem}p-toolbar[_ngcontent-%COMP%]     .p-toolbar .p-toolbar-group-start, p-toolbar[_ngcontent-%COMP%]     .p-toolbar .p-toolbar-group-end{display:flex;gap:.5rem;align-items:center}p-tooltip[_ngcontent-%COMP%]     .p-tooltip{background-color:var(--surface-overlay);color:var(--text-color);border:1px solid var(--surface-border)}p-iconfield[_ngcontent-%COMP%]     input{width:250px;padding:.75rem 1rem .75rem 2.5rem;border:1px solid var(--surface-border);border-radius:var(--content-border-radius);background-color:var(--surface-card);color:var(--text-color);transition:border-color var(--element-transition-duration)}p-iconfield[_ngcontent-%COMP%]     input:focus{border-color:var(--primary-color);outline:none}p-iconfield[_ngcontent-%COMP%]     input::placeholder{color:var(--text-color-secondary)}"]})};var Ye=Ee(Pe());var xr=()=>[10,20,30],yr=()=>({"min-width":"70rem"});function vr(a,t){if(a&1){let e=C();r(0,"div",7)(1,"p-button",8),_("onClick",function(){m(e);let i=p();return d(i.openNewDialog())}),o(),r(2,"p-button",9),_("onClick",function(){m(e);let i=p();return d(i.deleteSelected())}),o()()}if(a&2){let e=p();c(2),u("disabled",!e.selectedItems.length)}}function Sr(a,t){if(a&1){let e=C();r(0,"div",7)(1,"p-button",10),_("onClick",function(){m(e);let i=p();return d(i.exportCSV())}),o(),r(2,"p-iconfield"),h(3,"p-inputicon",11),r(4,"input",12),S("ngModelChange",function(i){m(e);let s=p();return v(s.searchValue,i)||(s.searchValue=i),d(i)}),_("input",function(){m(e);let i=p();return d(i.filter())}),o()()()}if(a&2){let e=p();c(4),y("ngModel",e.searchValue)}}function wr(a,t){a&1&&(r(0,"tr")(1,"th",13),h(2,"p-tableHeaderCheckbox"),o(),r(3,"th",14),l(4,"ID"),o(),r(5,"th",15),l(6,"Program "),h(7,"p-sortIcon",16),o(),r(8,"th",17),l(9,"Actions"),o()())}function Mr(a,t){if(a&1){let e=C();r(0,"tr")(1,"td"),h(2,"p-tableCheckbox",18),o(),r(3,"td"),l(4),o(),r(5,"td"),l(6),o(),r(7,"td")(8,"div",19)(9,"p-button",20),_("onClick",function(){let i=m(e).$implicit,s=p();return d(s.view(i))}),o(),r(10,"p-button",21),_("onClick",function(){let i=m(e).$implicit,s=p();return d(s.edit(i))}),o(),r(11,"p-button",22),_("onClick",function(){let i=m(e).$implicit,s=p();return d(s.delete(i))}),o()()()()}if(a&2){let e=t.$implicit;c(2),u("value",e),c(2),f(e.programId),c(2),f(e.programName),c(3),u("rounded",!0)("text",!0),c(),u("rounded",!0)("text",!0),c(),u("rounded",!0)("text",!0)}}function Er(a,t){a&1&&(r(0,"tr")(1,"td",23),l(2,"No programs found"),o()())}var Gt=class a{constructor(t,e,n){this.userService=t;this.messageService=e;this.assetService=n}items=[];filteredItems=[];selectedItems=[];searchValue="";loading=!0;ngOnInit(){this.loadItems()}loadItems(){this.loading=!0,this.assetService.getPrograms().subscribe({next:t=>{this.items=t||[],this.filteredItems=[...this.items],this.loading=!1},error:t=>{console.error("Error loading programs:",t),this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load programs"}),this.loading=!1}})}filter(){this.filteredItems=this.items.filter(t=>t.programName?.toLowerCase().includes(this.searchValue.toLowerCase()))}onSelectionChange(t){}openNewDialog(){Ye.default.fire({title:"New Program",html:'<input type="text" id="programName" class="swal2-input" placeholder="Program Name" />',confirmButtonText:"Create",cancelButtonText:"Cancel",showCancelButton:!0,preConfirm:()=>{let t=document.getElementById("programName")?.value.trim();return t?{programName:t}:(Ye.default.showValidationMessage("Program name is required"),!1)}}).then(t=>{t.isConfirmed&&t.value&&this.assetService.createProgram(t.value).subscribe({next:e=>{this.items.push(e),this.filteredItems=[...this.items],Ye.default.fire({title:"Good job!",text:"Brand created successfully!",icon:"success"})},error:()=>this.messageService.add({severity:"error",summary:"Error",detail:"Create failed"})})})}view(t){Ye.default.fire({title:"Program",html:`<strong>Name:</strong> ${t.programName}`,icon:"info"})}edit(t){Ye.default.fire({title:"Edit Program",html:`<input type="text" id="programName" class="swal2-input" value="${t.programName}" />`,confirmButtonText:"Update",cancelButtonText:"Cancel",showCancelButton:!0,preConfirm:()=>{let e=document.getElementById("programName")?.value.trim();return e?{programName:e}:(Ye.default.showValidationMessage("Program name is required"),!1)}}).then(e=>{e.isConfirmed&&e.value&&this.assetService.updateProgram(t.programId,e.value).subscribe({next:n=>{let i=this.items.findIndex(s=>s.programId===n.programId);i>-1&&(this.items[i]=n),this.filteredItems=[...this.items],this.messageService.add({severity:"success",summary:"Updated",detail:"Program updated"})},error:()=>this.messageService.add({severity:"error",summary:"Error",detail:"Update failed"})})})}delete(t){Ye.default.fire({title:"Delete Program",text:`Delete "${t.programName}"?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Delete"}).then(e=>{e.isConfirmed&&this.assetService.deleteProgram(t.programId).subscribe({next:()=>{this.items=this.items.filter(n=>n.programId!==t.programId),this.filteredItems=[...this.items],this.messageService.add({severity:"success",summary:"Deleted",detail:"Program deleted"})},error:()=>this.messageService.add({severity:"error",summary:"Error",detail:"Delete failed"})})})}deleteSelected(){this.selectedItems?.length&&Ye.default.fire({title:"Delete Selected",text:`Delete ${this.selectedItems.length} program(s)?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Delete"}).then(t=>{if(t.isConfirmed){let e=this.selectedItems.map(n=>n.programId);Promise.all(e.map(n=>this.assetService.deleteProgram(n).toPromise())).then(()=>{this.items=this.items.filter(n=>!e.includes(n.programId)),this.filteredItems=[...this.items],this.selectedItems=[],this.messageService.add({severity:"success",summary:"Deleted",detail:"Selected programs deleted"})}).catch(()=>this.messageService.add({severity:"error",summary:"Error",detail:"Bulk delete failed"}))}})}exportCSV(){let t=`Program Name,ID
`;this.items.forEach(s=>{t+=`${(s.programName||"").replace(/,/g,";")},${s.programId}
`});let e=new Blob([t],{type:"text/csv"}),n=URL.createObjectURL(e),i=document.createElement("a");i.href=n,i.download="programs.csv",i.click(),URL.revokeObjectURL(n)}static \u0275fac=function(e){return new(e||a)(w(Ce),w(M),w(Me))};static \u0275cmp=I({type:a,selectors:[["app-program"]],features:[F([M])],decls:10,vars:11,consts:[["start",""],["end",""],["styleClass","mb-4"],["dataKey","programId","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} programs",3,"selectionChange","value","rows","paginator","rowsPerPageOptions","loading","rowHover","selection","showCurrentPageReport","tableStyle"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"flex","items-center","gap-2"],["label","New","icon","pi pi-plus","severity","secondary",3,"onClick"],["label","Delete Selected","icon","pi pi-trash","severity","secondary","outlined","",3,"onClick","disabled"],["label","Export","icon","pi pi-upload","severity","secondary",3,"onClick"],["styleClass","pi pi-search"],["pInputText","","type","text","placeholder","Search programs...",3,"ngModelChange","input","ngModel"],[2,"width","3rem"],[2,"min-width","25rem"],["pSortableColumn","programName",2,"min-width","20rem"],["field","programName"],[2,"min-width","12rem"],[3,"value"],[1,"flex","gap-2"],["icon","pi pi-eye","severity","info",3,"onClick","rounded","text"],["icon","pi pi-pencil","severity","secondary",3,"onClick","rounded","text"],["icon","pi pi-trash","severity","danger",3,"onClick","rounded","text"],["colspan","4",1,"text-center","py-5"]],template:function(e,n){if(e&1){let i=C();h(0,"p-toast"),r(1,"p-toolbar",2),b(2,vr,3,1,"ng-template",null,0,x)(4,Sr,5,1,"ng-template",null,1,x),o(),r(6,"p-table",3),S("selectionChange",function(g){return m(i),v(n.selectedItems,g)||(n.selectedItems=g),d(g)}),_("selectionChange",function(g){return m(i),d(n.onSelectionChange(g))}),b(7,wr,10,0,"ng-template",4)(8,Mr,12,9,"ng-template",5)(9,Er,3,0,"ng-template",6),o()}e&2&&(c(6),u("value",n.filteredItems)("rows",10)("paginator",!0)("rowsPerPageOptions",E(9,xr))("loading",n.loading)("rowHover",!0),y("selection",n.selectedItems),u("showCurrentPageReport",!0)("tableStyle",E(10,yr)))},dependencies:[P,z,$,N,V,R,U,q,H,ee,te,A,Q,se,B,O,W,j,G,X,J,Z,L,Y,D,k],styles:[".action-buttons[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center}.action-buttons[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]{margin:0}p-table[_ngcontent-%COMP%]     .p-datatable .p-datatable-thead>tr>th{padding:1rem;background-color:var(--primary-color);color:var(--primary-contrast-color);font-weight:600}p-table[_ngcontent-%COMP%]     .p-datatable .p-datatable-tbody>tr:hover{background-color:var(--surface-hover)}p-table[_ngcontent-%COMP%]     .p-datatable .p-datatable-tbody>tr>td{padding:1rem;vertical-align:middle}p-table[_ngcontent-%COMP%]     .p-datatable .p-datatable-emptymessage>tr>td{padding:2rem;text-align:center;color:var(--text-color-secondary)}p-table[_ngcontent-%COMP%]     .p-paginator{padding:1rem;background-color:var(--surface-overlay);border:1px solid var(--surface-border)}p-toolbar[_ngcontent-%COMP%]     .p-toolbar{padding:1rem;background-color:var(--surface-overlay);border:1px solid var(--surface-border);border-radius:var(--content-border-radius);margin-bottom:1.5rem}p-toolbar[_ngcontent-%COMP%]     .p-toolbar .p-toolbar-group-start, p-toolbar[_ngcontent-%COMP%]     .p-toolbar .p-toolbar-group-end{display:flex;gap:.5rem;align-items:center}p-tooltip[_ngcontent-%COMP%]     .p-tooltip{background-color:var(--surface-overlay);color:var(--text-color);border:1px solid var(--surface-border)}p-iconfield[_ngcontent-%COMP%]     input{width:250px;padding:.75rem 1rem .75rem 2.5rem;border:1px solid var(--surface-border);border-radius:var(--content-border-radius);background-color:var(--surface-card);color:var(--text-color);transition:border-color var(--element-transition-duration)}p-iconfield[_ngcontent-%COMP%]     input:focus{border-color:var(--primary-color);outline:none}p-iconfield[_ngcontent-%COMP%]     input::placeholder{color:var(--text-color-secondary)}"]})};var ce=Ee(Pe());var bn=()=>[10,20,30],Cn=()=>({"min-width":"70rem"});function Tr(a,t){if(a&1){let e=C();r(0,"div",7)(1,"p-button",8),_("onClick",function(){m(e);let i=p();return d(i.openNewDialog())}),o(),r(2,"p-button",9),_("onClick",function(){m(e);let i=p();return d(i.deleteSelected())}),o()()}if(a&2){let e=p();c(2),u("disabled",!e.selectedItems.length)}}function Ir(a,t){if(a&1){let e=C();r(0,"div",7)(1,"p-button",10),_("onClick",function(){m(e);let i=p();return d(i.exportCSV())}),o(),r(2,"p-iconfield"),h(3,"p-inputicon",11),r(4,"input",12),S("ngModelChange",function(i){m(e);let s=p();return v(s.searchValue,i)||(s.searchValue=i),d(i)}),_("input",function(){m(e);let i=p();return d(i.filter())}),o()()()}if(a&2){let e=p();c(4),y("ngModel",e.searchValue)}}function Pr(a,t){a&1&&(r(0,"tr")(1,"th",13),h(2,"p-tableHeaderCheckbox"),o(),r(3,"th",14),l(4,"ID"),o(),r(5,"th",15),l(6,"Program "),h(7,"p-sortIcon",16),o(),r(8,"th",17),l(9,"Actions"),o()())}function Nr(a,t){if(a&1){let e=C();r(0,"tr")(1,"td"),h(2,"p-tableCheckbox",18),o(),r(3,"td"),l(4),o(),r(5,"td"),l(6),o(),r(7,"td")(8,"div",19)(9,"p-button",20),_("onClick",function(){let i=m(e).$implicit,s=p();return d(s.view(i))}),o(),r(10,"p-button",21),_("onClick",function(){let i=m(e).$implicit,s=p();return d(s.edit(i))}),o(),r(11,"p-button",22),_("onClick",function(){let i=m(e).$implicit,s=p();return d(s.delete(i))}),o()()()()}if(a&2){let e=t.$implicit;c(2),u("value",e),c(2),f(e.programId),c(2),f(e.programName),c(3),u("rounded",!0)("text",!0),c(),u("rounded",!0)("text",!0),c(),u("rounded",!0)("text",!0)}}function Dr(a,t){a&1&&(r(0,"tr")(1,"td",23),l(2,"No programs found"),o()())}function kr(a,t){if(a&1){let e=C();r(0,"div",7)(1,"p-button",8),_("onClick",function(){m(e);let i=p();return d(i.openNewDialog())}),o(),r(2,"p-button",9),_("onClick",function(){m(e);let i=p();return d(i.deleteSelected())}),o()()}if(a&2){let e=p();c(2),u("disabled",!e.selectedItems.length)}}function Lr(a,t){if(a&1){let e=C();r(0,"div",7)(1,"p-button",10),_("onClick",function(){m(e);let i=p();return d(i.exportCSV())}),o(),r(2,"p-iconfield"),h(3,"p-inputicon",11),r(4,"input",12),S("ngModelChange",function(i){m(e);let s=p();return v(s.searchValue,i)||(s.searchValue=i),d(i)}),_("input",function(){m(e);let i=p();return d(i.filter())}),o()()()}if(a&2){let e=p();c(4),y("ngModel",e.searchValue)}}function Vr(a,t){a&1&&(r(0,"tr")(1,"th",13),h(2,"p-tableHeaderCheckbox"),o(),r(3,"th",14),l(4,"ID"),o(),r(5,"th",15),l(6,"Supplier "),h(7,"p-sortIcon",16),o(),r(8,"th",17),l(9,"Actions"),o()())}function Rr(a,t){if(a&1){let e=C();r(0,"tr")(1,"td"),h(2,"p-tableCheckbox",18),o(),r(3,"td"),l(4),o(),r(5,"td"),l(6),o(),r(7,"td")(8,"div",19)(9,"p-button",20),_("onClick",function(){let i=m(e).$implicit,s=p();return d(s.view(i))}),o(),r(10,"p-button",21),_("onClick",function(){let i=m(e).$implicit,s=p();return d(s.edit(i))}),o(),r(11,"p-button",22),_("onClick",function(){let i=m(e).$implicit,s=p();return d(s.delete(i))}),o()()()()}if(a&2){let e=t.$implicit;c(2),u("value",e),c(2),f(e.supplierId),c(2),f(e.supplierName),c(3),u("rounded",!0)("text",!0),c(),u("rounded",!0)("text",!0),c(),u("rounded",!0)("text",!0)}}function Or(a,t){a&1&&(r(0,"tr")(1,"td",23),l(2,"No suppliers found"),o()())}var xn=".action-buttons[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center}.action-buttons[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]{margin:0}p-table[_ngcontent-%COMP%]     .p-datatable .p-datatable-thead>tr>th{padding:1rem;background-color:var(--primary-color);color:var(--primary-contrast-color);font-weight:600}p-table[_ngcontent-%COMP%]     .p-datatable .p-datatable-tbody>tr:hover{background-color:var(--surface-hover)}p-table[_ngcontent-%COMP%]     .p-datatable .p-datatable-tbody>tr>td{padding:1rem;vertical-align:middle}p-table[_ngcontent-%COMP%]     .p-datatable .p-datatable-emptymessage>tr>td{padding:2rem;text-align:center;color:var(--text-color-secondary)}p-table[_ngcontent-%COMP%]     .p-paginator{padding:1rem;background-color:var(--surface-overlay);border:1px solid var(--surface-border)}p-toolbar[_ngcontent-%COMP%]     .p-toolbar{padding:1rem;background-color:var(--surface-overlay);border:1px solid var(--surface-border);border-radius:var(--content-border-radius);margin-bottom:1.5rem}p-toolbar[_ngcontent-%COMP%]     .p-toolbar .p-toolbar-group-start, p-toolbar[_ngcontent-%COMP%]     .p-toolbar .p-toolbar-group-end{display:flex;gap:.5rem;align-items:center}p-tooltip[_ngcontent-%COMP%]     .p-tooltip{background-color:var(--surface-overlay);color:var(--text-color);border:1px solid var(--surface-border)}p-iconfield[_ngcontent-%COMP%]     input{width:250px;padding:.75rem 1rem .75rem 2.5rem;border:1px solid var(--surface-border);border-radius:var(--content-border-radius);background-color:var(--surface-card);color:var(--text-color);transition:border-color var(--element-transition-duration)}p-iconfield[_ngcontent-%COMP%]     input:focus{border-color:var(--primary-color);outline:none}p-iconfield[_ngcontent-%COMP%]     input::placeholder{color:var(--text-color-secondary)}";function Br(a,t){if(a&1){let e=C();r(0,"div",7)(1,"p-button",8),_("onClick",function(){m(e);let i=p();return d(i.openNewDialog())}),o(),r(2,"p-button",9),_("onClick",function(){m(e);let i=p();return d(i.deleteSelected())}),o()()}if(a&2){let e=p();c(2),u("disabled",!e.selectedItems.length)}}function Ar(a,t){if(a&1){let e=C();r(0,"div",7)(1,"p-button",10),_("onClick",function(){m(e);let i=p();return d(i.exportCSV())}),o(),r(2,"p-iconfield"),h(3,"p-inputicon",11),r(4,"input",12),S("ngModelChange",function(i){m(e);let s=p();return v(s.searchValue,i)||(s.searchValue=i),d(i)}),_("input",function(){m(e);let i=p();return d(i.filter())}),o()()()}if(a&2){let e=p();c(4),y("ngModel",e.searchValue)}}function Ur(a,t){a&1&&(r(0,"tr")(1,"th",13),h(2,"p-tableHeaderCheckbox"),o(),r(3,"th",14),l(4,"ID"),o(),r(5,"th",15),l(6,"Location "),h(7,"p-sortIcon",16),o(),r(8,"th",17),l(9,"Actions"),o()())}function Fr(a,t){if(a&1){let e=C();r(0,"tr")(1,"td"),h(2,"p-tableCheckbox",18),o(),r(3,"td"),l(4),o(),r(5,"td"),l(6),o(),r(7,"td")(8,"div",19)(9,"p-button",20),_("onClick",function(){let i=m(e).$implicit,s=p();return d(s.view(i))}),o(),r(10,"p-button",21),_("onClick",function(){let i=m(e).$implicit,s=p();return d(s.edit(i))}),o(),r(11,"p-button",22),_("onClick",function(){let i=m(e).$implicit,s=p();return d(s.delete(i))}),o()()()()}if(a&2){let e=t.$implicit;c(2),u("value",e),c(2),f(e.locationId),c(2),f(e.locationName),c(3),u("rounded",!0)("text",!0),c(),u("rounded",!0)("text",!0),c(),u("rounded",!0)("text",!0)}}function jr(a,t){a&1&&(r(0,"tr")(1,"td",23),l(2,"No locations found"),o()())}var Tt=class a{constructor(t,e,n){this.userService=t;this.messageService=e;this.assetService=n}items=[];filteredItems=[];selectedItems=[];searchValue="";loading=!0;ngOnInit(){this.loadItems()}loadItems(){this.loading=!0,this.items=[],this.filteredItems=[]}filter(){this.filteredItems=this.items.filter(t=>this.getItemName(t)?.toLowerCase().includes(this.searchValue.toLowerCase()))}getItemName(t){return t.name||t.brandName||t.locationName||t.supplierName||t.programName||t.colorName||""}onSelectionChange(t){}openNewDialog(){}view(t){let e=this.getItemName(t);ce.default.fire({title:"View "+this.itemLabel,html:"<strong>Name:</strong> "+e,icon:"info"})}edit(t){}delete(t){}deleteSelected(){}exportCSV(){let t=this.itemLabel+` Name
`;this.items.forEach(s=>{let g=this.getItemName(s);t+=g+`
`});let e=new Blob([t],{type:"text/csv"}),n=window.URL.createObjectURL(e),i=document.createElement("a");i.href=n,i.download=this.itemLabel.toLowerCase()+".csv",i.click(),window.URL.revokeObjectURL(n)}static \u0275fac=function(e){return new(e||a)(w(Ce),w(M),w(Me))};static \u0275dir=On({type:a})},ci=class a extends Tt{itemLabel="Program";constructor(t,e,n){super(t,e,n)}loadItems(){this.loading=!0,this.assetService.getPrograms().subscribe({next:t=>{this.items=t||[],this.filteredItems=[...this.items],this.loading=!1},error:t=>{console.error("Error loading programs:",t),this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load programs"}),this.loading=!1}})}getItemName(t){return t.programName||""}openNewDialog(){ce.default.fire({title:"New Program",html:`<input id="programName" class="swal2-input" placeholder="Program Name" />
                   <textarea id="description" class="swal2-textarea" placeholder="Description"></textarea>`,confirmButtonText:"Create",showCancelButton:!0,preConfirm:()=>{let t=document.getElementById("programName").value.trim(),e=document.getElementById("description").value.trim();return t?{programName:t,description:e}:(ce.default.showValidationMessage("Program name is required"),!1)}}).then(t=>{t.isConfirmed&&t.value&&this.assetService.createProgram(t.value).subscribe({next:e=>{this.items.push(e),this.filteredItems=[...this.items],this.messageService.add({severity:"success",summary:"Created",detail:"Program created"})},error:()=>this.messageService.add({severity:"error",summary:"Error",detail:"Create failed"})})})}edit(t){ce.default.fire({title:"Edit Program",html:`<input id="programName" class="swal2-input" value="${t.programName}" />
                   <textarea id="description" class="swal2-textarea">${t.description||""}</textarea>`,confirmButtonText:"Update",showCancelButton:!0,preConfirm:()=>{let e=document.getElementById("programName").value.trim(),n=document.getElementById("description").value.trim();return e?{programName:e,description:n}:(ce.default.showValidationMessage("Program name is required"),!1)}}).then(e=>{e.isConfirmed&&e.value&&this.assetService.updateProgram(t.programId,e.value).subscribe({next:n=>{let i=this.items.findIndex(s=>s.programId===n.programId);i>-1&&(this.items[i]=n),this.filteredItems=[...this.items],this.messageService.add({severity:"success",summary:"Updated",detail:"Program updated"})},error:()=>this.messageService.add({severity:"error",summary:"Error",detail:"Update failed"})})})}delete(t){ce.default.fire({title:"Delete Program",text:`Delete "${t.programName}"?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Delete"}).then(e=>{e.isConfirmed&&this.assetService.deleteProgram(t.programId).subscribe({next:()=>{this.items=this.items.filter(n=>n.programId!==t.programId),this.filteredItems=[...this.items],this.messageService.add({severity:"success",summary:"Deleted",detail:"Program deleted"})},error:()=>this.messageService.add({severity:"error",summary:"Error",detail:"Delete failed"})})})}deleteSelected(){this.selectedItems?.length&&ce.default.fire({title:"Delete Selected",text:`Delete ${this.selectedItems.length} program(s)?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Delete"}).then(t=>{if(t.isConfirmed){let e=this.selectedItems.map(n=>n.programId);Promise.all(e.map(n=>this.assetService.deleteProgram(n).toPromise())).then(()=>{this.items=this.items.filter(n=>!e.includes(n.programId)),this.filteredItems=[...this.items],this.selectedItems=[],this.messageService.add({severity:"success",summary:"Deleted",detail:"Selected programs deleted"})}).catch(()=>this.messageService.add({severity:"error",summary:"Error",detail:"Bulk delete failed"}))}})}static \u0275fac=function(e){return new(e||a)(w(Ce),w(M),w(Me))};static \u0275cmp=I({type:a,selectors:[["app-program"]],features:[F([M]),ct],decls:10,vars:11,consts:[["start",""],["end",""],["styleClass","mb-4"],["dataKey","programId","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} programs",3,"selectionChange","value","rows","paginator","rowsPerPageOptions","loading","rowHover","selection","showCurrentPageReport","tableStyle"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"flex","items-center","gap-2"],["label","New","icon","pi pi-plus","severity","secondary",3,"onClick"],["label","Delete Selected","icon","pi pi-trash","severity","secondary","outlined","",3,"onClick","disabled"],["label","Export","icon","pi pi-upload","severity","secondary",3,"onClick"],["styleClass","pi pi-search"],["pInputText","","type","text","placeholder","Search programs...",3,"ngModelChange","input","ngModel"],[2,"width","3rem"],[2,"min-width","25rem"],["pSortableColumn","programName",2,"min-width","20rem"],["field","programName"],[2,"min-width","12rem"],[3,"value"],[1,"flex","gap-2"],["icon","pi pi-eye","severity","info",3,"onClick","rounded","text"],["icon","pi pi-pencil","severity","secondary",3,"onClick","rounded","text"],["icon","pi pi-trash","severity","danger",3,"onClick","rounded","text"],["colspan","4",1,"text-center","py-5"]],template:function(e,n){if(e&1){let i=C();h(0,"p-toast"),r(1,"p-toolbar",2),b(2,Tr,3,1,"ng-template",null,0,x)(4,Ir,5,1,"ng-template",null,1,x),o(),r(6,"p-table",3),S("selectionChange",function(g){return m(i),v(n.selectedItems,g)||(n.selectedItems=g),d(g)}),_("selectionChange",function(g){return m(i),d(n.onSelectionChange(g))}),b(7,Pr,10,0,"ng-template",4)(8,Nr,12,9,"ng-template",5)(9,Dr,3,0,"ng-template",6),o()}e&2&&(c(6),u("value",n.filteredItems)("rows",10)("paginator",!0)("rowsPerPageOptions",E(9,bn))("loading",n.loading)("rowHover",!0),y("selection",n.selectedItems),u("showCurrentPageReport",!0)("tableStyle",E(10,Cn)))},dependencies:[P,z,$,N,V,R,U,q,H,ee,te,A,Q,se,B,O,W,j,G,X,J,Z,L,Y,D,k],styles:[xn]})},Jt=class a extends Tt{itemLabel="Supplier";constructor(t,e,n){super(t,e,n)}loadItems(){this.loading=!0,this.assetService.getSuppliers().subscribe({next:t=>{this.items=t||[],this.filteredItems=[...this.items],this.loading=!1},error:t=>{console.error("Error loading suppliers:",t),this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load suppliers"}),this.loading=!1}})}getItemName(t){return t.supplierName||""}openNewDialog(){ce.default.fire({title:"New Supplier",html:`<input id="supplierName" class="swal2-input" placeholder="Supplier Name" />
                   <input id="supplierAddress" class="swal2-input" placeholder="Supplier Address" />
                   <input id="supplierContactNumber" class="swal2-input" value="+639" placeholder="Contact Number (+639xxxxxxxxx)" />`,confirmButtonText:"Create",showCancelButton:!0,preConfirm:()=>{let t=document.getElementById("supplierName").value.trim(),e=document.getElementById("supplierAddress").value.trim(),n=document.getElementById("supplierContactNumber").value.trim();return t?n&&!this.isValidPhilippinePhoneNumber(n)?(ce.default.showValidationMessage("Contact number must be a valid Philippine phone number +63"),!1):{supplierName:t,supplierAddress:e,supplierContactNumber:n}:(ce.default.showValidationMessage("Supplier name is required"),!1)}}).then(t=>{t.isConfirmed&&t.value&&this.assetService.createSupplier(t.value).subscribe({next:e=>{this.items.push(e),this.filteredItems=[...this.items],this.messageService.add({severity:"success",summary:"Created",detail:"Supplier created"})},error:()=>this.messageService.add({severity:"error",summary:"Error",detail:"Create failed"})})})}edit(t){ce.default.fire({title:"Edit Supplier",html:`<input id="supplierName" class="swal2-input" value="${t.supplierName}" />
                   <input id="supplierAddress" class="swal2-input" value="${t.supplierAddress||""}" />
                   <input id="supplierContactNumber" class="swal2-input" value="${t.supplierContactNumber||""}" placeholder="Contact Number (+63XXXXXXXXXX)" />`,confirmButtonText:"Update",showCancelButton:!0,preConfirm:()=>{let e=document.getElementById("supplierName").value.trim(),n=document.getElementById("supplierAddress").value.trim(),i=document.getElementById("supplierContactNumber").value.trim();return e?i&&!this.isValidPhilippinePhoneNumber(i)?(ce.default.showValidationMessage("Contact number must be a valid Philippine phone number +63"),!1):{supplierName:e,supplierAddress:n,supplierContactNumber:i}:(ce.default.showValidationMessage("Supplier name is required"),!1)}}).then(e=>{e.isConfirmed&&e.value&&this.assetService.updateSupplier(t.supplierId,e.value).subscribe({next:n=>{let i=this.items.findIndex(s=>s.supplierId===n.supplierId);i>-1&&(this.items[i]=n),this.filteredItems=[...this.items],this.messageService.add({severity:"success",summary:"Updated",detail:"Supplier updated"})},error:()=>this.messageService.add({severity:"error",summary:"Error",detail:"Update failed"})})})}delete(t){ce.default.fire({title:"Delete Supplier",text:`Delete "${t.supplierName}"?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Delete"}).then(e=>{e.isConfirmed&&this.assetService.deleteSupplier(t.supplierId).subscribe({next:()=>{this.items=this.items.filter(n=>n.supplierId!==t.supplierId),this.filteredItems=[...this.items],this.messageService.add({severity:"success",summary:"Deleted",detail:"Supplier deleted"})},error:()=>this.messageService.add({severity:"error",summary:"Error",detail:"Delete failed"})})})}deleteSelected(){this.selectedItems?.length&&ce.default.fire({title:"Delete Selected",text:`Delete ${this.selectedItems.length} supplier(s)?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Delete"}).then(t=>{if(t.isConfirmed){let e=this.selectedItems.map(n=>n.supplierId);Promise.all(e.map(n=>this.assetService.deleteSupplier(n).toPromise())).then(()=>{this.items=this.items.filter(n=>!e.includes(n.supplierId)),this.filteredItems=[...this.items],this.selectedItems=[],this.messageService.add({severity:"success",summary:"Deleted",detail:"Selected suppliers deleted"})}).catch(()=>this.messageService.add({severity:"error",summary:"Error",detail:"Bulk delete failed"}))}})}isValidPhilippinePhoneNumber(t){return/^\+63\d{10}$/.test(t)}static \u0275fac=function(e){return new(e||a)(w(Ce),w(M),w(Me))};static \u0275cmp=I({type:a,selectors:[["app-supplier"]],features:[F([M]),ct],decls:10,vars:11,consts:[["start",""],["end",""],["styleClass","mb-4"],["dataKey","supplierId","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} suppliers",3,"selectionChange","value","rows","paginator","rowsPerPageOptions","loading","rowHover","selection","showCurrentPageReport","tableStyle"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"flex","items-center","gap-2"],["label","New","icon","pi pi-plus","severity","secondary",3,"onClick"],["label","Delete Selected","icon","pi pi-trash","severity","secondary","outlined","",3,"onClick","disabled"],["label","Export","icon","pi pi-upload","severity","secondary",3,"onClick"],["styleClass","pi pi-search"],["pInputText","","type","text","placeholder","Search suppliers...",3,"ngModelChange","input","ngModel"],[2,"width","3rem"],[2,"min-width","25rem"],["pSortableColumn","supplierName",2,"min-width","20rem"],["field","supplierName"],[2,"min-width","12rem"],[3,"value"],[1,"flex","gap-2"],["icon","pi pi-eye","severity","info",3,"onClick","rounded","text"],["icon","pi pi-pencil","severity","secondary",3,"onClick","rounded","text"],["icon","pi pi-trash","severity","danger",3,"onClick","rounded","text"],["colspan","4",1,"text-center","py-5"]],template:function(e,n){if(e&1){let i=C();h(0,"p-toast"),r(1,"p-toolbar",2),b(2,kr,3,1,"ng-template",null,0,x)(4,Lr,5,1,"ng-template",null,1,x),o(),r(6,"p-table",3),S("selectionChange",function(g){return m(i),v(n.selectedItems,g)||(n.selectedItems=g),d(g)}),_("selectionChange",function(g){return m(i),d(n.onSelectionChange(g))}),b(7,Vr,10,0,"ng-template",4)(8,Rr,12,9,"ng-template",5)(9,Or,3,0,"ng-template",6),o()}e&2&&(c(6),u("value",n.filteredItems)("rows",10)("paginator",!0)("rowsPerPageOptions",E(9,bn))("loading",n.loading)("rowHover",!0),y("selection",n.selectedItems),u("showCurrentPageReport",!0)("tableStyle",E(10,Cn)))},dependencies:[P,z,$,N,V,R,U,q,H,ee,te,A,Q,se,B,O,W,j,G,X,J,Z,L,Y,D,k],styles:[xn]})},Kt=class a extends Tt{itemLabel="Location";constructor(t,e,n){super(t,e,n)}loadItems(){this.loading=!0,this.assetService.getLocations().subscribe({next:t=>{this.items=t||[],this.filteredItems=[...this.items],this.loading=!1},error:t=>{console.error("Error loading locations:",t),this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load locations"}),this.loading=!1}})}getItemName(t){return t.locationName||""}openNewDialog(){ce.default.fire({title:"New Location",html:`<input id="locationName" class="swal2-input" placeholder="Location Name" />
                  <textarea id="description" class="swal2-textarea" placeholder="Description"></textarea>`,confirmButtonText:"Create",showCancelButton:!0,preConfirm:()=>{let t=document.getElementById("locationName").value.trim(),e=document.getElementById("description").value.trim();return t?{locationName:t,description:e}:(ce.default.showValidationMessage("Location name is required"),!1)}}).then(t=>{t.isConfirmed&&t.value&&this.assetService.createLocation(t.value).subscribe({next:e=>{this.items.push(e),this.filteredItems=[...this.items],this.messageService.add({severity:"success",summary:"Created",detail:"Location created"})},error:()=>this.messageService.add({severity:"error",summary:"Error",detail:"Create failed"})})})}edit(t){ce.default.fire({title:"Edit Location",html:`<input id="locationName" class="swal2-input" value="${t.locationName}" />
                  <textarea id="description" class="swal2-textarea">${t.description||""}</textarea>`,confirmButtonText:"Update",showCancelButton:!0,preConfirm:()=>{let e=document.getElementById("locationName").value.trim(),n=document.getElementById("description").value.trim();return e?{locationName:e,description:n}:(ce.default.showValidationMessage("Location name is required"),!1)}}).then(e=>{e.isConfirmed&&e.value&&this.assetService.updateLocation(t.locationId,e.value).subscribe({next:n=>{let i=this.items.findIndex(s=>s.locationId===n.locationId);i>-1&&(this.items[i]=n),this.filteredItems=[...this.items],this.messageService.add({severity:"success",summary:"Updated",detail:"Location updated"})},error:()=>this.messageService.add({severity:"error",summary:"Error",detail:"Update failed"})})})}delete(t){ce.default.fire({title:"Delete Location",text:`Delete "${t.locationName}"?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Delete"}).then(e=>{e.isConfirmed&&this.assetService.deleteLocation(t.locationId).subscribe({next:()=>{this.items=this.items.filter(n=>n.locationId!==t.locationId),this.filteredItems=[...this.items],this.messageService.add({severity:"success",summary:"Deleted",detail:"Location deleted"})},error:()=>this.messageService.add({severity:"error",summary:"Error",detail:"Delete failed"})})})}deleteSelected(){this.selectedItems?.length&&ce.default.fire({title:"Delete Selected",text:`Delete ${this.selectedItems.length} location(s)?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Delete"}).then(t=>{if(t.isConfirmed){let e=this.selectedItems.map(n=>n.locationId);Promise.all(e.map(n=>this.assetService.deleteLocation(n).toPromise())).then(()=>{this.items=this.items.filter(n=>!e.includes(n.locationId)),this.filteredItems=[...this.items],this.selectedItems=[],this.messageService.add({severity:"success",summary:"Deleted",detail:"Selected locations deleted"})}).catch(()=>this.messageService.add({severity:"error",summary:"Error",detail:"Bulk delete failed"}))}})}static \u0275fac=function(e){return new(e||a)(w(Ce),w(M),w(Me))};static \u0275cmp=I({type:a,selectors:[["app-location"]],features:[F([M]),ct],decls:10,vars:11,consts:[["start",""],["end",""],["styleClass","mb-4"],["dataKey","locationId","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} locations",3,"selectionChange","value","rows","paginator","rowsPerPageOptions","loading","rowHover","selection","showCurrentPageReport","tableStyle"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"flex","items-center","gap-2"],["label","New","icon","pi pi-plus","severity","secondary",3,"onClick"],["label","Delete Selected","icon","pi pi-trash","severity","secondary","outlined","",3,"onClick","disabled"],["label","Export","icon","pi pi-upload","severity","secondary",3,"onClick"],["styleClass","pi pi-search"],["pInputText","","type","text","placeholder","Search locations...",3,"ngModelChange","input","ngModel"],[2,"width","3rem"],[2,"min-width","25rem"],["pSortableColumn","locationName",2,"min-width","20rem"],["field","locationName"],[2,"min-width","12rem"],[3,"value"],[1,"flex","gap-2"],["icon","pi pi-eye","severity","info",3,"onClick","rounded","text"],["icon","pi pi-pencil","severity","secondary",3,"onClick","rounded","text"],["icon","pi pi-trash","severity","danger",3,"onClick","rounded","text"],["colspan","4",1,"text-center","py-5"]],template:function(e,n){if(e&1){let i=C();h(0,"p-toast"),r(1,"p-toolbar",2),b(2,Br,3,1,"ng-template",null,0,x)(4,Ar,5,1,"ng-template",null,1,x),o(),r(6,"p-table",3),S("selectionChange",function(g){return m(i),v(n.selectedItems,g)||(n.selectedItems=g),d(g)}),_("selectionChange",function(g){return m(i),d(n.onSelectionChange(g))}),b(7,Ur,10,0,"ng-template",4)(8,Fr,12,9,"ng-template",5)(9,jr,3,0,"ng-template",6),o()}e&2&&(c(6),u("value",n.filteredItems)("rows",10)("paginator",!0)("rowsPerPageOptions",E(9,bn))("loading",n.loading)("rowHover",!0),y("selection",n.selectedItems),u("showCurrentPageReport",!0)("tableStyle",E(10,Cn)))},dependencies:[P,z,$,N,V,R,U,q,H,ee,te,A,Q,se,B,O,W,j,G,X,J,Z,L,Y,D,k],styles:[xn]})};var pi=[{path:"brand",component:zt},{path:"color",component:Yt},{path:"program",component:Gt},{path:"supplier",component:Jt},{path:"location",component:Kt},{path:"status",component:Qt}];var Ke=Ee(Pe());var Wr=()=>[10,20,30];function $r(a,t){if(a&1){let e=C();r(0,"div",7)(1,"p-button",8),_("onClick",function(){m(e);let i=p();return d(i.openNew())}),o(),r(2,"p-button",9),_("onClick",function(){m(e);let i=p();return d(i.deleteSelected())}),o()()}if(a&2){let e=p();c(2),u("disabled",!e.selected.length)}}function qr(a,t){if(a&1){let e=C();r(0,"div",7)(1,"p-button",10),_("onClick",function(){m(e);let i=p();return d(i.exportCSV())}),o(),r(2,"p-iconfield"),h(3,"p-inputicon",11),r(4,"input",12),S("ngModelChange",function(i){m(e);let s=p();return v(s.searchValue,i)||(s.searchValue=i),d(i)}),_("input",function(){m(e);let i=p();return d(i.filter())}),o()()()}if(a&2){let e=p();c(4),y("ngModel",e.searchValue)}}function Hr(a,t){a&1&&(r(0,"tr")(1,"th",13),h(2,"p-tableHeaderCheckbox"),o(),r(3,"th"),l(4,"ID"),o(),r(5,"th",14),l(6,"Service Name "),h(7,"p-sortIcon",15),o(),r(8,"th"),l(9,"Description"),o(),r(10,"th",16),l(11,"Actions"),o()())}function zr(a,t){if(a&1){let e=C();r(0,"tr")(1,"td"),h(2,"p-tableCheckbox",17),o(),r(3,"td"),l(4),o(),r(5,"td"),l(6),o(),r(7,"td"),l(8),o(),r(9,"td")(10,"div",18)(11,"p-button",19),_("onClick",function(){let i=m(e).$implicit,s=p();return d(s.edit(i))}),o(),r(12,"p-button",20),_("onClick",function(){let i=m(e).$implicit,s=p();return d(s.delete(i))}),o()()()()}if(a&2){let e=t.$implicit;c(2),u("value",e),c(2),f(e.serviceMaintenanceId),c(2),f(e.serviceName),c(2),f(e.serviceDescription),c(3),u("rounded",!0)("text",!0),c(),u("rounded",!0)("text",!0)}}function Yr(a,t){a&1&&(r(0,"tr")(1,"td",21),l(2,"No services found"),o()())}var Xt=class a{constructor(t,e){this.maintenanceService=t;this.messageService=e}services=[];filtered=[];selected=[];loading=!1;searchValue="";ngOnInit(){this.load()}load(){this.loading=!0,this.maintenanceService.getServiceMaintenances().subscribe({next:t=>{this.services=t||[],this.filtered=[...this.services],this.loading=!1},error:t=>{console.error("Error loading service maintenances",t),this.loading=!1}})}filter(){let t=this.searchValue.toLowerCase();this.filtered=this.services.filter(e=>e.serviceName.toLowerCase().includes(t)||e.serviceDescription.toLowerCase().includes(t))}onSelectionChange(){}openNew(){Ke.default.fire({title:"New Service",html:`
              <input id="serviceName" class="swal2-input" placeholder="Service Name" />
              <textarea id="serviceDescription" class="swal2-textarea" placeholder="Description"></textarea>
            `,confirmButtonText:"Create",showCancelButton:!0,preConfirm:()=>{let t=document.getElementById("serviceName").value.trim(),e=document.getElementById("serviceDescription").value.trim();return t?{serviceName:t,serviceDescription:e}:(Ke.default.showValidationMessage("Service name is required"),!1)}}).then(t=>{t.isConfirmed&&t.value&&this.maintenanceService.createServiceMaintenance(t.value).subscribe({next:e=>{this.messageService.add({severity:"success",summary:"Created",detail:"Service created"}),this.services.push(e),this.filter()},error:()=>this.messageService.add({severity:"error",summary:"Error",detail:"Create failed"})})})}view(t){Ke.default.fire({title:"Service",html:`<b>${t.serviceName}</b><br/><em>${t.serviceDescription||"No description"}</em>`})}edit(t){Ke.default.fire({title:"Edit Service",html:`
              <input id="serviceName" class="swal2-input" value="${t.serviceName}" />
              <textarea id="serviceDescription" class="swal2-textarea">${t.serviceDescription||""}</textarea>
            `,confirmButtonText:"Update",showCancelButton:!0,preConfirm:()=>{let e=document.getElementById("serviceName").value.trim(),n=document.getElementById("serviceDescription").value.trim();return e?{serviceName:e,serviceDescription:n}:(Ke.default.showValidationMessage("Service name is required"),!1)}}).then(e=>{e.isConfirmed&&e.value&&this.maintenanceService.updateServiceMaintenance(t.serviceMaintenanceId,e.value).subscribe({next:n=>{let i=this.services.findIndex(s=>s.serviceMaintenanceId===n.serviceMaintenanceId);i>-1&&(this.services[i]=n),this.filter(),this.messageService.add({severity:"success",summary:"Updated",detail:"Service updated"})},error:()=>this.messageService.add({severity:"error",summary:"Error",detail:"Update failed"})})})}delete(t){Ke.default.fire({title:"Delete Service",text:`Delete "${t.serviceName}"?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Delete"}).then(e=>{e.isConfirmed&&this.maintenanceService.deleteServiceMaintenance(t.serviceMaintenanceId).subscribe({next:()=>{this.services=this.services.filter(n=>n.serviceMaintenanceId!==t.serviceMaintenanceId),this.filter(),this.messageService.add({severity:"success",summary:"Deleted",detail:"Service deleted"})},error:()=>this.messageService.add({severity:"error",summary:"Error",detail:"Delete failed"})})})}deleteSelected(){this.selected.length&&Ke.default.fire({title:"Delete Selected",text:`Delete ${this.selected.length} service(s)?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Delete"}).then(t=>{if(t.isConfirmed){let e=this.selected.map(n=>n.serviceMaintenanceId);Promise.all(e.map(n=>this.maintenanceService.deleteServiceMaintenance(n).toPromise())).then(()=>{this.services=this.services.filter(n=>!e.includes(n.serviceMaintenanceId)),this.selected=[],this.filter(),this.messageService.add({severity:"success",summary:"Deleted",detail:"Selected services deleted"})}).catch(()=>this.messageService.add({severity:"error",summary:"Error",detail:"Bulk delete failed"}))}})}exportCSV(){let t=`Service Name,Description,ID
`;this.services.forEach(s=>t+=`${s.serviceName.replace(/,/g,";")},${(s.serviceDescription||"").replace(/,/g,";")},${s.serviceMaintenanceId}
`);let e=new Blob([t],{type:"text/csv"}),n=URL.createObjectURL(e),i=document.createElement("a");i.href=n,i.download="maintenance-services.csv",i.click(),URL.revokeObjectURL(n)}static \u0275fac=function(e){return new(e||a)(w(We),w(M))};static \u0275cmp=I({type:a,selectors:[["app-maintenance-services"]],features:[F([M])],decls:10,vars:9,consts:[["start",""],["end",""],["styleClass","mb-4"],["dataKey","serviceMaintenanceId","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} services",3,"selectionChange","value","rows","paginator","rowsPerPageOptions","loading","rowHover","selection","showCurrentPageReport"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"flex","items-center","gap-2"],["label","New","icon","pi pi-plus","severity","secondary",3,"onClick"],["label","Delete Selected","icon","pi pi-trash","severity","secondary","outlined","",3,"onClick","disabled"],["label","Export","icon","pi pi-upload","severity","secondary",3,"onClick"],["styleClass","pi pi-search"],["pInputText","","type","text","placeholder","Search services...",3,"ngModelChange","input","ngModel"],[2,"width","3rem"],["pSortableColumn","serviceName"],["field","serviceName"],[2,"width","6rem"],[3,"value"],[1,"flex","gap-2"],["icon","pi pi-pencil","severity","secondary",3,"onClick","rounded","text"],["icon","pi pi-trash","severity","danger",3,"onClick","rounded","text"],["colspan","5",1,"text-center","py-5"]],template:function(e,n){if(e&1){let i=C();h(0,"p-toast"),r(1,"p-toolbar",2),b(2,$r,3,1,"ng-template",null,0,x)(4,qr,5,1,"ng-template",null,1,x),o(),r(6,"p-table",3),S("selectionChange",function(g){return m(i),v(n.selected,g)||(n.selected=g),d(g)}),_("selectionChange",function(){return m(i),d(n.onSelectionChange())}),b(7,Hr,12,0,"ng-template",4)(8,zr,13,8,"ng-template",5)(9,Yr,3,0,"ng-template",6),o()}e&2&&(c(6),u("value",n.filtered)("rows",10)("paginator",!0)("rowsPerPageOptions",E(8,Wr))("loading",n.loading)("rowHover",!0),y("selection",n.selected),u("showCurrentPageReport",!0))},dependencies:[P,R,U,$,q,H,ee,te,B,O,N,V,A,Q,G,X,J,Z,L,Y,D,k,W,j],encapsulation:2})};var Xe=Ee(Pe());var Qr=()=>[10,20,30],Gr=()=>({"min-width":"70rem"});function Jr(a,t){if(a&1){let e=C();r(0,"div",7)(1,"p-button",8),_("onClick",function(){m(e);let i=p();return d(i.openNew())}),o(),r(2,"p-button",9),_("onClick",function(){m(e);let i=p();return d(i.deleteSelected())}),o()()}if(a&2){let e=p();c(2),u("disabled",!e.selected.length)}}function Kr(a,t){if(a&1){let e=C();r(0,"div",7)(1,"p-button",10),_("onClick",function(){m(e);let i=p();return d(i.exportCSV())}),o(),r(2,"p-iconfield"),h(3,"p-inputicon",11),r(4,"input",12),S("ngModelChange",function(i){m(e);let s=p();return v(s.searchValue,i)||(s.searchValue=i),d(i)}),_("input",function(){m(e);let i=p();return d(i.filter())}),o()()()}if(a&2){let e=p();c(4),y("ngModel",e.searchValue)}}function Xr(a,t){a&1&&(r(0,"tr")(1,"th",13),h(2,"p-tableHeaderCheckbox"),o(),r(3,"th",14),l(4,"ID"),o(),r(5,"th",15),l(6,"Status Name "),h(7,"p-sortIcon",16),o(),r(8,"th",17),l(9,"Actions"),o()())}function Zr(a,t){if(a&1){let e=C();r(0,"tr")(1,"td"),h(2,"p-tableCheckbox",18),o(),r(3,"td"),l(4),o(),r(5,"td"),l(6),o(),r(7,"td")(8,"div",19)(9,"p-button",20),_("onClick",function(){let i=m(e).$implicit,s=p();return d(s.edit(i))}),o(),r(10,"p-button",21),_("onClick",function(){let i=m(e).$implicit,s=p();return d(s.delete(i))}),o()()()()}if(a&2){let e=t.$implicit;c(2),u("value",e),c(2),f(e.requestStatusId),c(2),f(e.requestStatusName),c(3),u("rounded",!0)("text",!0),c(),u("rounded",!0)("text",!0)}}function eo(a,t){a&1&&(r(0,"tr")(1,"td",22),l(2,"No statuses found"),o()())}var en=class a{constructor(t,e){this.maintenanceService=t;this.messageService=e}statuses=[];filtered=[];selected=[];loading=!1;searchValue="";ngOnInit(){this.load()}load(){this.loading=!0,this.maintenanceService.getRequestStatuses().subscribe({next:t=>{this.statuses=t||[],this.filtered=[...this.statuses],this.loading=!1},error:t=>{console.error("Error loading request statuses",t),this.loading=!1}})}filter(){let t=this.searchValue.toLowerCase();this.filtered=this.statuses.filter(e=>e.requestStatusName.toLowerCase().includes(t))}onSelectionChange(){}openNew(){Xe.default.fire({title:"New Status",html:'<input id="statusName" class="swal2-input" placeholder="Status Name" />',confirmButtonText:"Create",showCancelButton:!0,preConfirm:()=>{let t=document.getElementById("statusName").value.trim();return t?{requestStatusName:t}:(Xe.default.showValidationMessage("Status name is required"),!1)}}).then(t=>{t.isConfirmed&&t.value&&this.maintenanceService.createRequestStatus(t.value).subscribe({next:e=>{this.statuses.push(e),this.filter(),this.messageService.add({severity:"success",summary:"Created",detail:"Status created"})},error:()=>this.messageService.add({severity:"error",summary:"Error",detail:"Create failed"})})})}view(t){Xe.default.fire({title:"Status",text:t.requestStatusName})}edit(t){Xe.default.fire({title:"Edit Status",html:`<input id="statusName" class="swal2-input" value="${t.requestStatusName}" />`,confirmButtonText:"Update",showCancelButton:!0,preConfirm:()=>{let e=document.getElementById("statusName").value.trim();return e?{requestStatusName:e}:(Xe.default.showValidationMessage("Status name is required"),!1)}}).then(e=>{e.isConfirmed&&e.value&&this.maintenanceService.updateRequestStatus(t.requestStatusId,e.value).subscribe({next:n=>{let i=this.statuses.findIndex(s=>s.requestStatusId===n.requestStatusId);i>-1&&(this.statuses[i]=n),this.filter(),this.messageService.add({severity:"success",summary:"Updated",detail:"Status updated"})},error:()=>this.messageService.add({severity:"error",summary:"Error",detail:"Update failed"})})})}delete(t){Xe.default.fire({title:"Delete Status",text:`Delete "${t.requestStatusName}"?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Delete"}).then(e=>{e.isConfirmed&&this.maintenanceService.deleteRequestStatus(t.requestStatusId).subscribe({next:()=>{this.statuses=this.statuses.filter(n=>n.requestStatusId!==t.requestStatusId),this.filter(),this.messageService.add({severity:"success",summary:"Deleted",detail:"Status deleted"})},error:()=>this.messageService.add({severity:"error",summary:"Error",detail:"Delete failed"})})})}deleteSelected(){this.selected.length&&Xe.default.fire({title:"Delete Selected",text:`Delete ${this.selected.length} status(es)?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Delete"}).then(t=>{if(t.isConfirmed){let e=this.selected.map(n=>n.requestStatusId);Promise.all(e.map(n=>this.maintenanceService.deleteRequestStatus(n).toPromise())).then(()=>{this.statuses=this.statuses.filter(n=>!e.includes(n.requestStatusId)),this.selected=[],this.filter(),this.messageService.add({severity:"success",summary:"Deleted",detail:"Selected statuses deleted"})}).catch(()=>this.messageService.add({severity:"error",summary:"Error",detail:"Bulk delete failed"}))}})}exportCSV(){let t=`Status Name,ID
`;this.statuses.forEach(s=>t+=`${s.requestStatusName.replace(/,/g,";")},${s.requestStatusId}
`);let e=new Blob([t],{type:"text/csv"}),n=URL.createObjectURL(e),i=document.createElement("a");i.href=n,i.download="maintenance-status.csv",i.click(),URL.revokeObjectURL(n)}static \u0275fac=function(e){return new(e||a)(w(We),w(M))};static \u0275cmp=I({type:a,selectors:[["app-maintenance-status"]],features:[F([M])],decls:10,vars:11,consts:[["start",""],["end",""],["styleClass","mb-4"],["dataKey","requestStatusId","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} statuses",3,"selectionChange","value","rows","paginator","rowsPerPageOptions","loading","rowHover","selection","showCurrentPageReport","tableStyle"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"flex","items-center","gap-2"],["label","New","icon","pi pi-plus","severity","secondary",3,"onClick"],["label","Delete Selected","icon","pi pi-trash","severity","secondary","outlined","",3,"onClick","disabled"],["label","Export","icon","pi pi-upload","severity","secondary",3,"onClick"],["styleClass","pi pi-search"],["pInputText","","type","text","placeholder","Search status...",3,"ngModelChange","input","ngModel"],[2,"width","3rem"],[2,"min-width","25rem"],["pSortableColumn","requestStatusName",2,"min-width","20rem"],["field","requestStatusName"],[2,"min-width","12rem"],[3,"value"],[1,"flex","gap-2"],["icon","pi pi-pencil","severity","secondary",3,"onClick","rounded","text"],["icon","pi pi-trash","severity","danger",3,"onClick","rounded","text"],["colspan","4",1,"text-center","py-5"]],template:function(e,n){if(e&1){let i=C();h(0,"p-toast"),r(1,"p-toolbar",2),b(2,Jr,3,1,"ng-template",null,0,x)(4,Kr,5,1,"ng-template",null,1,x),o(),r(6,"p-table",3),S("selectionChange",function(g){return m(i),v(n.selected,g)||(n.selected=g),d(g)}),_("selectionChange",function(){return m(i),d(n.onSelectionChange())}),b(7,Xr,10,0,"ng-template",4)(8,Zr,11,7,"ng-template",5)(9,eo,3,0,"ng-template",6),o()}e&2&&(c(6),u("value",n.filtered)("rows",10)("paginator",!0)("rowsPerPageOptions",E(9,Qr))("loading",n.loading)("rowHover",!0),y("selection",n.selected),u("showCurrentPageReport",!0)("tableStyle",E(10,Gr)))},dependencies:[P,R,U,$,q,H,ee,te,B,O,A,Q,G,X,J,Z,L,Y,D,k,N,V,W,j],encapsulation:2})};var Ze=Ee(Pe());var to=()=>[10,20,30],no=()=>({"min-width":"70rem"});function io(a,t){if(a&1){let e=C();r(0,"div",7)(1,"p-button",8),_("onClick",function(){m(e);let i=p();return d(i.openNew())}),o(),r(2,"p-button",9),_("onClick",function(){m(e);let i=p();return d(i.deleteSelected())}),o()()}if(a&2){let e=p();c(2),u("disabled",!e.selected.length)}}function ro(a,t){if(a&1){let e=C();r(0,"div",7)(1,"p-button",10),_("onClick",function(){m(e);let i=p();return d(i.exportCSV())}),o(),r(2,"p-iconfield"),h(3,"p-inputicon",11),r(4,"input",12),S("ngModelChange",function(i){m(e);let s=p();return v(s.searchValue,i)||(s.searchValue=i),d(i)}),_("input",function(){m(e);let i=p();return d(i.filter())}),o()()()}if(a&2){let e=p();c(4),y("ngModel",e.searchValue)}}function oo(a,t){a&1&&(r(0,"tr")(1,"th",13),h(2,"p-tableHeaderCheckbox"),o(),r(3,"th",14),l(4,"ID"),o(),r(5,"th",15),l(6,"Priority Level "),h(7,"p-sortIcon",16),o(),r(8,"th",17),l(9,"Actions"),o()())}function ao(a,t){if(a&1){let e=C();r(0,"tr")(1,"td"),h(2,"p-tableCheckbox",18),o(),r(3,"td"),l(4),o(),r(5,"td"),l(6),o(),r(7,"td")(8,"div",19)(9,"p-button",20),_("onClick",function(){let i=m(e).$implicit,s=p();return d(s.edit(i))}),o(),r(10,"p-button",21),_("onClick",function(){let i=m(e).$implicit,s=p();return d(s.delete(i))}),o()()()()}if(a&2){let e=t.$implicit;c(2),u("value",e),c(2),f(e.priorityLevelId),c(2),f(e.priorityLevelName),c(3),u("rounded",!0)("text",!0),c(),u("rounded",!0)("text",!0)}}function lo(a,t){a&1&&(r(0,"tr")(1,"td",22),l(2,"No priority levels found"),o()())}var tn=class a{constructor(t,e){this.maintenanceService=t;this.messageService=e}priorityLevels=[];filtered=[];selected=[];loading=!1;searchValue="";ngOnInit(){this.load()}load(){this.loading=!0,this.maintenanceService.getPriorityLevels().subscribe({next:t=>{this.priorityLevels=t||[],this.filtered=[...this.priorityLevels],this.loading=!1},error:t=>{console.error("Error loading priority levels",t),this.loading=!1}})}filter(){let t=this.searchValue.toLowerCase();this.filtered=this.priorityLevels.filter(e=>e.priorityLevelName.toLowerCase().includes(t))}onSelectionChange(){}openNew(){Ze.default.fire({title:"New Priority Level",html:'<input id="plName" class="swal2-input" placeholder="Priority Level" />',confirmButtonText:"Create",showCancelButton:!0,preConfirm:()=>{let t=document.getElementById("plName").value.trim();return t?{priorityLevelName:t}:(Ze.default.showValidationMessage("Priority level name is required"),!1)}}).then(t=>{t.isConfirmed&&t.value&&this.maintenanceService.createPriorityLevel(t.value).subscribe({next:e=>{this.priorityLevels.push(e),this.filter(),this.messageService.add({severity:"success",summary:"Created",detail:"Priority level created"})},error:()=>this.messageService.add({severity:"error",summary:"Error",detail:"Create failed"})})})}view(t){Ze.default.fire({title:"Priority Level",text:t.priorityLevelName})}edit(t){Ze.default.fire({title:"Edit Priority Level",html:`<input id="plName" class="swal2-input" value="${t.priorityLevelName}" />`,confirmButtonText:"Update",showCancelButton:!0,preConfirm:()=>{let e=document.getElementById("plName").value.trim();return e?{priorityLevelName:e}:(Ze.default.showValidationMessage("Priority level name is required"),!1)}}).then(e=>{e.isConfirmed&&e.value&&this.maintenanceService.updatePriorityLevel(t.priorityLevelId,e.value).subscribe({next:n=>{let i=this.priorityLevels.findIndex(s=>s.priorityLevelId===n.priorityLevelId);i>-1&&(this.priorityLevels[i]=n),this.filter(),this.messageService.add({severity:"success",summary:"Updated",detail:"Priority level updated"})},error:()=>this.messageService.add({severity:"error",summary:"Error",detail:"Update failed"})})})}delete(t){Ze.default.fire({title:"Delete Priority Level",text:`Delete "${t.priorityLevelName}"?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Delete"}).then(e=>{e.isConfirmed&&this.maintenanceService.deletePriorityLevel(t.priorityLevelId).subscribe({next:()=>{this.priorityLevels=this.priorityLevels.filter(n=>n.priorityLevelId!==t.priorityLevelId),this.filter(),this.messageService.add({severity:"success",summary:"Deleted",detail:"Priority level deleted"})},error:()=>this.messageService.add({severity:"error",summary:"Error",detail:"Delete failed"})})})}deleteSelected(){this.selected.length&&Ze.default.fire({title:"Delete Selected",text:`Delete ${this.selected.length} level(s)?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Delete"}).then(t=>{if(t.isConfirmed){let e=this.selected.map(n=>n.priorityLevelId);Promise.all(e.map(n=>this.maintenanceService.deletePriorityLevel(n).toPromise())).then(()=>{this.priorityLevels=this.priorityLevels.filter(n=>!e.includes(n.priorityLevelId)),this.selected=[],this.filter(),this.messageService.add({severity:"success",summary:"Deleted",detail:"Selected priority levels deleted"})}).catch(()=>this.messageService.add({severity:"error",summary:"Error",detail:"Bulk delete failed"}))}})}exportCSV(){let t=`Priority Level,ID
`;this.priorityLevels.forEach(s=>t+=`${s.priorityLevelName.replace(/,/g,";")},${s.priorityLevelId}
`);let e=new Blob([t],{type:"text/csv"}),n=URL.createObjectURL(e),i=document.createElement("a");i.href=n,i.download="priority-levels.csv",i.click(),URL.revokeObjectURL(n)}static \u0275fac=function(e){return new(e||a)(w(We),w(M))};static \u0275cmp=I({type:a,selectors:[["app-maintenance-priority-level"]],features:[F([M])],decls:10,vars:11,consts:[["start",""],["end",""],["styleClass","mb-4"],["dataKey","priorityLevelId","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} levels",3,"selectionChange","value","rows","paginator","rowsPerPageOptions","loading","rowHover","selection","showCurrentPageReport","tableStyle"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"flex","items-center","gap-2"],["label","New","icon","pi pi-plus","severity","secondary",3,"onClick"],["label","Delete Selected","icon","pi pi-trash","severity","secondary","outlined","",3,"onClick","disabled"],["label","Export","icon","pi pi-upload","severity","secondary",3,"onClick"],["styleClass","pi pi-search"],["pInputText","","type","text","placeholder","Search levels...",3,"ngModelChange","input","ngModel"],[2,"width","3rem"],[2,"min-width","25rem"],["pSortableColumn","priorityLevelName",2,"min-width","20rem"],["field","priorityLevelName"],[2,"min-width","12rem"],[3,"value"],[1,"flex","gap-2"],["icon","pi pi-pencil","severity","secondary",3,"onClick","rounded","text"],["icon","pi pi-trash","severity","danger",3,"onClick","rounded","text"],["colspan","4",1,"text-center","py-5"]],template:function(e,n){if(e&1){let i=C();h(0,"p-toast"),r(1,"p-toolbar",2),b(2,io,3,1,"ng-template",null,0,x)(4,ro,5,1,"ng-template",null,1,x),o(),r(6,"p-table",3),S("selectionChange",function(g){return m(i),v(n.selected,g)||(n.selected=g),d(g)}),_("selectionChange",function(){return m(i),d(n.onSelectionChange())}),b(7,oo,10,0,"ng-template",4)(8,ao,11,7,"ng-template",5)(9,lo,3,0,"ng-template",6),o()}e&2&&(c(6),u("value",n.filtered)("rows",10)("paginator",!0)("rowsPerPageOptions",E(9,to))("loading",n.loading)("rowHover",!0),y("selection",n.selected),u("showCurrentPageReport",!0)("tableStyle",E(10,no)))},dependencies:[P,R,U,$,q,H,ee,te,B,O,A,Q,G,X,J,Z,L,Y,D,k,N,V,W,j],encapsulation:2})};var et=Ee(Pe());var so=()=>[10,20,30],co=()=>({"min-width":"70rem"});function po(a,t){if(a&1){let e=C();r(0,"div",7)(1,"p-button",8),_("onClick",function(){m(e);let i=p();return d(i.openNew())}),o(),r(2,"p-button",9),_("onClick",function(){m(e);let i=p();return d(i.deleteSelected())}),o()()}if(a&2){let e=p();c(2),u("disabled",!e.selected.length)}}function mo(a,t){if(a&1){let e=C();r(0,"div",7)(1,"p-button",10),_("onClick",function(){m(e);let i=p();return d(i.exportCSV())}),o(),r(2,"p-iconfield"),h(3,"p-inputicon",11),r(4,"input",12),S("ngModelChange",function(i){m(e);let s=p();return v(s.searchValue,i)||(s.searchValue=i),d(i)}),_("input",function(){m(e);let i=p();return d(i.filter())}),o()()()}if(a&2){let e=p();c(4),y("ngModel",e.searchValue)}}function uo(a,t){a&1&&(r(0,"tr")(1,"th",13),h(2,"p-tableHeaderCheckbox"),o(),r(3,"th",14),l(4,"ID"),o(),r(5,"th",15),l(6,"Type Name "),h(7,"p-sortIcon",16),o()())}function go(a,t){if(a&1&&(r(0,"tr")(1,"td"),h(2,"p-tableCheckbox",17),o(),r(3,"td"),l(4),o(),r(5,"td"),l(6),o()()),a&2){let e=t.$implicit;c(2),u("value",e),c(2),f(e.maintenanceTypeId),c(2),f(e.maintenanceTypeName)}}function _o(a,t){a&1&&(r(0,"tr")(1,"td",18),l(2,"No maintenance types found"),o()())}var nn=class a{constructor(t,e){this.maintenanceService=t;this.messageService=e}types=[];filtered=[];selected=[];loading=!1;searchValue="";ngOnInit(){this.load()}load(){this.loading=!0,this.maintenanceService.getMaintenanceTypes().subscribe({next:t=>{this.types=t||[],this.filtered=[...this.types],this.loading=!1},error:t=>{console.error("Error loading maintenance types",t),this.loading=!1}})}filter(){let t=this.searchValue.toLowerCase();this.filtered=this.types.filter(e=>e.maintenanceTypeName.toLowerCase().includes(t))}onSelectionChange(){}openNew(){et.default.fire({title:"New Maintenance Type",html:'<input id="mtName" class="swal2-input" placeholder="Type Name" />',confirmButtonText:"Create",showCancelButton:!0,preConfirm:()=>{let t=document.getElementById("mtName").value.trim();return t?{maintenanceTypeName:t}:(et.default.showValidationMessage("Type name is required"),!1)}}).then(t=>{t.isConfirmed&&t.value&&this.maintenanceService.createMaintenanceType(t.value).subscribe({next:e=>{this.types.push(e),this.filter(),this.messageService.add({severity:"success",summary:"Created",detail:"Type created"})},error:()=>this.messageService.add({severity:"error",summary:"Error",detail:"Create failed"})})})}view(t){et.default.fire({title:"Maintenance Type",text:t.maintenanceTypeName})}edit(t){et.default.fire({title:"Edit Maintenance Type",html:`<input id="mtName" class="swal2-input" value="${t.maintenanceTypeName}" />`,confirmButtonText:"Update",showCancelButton:!0,preConfirm:()=>{let e=document.getElementById("mtName").value.trim();return e?{maintenanceTypeName:e}:(et.default.showValidationMessage("Type name is required"),!1)}}).then(e=>{e.isConfirmed&&e.value&&this.maintenanceService.updateMaintenanceType(t.maintenanceTypeId,e.value).subscribe({next:n=>{let i=this.types.findIndex(s=>s.maintenanceTypeId===n.maintenanceTypeId);i>-1&&(this.types[i]=n),this.filter(),this.messageService.add({severity:"success",summary:"Updated",detail:"Type updated"})},error:()=>this.messageService.add({severity:"error",summary:"Error",detail:"Update failed"})})})}delete(t){et.default.fire({title:"Delete Maintenance Type",text:`Delete "${t.maintenanceTypeName}"?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Delete"}).then(e=>{e.isConfirmed&&this.maintenanceService.deleteMaintenanceType(t.maintenanceTypeId).subscribe({next:()=>{this.types=this.types.filter(n=>n.maintenanceTypeId!==t.maintenanceTypeId),this.filter(),this.messageService.add({severity:"success",summary:"Deleted",detail:"Type deleted"})},error:()=>this.messageService.add({severity:"error",summary:"Error",detail:"Delete failed"})})})}deleteSelected(){this.selected.length&&et.default.fire({title:"Delete Selected",text:`Delete ${this.selected.length} type(s)?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Delete"}).then(t=>{if(t.isConfirmed){let e=this.selected.map(n=>n.maintenanceTypeId);Promise.all(e.map(n=>this.maintenanceService.deleteMaintenanceType(n).toPromise())).then(()=>{this.types=this.types.filter(n=>!e.includes(n.maintenanceTypeId)),this.selected=[],this.filter(),this.messageService.add({severity:"success",summary:"Deleted",detail:"Selected types deleted"})}).catch(()=>this.messageService.add({severity:"error",summary:"Error",detail:"Bulk delete failed"}))}})}exportCSV(){let t=`Type Name,ID
`;this.types.forEach(s=>t+=`${s.maintenanceTypeName.replace(/,/g,";")},${s.maintenanceTypeId}
`);let e=new Blob([t],{type:"text/csv"}),n=URL.createObjectURL(e),i=document.createElement("a");i.href=n,i.download="maintenance-types.csv",i.click(),URL.revokeObjectURL(n)}static \u0275fac=function(e){return new(e||a)(w(We),w(M))};static \u0275cmp=I({type:a,selectors:[["app-maintenance-types"]],features:[F([M])],decls:10,vars:11,consts:[["start",""],["end",""],["styleClass","mb-4"],["dataKey","maintenanceTypeId","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} types",3,"selectionChange","value","rows","paginator","rowsPerPageOptions","loading","rowHover","selection","showCurrentPageReport","tableStyle"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"flex","items-center","gap-2"],["label","New","icon","pi pi-plus","severity","secondary",3,"onClick"],["label","Delete Selected","icon","pi pi-trash","severity","secondary","outlined","",3,"onClick","disabled"],["label","Export","icon","pi pi-upload","severity","secondary",3,"onClick"],["styleClass","pi pi-search"],["pInputText","","type","text","placeholder","Search types...",3,"ngModelChange","input","ngModel"],[2,"width","3rem"],[2,"min-width","25rem"],["pSortableColumn","maintenanceTypeName",2,"min-width","20rem"],["field","maintenanceTypeName"],[3,"value"],["colspan","3",1,"text-center","py-5"]],template:function(e,n){if(e&1){let i=C();h(0,"p-toast"),r(1,"p-toolbar",2),b(2,po,3,1,"ng-template",null,0,x)(4,mo,5,1,"ng-template",null,1,x),o(),r(6,"p-table",3),S("selectionChange",function(g){return m(i),v(n.selected,g)||(n.selected=g),d(g)}),_("selectionChange",function(){return m(i),d(n.onSelectionChange())}),b(7,uo,8,0,"ng-template",4)(8,go,7,3,"ng-template",5)(9,_o,3,0,"ng-template",6),o()}e&2&&(c(6),u("value",n.filtered)("rows",10)("paginator",!0)("rowsPerPageOptions",E(9,so))("loading",n.loading)("rowHover",!0),y("selection",n.selected),u("showCurrentPageReport",!0)("tableStyle",E(10,co)))},dependencies:[P,R,U,$,q,H,ee,te,B,O,A,Q,G,X,J,Z,L,Y,D,k,N,V,W,j],encapsulation:2})};var rn=Ee(Pe());var ho=["dt"],mi=()=>({width:"500px"}),bo=()=>({width:"50vw"}),Co=()=>({"960px":"75vw","640px":"90vw"}),xo=()=>({width:"450px"});function yo(a,t){if(a&1){let e=C();r(0,"p-button",22),_("onClick",function(){m(e);let i=p(2);return d(i.openNew())}),o()}}function vo(a,t){if(a&1&&(r(0,"div",19),b(1,yo,1,0,"p-button",20),h(2,"p-button",21),o()),a&2){let e=p();c(),u("ngIf",!e.isCampusAdmin&&!e.isSuperAdmin)}}function So(a,t){if(a&1){let e=C();r(0,"div",19)(1,"label",25),l(2,"Campus:"),o(),r(3,"p-select",27),S("ngModelChange",function(i){m(e);let s=p(2);return v(s.selectedCampus,i)||(s.selectedCampus=i),d(i)}),_("onChange",function(){m(e);let i=p(2);return d(i.onCampusFilterChange())}),o()()}if(a&2){let e=p(2);c(3),y("ngModel",e.selectedCampus),u("options",e.campuses)("showClear",!0)}}function wo(a,t){if(a&1){let e=C();r(0,"div",23),b(1,So,4,3,"div",24),r(2,"div",19)(3,"label",25),l(4,"Laboratory:"),o(),r(5,"p-select",26),S("ngModelChange",function(i){m(e);let s=p();return v(s.selectedLaboratory,i)||(s.selectedLaboratory=i),d(i)}),_("onChange",function(){m(e);let i=p();return d(i.onLaboratoryFilterChange())}),o()()()}if(a&2){let e=p();c(),u("ngIf",e.isSuperAdmin),c(4),y("ngModel",e.selectedLaboratory),u("options",e.filteredLaboratories)("showClear",!0)}}function Mo(a,t){a&1&&(r(0,"div",28),h(1,"i",29),r(2,"h3",30),l(3,"No Campus and Laboratory Selected"),o(),r(4,"p",31),l(5,"Please select a campus and laboratory to view the schedule."),o()())}function Eo(a,t){a&1&&(r(0,"div",28),h(1,"i",29),r(2,"h3",30),l(3,"No Laboratory Selected"),o(),r(4,"p",31),l(5,"Please select a laboratory to view the schedule."),o()())}function To(a,t){if(a&1){let e=C();r(0,"div",41),_("click",function(){let i=m(e).$implicit,s=p(4);return d(s.viewSchedule(i))}),r(1,"div",42),l(2),o(),r(3,"div",43),l(4),o(),r(5,"div",44),l(6),o()()}if(a&2){let e=t.$implicit,n=p(4);Rt("grid-row","span "+n.getRowSpan(e))("min-height",n.getRowSpan(e)*60,"px"),u("ngClass","schedule-block "+n.getScheduleColor(e)),c(2),f(e.subject==null?null:e.subject.subjectCode),c(2),ke("",e.faculty==null?null:e.faculty.firstName," ",e.faculty==null?null:e.faculty.lastName),c(2),ke("",e.startTime," - ",e.endTime)}}function Io(a,t){if(a&1&&(r(0,"td",39),b(1,To,7,10,"div",40),o()),a&2){let e=t.$implicit,n=p().index,i=p(2);c(),u("ngForOf",i.getSchedulesStartingAtSlot(n,e))}}function Po(a,t){if(a&1&&(r(0,"tr")(1,"td",37),l(2),o(),b(3,Io,2,1,"td",38),o()),a&2){let e=t.$implicit,n=p(2);c(2),f(e),c(),u("ngForOf",n.daysOfWeek)}}function No(a,t){if(a&1&&(r(0,"div",32)(1,"div",33)(2,"table",34)(3,"thead")(4,"tr")(5,"th",35),l(6,"Time & Days"),o(),r(7,"th"),l(8,"Sunday"),o(),r(9,"th"),l(10,"Monday"),o(),r(11,"th"),l(12,"Tuesday"),o(),r(13,"th"),l(14,"Wednesday"),o(),r(15,"th"),l(16,"Thursday"),o(),r(17,"th"),l(18,"Friday"),o(),r(19,"th"),l(20,"Saturday"),o()()(),r(21,"tbody"),b(22,Po,4,2,"tr",36),o()()()()),a&2){let e=p();c(22),u("ngForOf",e.timeSlots)}}function Do(a,t){if(a&1){let e=C();r(0,"div",45)(1,"div",10)(2,"label",11),l(3,"Laboratory *"),o(),r(4,"p-select",46),S("ngModelChange",function(i){m(e);let s=p();return v(s.newSchedule.laboratory,i)||(s.newSchedule.laboratory=i),d(i)}),o()(),r(5,"div",10)(6,"label",11),l(7,"Instructor"),o(),r(8,"p-select",47),S("ngModelChange",function(i){m(e);let s=p();return v(s.newSchedule.instructor,i)||(s.newSchedule.instructor=i),d(i)}),o()(),r(9,"div",13)(10,"label",11),l(11,"Day *"),o(),r(12,"p-select",48),S("ngModelChange",function(i){m(e);let s=p();return v(s.newSchedule.day,i)||(s.newSchedule.day=i),d(i)}),o()(),r(13,"div",13)(14,"label",11),l(15,"Subject *"),o(),r(16,"div",49)(17,"p-select",50),S("ngModelChange",function(i){m(e);let s=p();return v(s.newSchedule.activity,i)||(s.newSchedule.activity=i),d(i)}),o(),r(18,"p-button",51),_("click",function(){m(e);let i=p();return d(i.openCreateSubjectDialog())}),o()()(),r(19,"div",13)(20,"label",11),l(21,"Time *"),o(),r(22,"input",52),S("ngModelChange",function(i){m(e);let s=p();return v(s.newSchedule.time,i)||(s.newSchedule.time=i),d(i)}),o()(),r(23,"div",13)(24,"label",11),l(25,"End Time *"),o(),r(26,"input",52),S("ngModelChange",function(i){m(e);let s=p();return v(s.newSchedule.endTime,i)||(s.newSchedule.endTime=i),d(i)}),o()()()}if(a&2){let e=p();c(4),y("ngModel",e.newSchedule.laboratory),u("options",e.laboratories),c(4),y("ngModel",e.newSchedule.instructor),u("options",e.users)("showClear",!0),c(4),y("ngModel",e.newSchedule.day),u("options",e.daysOfWeek),c(5),y("ngModel",e.newSchedule.activity),u("options",e.subjects),c(5),y("ngModel",e.newSchedule.time),c(4),y("ngModel",e.newSchedule.endTime)}}function ko(a,t){if(a&1){let e=C();r(0,"div",53)(1,"p-button",54),_("click",function(){m(e);let i=p();return d(i.closeDialog())}),o(),r(2,"p-button",55),_("click",function(){m(e);let i=p();return d(i.saveSchedule())}),o()()}}function Lo(a,t){if(a&1){let e=C();r(0,"div",53)(1,"p-button",54),_("click",function(){m(e);let i=p();return d(i.closeSubjectDialog())}),o(),r(2,"p-button",56),_("click",function(){m(e);let i=p();return d(i.saveSubject())}),o()()}}function Vo(a,t){if(a&1&&(r(0,"div",58)(1,"div",59),h(2,"i",60),r(3,"div")(4,"div",61),l(5),o(),r(6,"div",62),l(7),o()()(),r(8,"div",63),h(9,"i",64),r(10,"span"),l(11),o()(),r(12,"div",63),h(13,"i",65),r(14,"span"),l(15),o()(),r(16,"div",63),h(17,"i",66),r(18,"span"),l(19),o()(),r(20,"div",63),h(21,"i",67),r(22,"span"),l(23),o()()()),a&2){let e=p(2);c(5),f(e.selectedSchedule.subject==null?null:e.selectedSchedule.subject.subjectCode),c(2),f(e.selectedSchedule.subject==null?null:e.selectedSchedule.subject.subjectName),c(4),ke("",e.selectedSchedule.faculty==null?null:e.selectedSchedule.faculty.firstName," ",e.selectedSchedule.faculty==null?null:e.selectedSchedule.faculty.lastName),c(4),f(e.selectedSchedule.dayOfWeek),c(4),ke("",e.selectedSchedule.startTime," - ",e.selectedSchedule.endTime),c(4),f((e.selectedLaboratory==null?null:e.selectedLaboratory.laboratoryName)||"N/A")}}function Ro(a,t){if(a&1&&b(0,Vo,24,8,"div",57),a&2){let e=p();u("ngIf",e.selectedSchedule)}}function Oo(a,t){if(a&1){let e=C();r(0,"div",68)(1,"p-button",69),_("click",function(){m(e);let i=p();return d(i.openEditScheduleDialog())}),o(),r(2,"div",49)(3,"p-button",70),_("click",function(){m(e);let i=p();return d(i.closeScheduleDetailsDialog())}),o(),r(4,"p-button",71),_("click",function(){m(e);let i=p();return d(i.confirmDeleteSchedule())}),o()()()}}function Bo(a,t){if(a&1){let e=C();r(0,"div",45)(1,"div",10)(2,"label",11),l(3,"Instructor"),o(),r(4,"p-select",47),S("ngModelChange",function(i){m(e);let s=p(2);return v(s.editingSchedule.instructor,i)||(s.editingSchedule.instructor=i),d(i)}),o()(),r(5,"div",13)(6,"label",11),l(7,"Day *"),o(),r(8,"p-select",48),S("ngModelChange",function(i){m(e);let s=p(2);return v(s.editingSchedule.day,i)||(s.editingSchedule.day=i),d(i)}),o()(),r(9,"div",13)(10,"label",11),l(11,"Subject *"),o(),r(12,"p-select",73),S("ngModelChange",function(i){m(e);let s=p(2);return v(s.editingSchedule.subject,i)||(s.editingSchedule.subject=i),d(i)}),o()(),r(13,"div",13)(14,"label",11),l(15,"Start Time *"),o(),r(16,"input",52),S("ngModelChange",function(i){m(e);let s=p(2);return v(s.editingSchedule.startTime,i)||(s.editingSchedule.startTime=i),d(i)}),o()(),r(17,"div",13)(18,"label",11),l(19,"End Time *"),o(),r(20,"input",52),S("ngModelChange",function(i){m(e);let s=p(2);return v(s.editingSchedule.endTime,i)||(s.editingSchedule.endTime=i),d(i)}),o()()()}if(a&2){let e=p(2);c(4),y("ngModel",e.editingSchedule.instructor),u("options",e.users)("showClear",!0),c(4),y("ngModel",e.editingSchedule.day),u("options",e.daysOfWeek),c(4),y("ngModel",e.editingSchedule.subject),u("options",e.subjects),c(4),y("ngModel",e.editingSchedule.startTime),c(4),y("ngModel",e.editingSchedule.endTime)}}function Ao(a,t){if(a&1&&b(0,Bo,21,9,"div",72),a&2){let e=p();u("ngIf",e.editingSchedule)}}function Uo(a,t){if(a&1){let e=C();r(0,"div",53)(1,"p-button",54),_("click",function(){m(e);let i=p();return d(i.closeEditScheduleDialog())}),o(),r(2,"p-button",74),_("click",function(){m(e);let i=p();return d(i.saveEditedSchedule())}),o()()}}var on=class a{constructor(t,e,n){this.messageService=t;this.http=e;this.authService=n}dt;schedules=[];timeSlots=[];daysOfWeek=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];laboratories=[];filteredLaboratories=[];campuses=[];selectedCampus=null;users=[];subjects=[];selectedLaboratory=null;isCampusAdmin=!1;isSuperAdmin=!1;scheduleDialog=!1;newSchedule=this.getEmptySchedule();subjectDialog=!1;newSubject=this.getEmptySubject();scheduleDetailsDialog=!1;selectedSchedule=null;editScheduleDialog=!1;editingSchedule=null;apiUrl=`${re.apiUrl}/laboratories`;ngOnInit(){this.initializeTimeSlots(),this.checkUserRole(),this.loadCampuses(),this.loadLaboratories(),this.loadUsers(),this.loadSubjects()}checkUserRole(){let t=this.authService.getCurrentUser();this.isCampusAdmin=t?.role==="CampusAdmin",this.isSuperAdmin=t?.role==="SuperAdmin"}initializeTimeSlots(){let n=[];for(let i=7;i<=21;i++)for(let s=0;s<60;s+=30){let g=i>=12?"PM":"AM",T=i>12?i-12:i===0?12:i,le=`${String(T).padStart(2,"0")}:${String(s).padStart(2,"0")} ${g}`;n.push(le)}this.timeSlots=n}getEmptySchedule(){return{id:"",laboratory:"",day:"",time:"",endTime:"",activity:"",instructor:"",color:"#1f2937"}}getEmptySubject(){return{subjectName:"",subjectCode:"",numberOfStudents:0,units:""}}loadLaboratories(){this.http.get(this.apiUrl).subscribe({next:t=>{this.laboratories=t||[],this.filteredLaboratories=[...this.laboratories]}})}loadCampuses(){let t=`${re.apiUrl}/campuses`;this.http.get(t).subscribe({next:e=>{this.campuses=e||[]}})}onCampusFilterChange(){if(this.selectedCampus){this.filteredLaboratories=this.laboratories.filter(e=>e.campus?.campusId===this.selectedCampus.campusId),this.selectedLaboratory=null;let t=`${re.apiUrl}/schedules/filter/by-campus/${this.selectedCampus.campusId}`;this.http.get(t).subscribe({next:e=>{this.schedules=e||[]}})}else this.filteredLaboratories=[...this.laboratories],this.selectedLaboratory=null,this.schedules=[]}loadUsers(){let t=`${re.apiUrl}/users`;this.http.get(t).subscribe({next:e=>{e&&e.length>0&&console.table(e),this.users=e||[]}})}loadSubjects(){let t=`${re.apiUrl}/subjects`;this.http.get(t).subscribe({next:e=>{e&&e.length>0&&console.table(e),this.subjects=e||[]}})}onLaboratoryFilterChange(){if(this.selectedLaboratory)rn.default.fire({title:"Filter Applied",text:`Showing schedules for: ${this.selectedLaboratory.laboratoryName}`,icon:"info"}),this.loadSchedules();else if(this.selectedCampus){let t=`${re.apiUrl}/schedules/filter/by-campus/${this.selectedCampus.campusId}`;this.http.get(t).subscribe({next:e=>{this.schedules=e||[]}})}else this.messageService.add({severity:"info",summary:"Filter Cleared",detail:"Showing all laboratory schedules"}),this.schedules=[]}loadSchedules(){if(!this.selectedLaboratory){this.schedules=[];return}let t=`${re.apiUrl}/laboratories/${this.selectedLaboratory.laboratoryId}/schedules`;this.http.get(t).subscribe({next:e=>{e&&e.length>0&&console.table(e),this.schedules=e||[]}})}openNew(){this.newSchedule=this.getEmptySchedule(),this.scheduleDialog=!0}closeDialog(){this.scheduleDialog=!1,this.newSchedule=this.getEmptySchedule()}openCreateSubjectDialog(){this.newSubject=this.getEmptySubject(),this.subjectDialog=!0}closeSubjectDialog(){this.subjectDialog=!1,this.newSubject=this.getEmptySubject()}saveSubject(){if(!this.newSubject.subjectName||!this.newSubject.subjectCode||!this.newSubject.units){this.messageService.add({severity:"warn",summary:"Validation",detail:"Subject Name, Code, and Units are required"});return}let t={subjectName:this.newSubject.subjectName,subjectCode:this.newSubject.subjectCode,numberOfStudents:this.newSubject.numberOfStudents||0,units:this.newSubject.units},e=`${re.apiUrl}/subjects`;this.http.post(e,t).subscribe({next:n=>{rn.default.fire({position:"top-end",icon:"success",title:`Subject "${this.newSubject.subjectName}" created successfully`,showConfirmButton:!1,timer:1500}),this.closeSubjectDialog(),this.loadSubjects()},error:n=>{console.error("\u274C Error creating subject:",n),this.messageService.add({severity:"error",summary:"Error",detail:"Failed to create subject: "+(n?.error?.message||n?.message)})}})}saveSchedule(){if(!this.newSchedule.laboratory||!this.newSchedule.day||!this.newSchedule.time||!this.newSchedule.endTime||!this.newSchedule.activity){this.messageService.add({severity:"warn",summary:"Validation",detail:"Laboratory, Day, Start Time, End Time, and Subject are required"});return}let t={faculty:this.newSchedule.instructor||"",subject:this.newSchedule.activity,startTime:this.newSchedule.time,endTime:this.newSchedule.endTime,dayOfWeek:this.newSchedule.day},e=`${re.apiUrl}/laboratories/${this.newSchedule.laboratory}/schedules`;this.http.post(e,t).subscribe({next:n=>{rn.default.fire({title:"Good job!",text:"Lab schedule created successfully!",icon:"success"}),this.closeDialog(),this.loadSchedules()},error:n=>{console.error("\u274C Error creating schedule:",n),console.error("Error status:",n?.status),console.error("Error message:",n?.message),console.error("Error details:",n?.error),this.messageService.add({severity:"error",summary:"Error",detail:"Failed to create schedule: "+(n?.error?.message||n?.message)})}})}view(t){this.messageService.add({severity:"info",summary:"View Schedule",detail:`Viewing: ${t.activity}`})}edit(t){this.newSchedule=kt({},t),this.scheduleDialog=!0}delete(t){this.messageService.add({severity:"warn",summary:"Delete Schedule",detail:`Delete: ${t.activity}?`})}timeToMinutes(t){if(!t)return 0;let[e,n]=t.split(":").map(Number);return e*60+n}timeSlotToMinutes(t){let e=t.match(/(\d{2}):(\d{2})\s(AM|PM)/);if(!e)return 0;let n=parseInt(e[1]),i=parseInt(e[2]),s=e[3];return s==="PM"&&n!==12?n+=12:s==="AM"&&n===12&&(n=0),n*60+i}getSchedulesStartingAtSlot(t,e){if(!this.schedules||this.schedules.length===0)return[];let n=this.timeSlots[t],i=this.timeSlotToMinutes(n);return this.schedules.filter(s=>{if(s.dayOfWeek!==e)return!1;let g=this.timeToMinutes(s.startTime),T=Math.floor(g/30)*30;return i===T})}getSchedulesForCell(t,e){if(!this.schedules||this.schedules.length===0)return[];let n=this.timeSlots[t],i=this.timeSlotToMinutes(n);return this.schedules.filter(s=>{if(s.dayOfWeek!==e)return!1;let g=this.timeToMinutes(s.startTime),T=this.timeToMinutes(s.endTime);return i>=g&&i<T})}getRowSpan(t){let e=this.timeToMinutes(t.startTime),i=this.timeToMinutes(t.endTime)-e;return Math.ceil(i/30)}getScheduleColor(t){let e=["bg-green-500","bg-pink-500","bg-gray-700","bg-blue-600","bg-cyan-500","bg-yellow-500","bg-indigo-600"];if(t.subject&&t.subject.subjectId){let n=t.subject.subjectId.charCodeAt(0);return e[n%e.length]}return e[0]}viewSchedule(t){this.selectedSchedule=t,this.scheduleDetailsDialog=!0}closeScheduleDetailsDialog(){this.scheduleDetailsDialog=!1,this.selectedSchedule=null}openEditScheduleDialog(){this.selectedSchedule&&(this.editingSchedule={scheduleId:this.selectedSchedule.scheduleId,instructor:this.selectedSchedule.faculty?.userId||null,day:this.selectedSchedule.dayOfWeek,subject:this.selectedSchedule.subject?.subjectId||null,startTime:this.selectedSchedule.startTime,endTime:this.selectedSchedule.endTime},this.scheduleDetailsDialog=!1,this.editScheduleDialog=!0)}closeEditScheduleDialog(){this.editScheduleDialog=!1,this.editingSchedule=null}saveEditedSchedule(){if(!this.editingSchedule)return;let t=this.selectedLaboratory?.laboratoryId,e=this.editingSchedule.scheduleId;if(!t||!e){this.messageService.add({severity:"error",summary:"Error",detail:"Cannot update: Missing laboratory or schedule ID"});return}let n={dayOfWeek:this.editingSchedule.day,startTime:this.editingSchedule.startTime,endTime:this.editingSchedule.endTime,subjectId:this.editingSchedule.subject,facultyId:this.editingSchedule.instructor},i=`${re.apiUrl}/laboratories/${t}/schedules/${e}`;this.http.put(i,n).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"Updated",detail:"Schedule updated successfully"}),this.closeEditScheduleDialog(),this.loadSchedules()},error:s=>{console.error("\u274C Error updating schedule:",s),this.messageService.add({severity:"error",summary:"Error",detail:"Failed to update schedule: "+(s?.error?.message||s?.message)})}})}confirmDeleteSchedule(){if(!this.selectedSchedule)return;let t=this.selectedLaboratory?.laboratoryId||this.selectedSchedule.laboratory?.laboratoryId,e=this.selectedSchedule.scheduleId;if(!t||!e){this.messageService.add({severity:"error",summary:"Error",detail:"Cannot delete: Missing laboratory or schedule ID"});return}if(confirm(`Are you sure you want to delete "${this.selectedSchedule.subject?.subjectName||"this schedule"}"?`)){let n=`${re.apiUrl}/laboratories/${t}/schedules/${e}`;this.http.delete(n).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"Deleted",detail:"Schedule deleted successfully"}),this.closeScheduleDetailsDialog(),this.loadSchedules()},error:i=>{console.error("\u274C Error deleting schedule:",i),this.messageService.add({severity:"error",summary:"Error",detail:"Failed to delete schedule: "+(i?.error?.message||i?.message)})}})}}static \u0275fac=function(e){return new(e||a)(w(M),w(Ie),w(At))};static \u0275cmp=I({type:a,selectors:[["app-labschedule"]],viewQuery:function(e,n){if(e&1&&Be(ho,5),e&2){let i;Ae(i=Ue())&&(n.dt=i.first)}},features:[F([M])],decls:44,vars:35,consts:[["start",""],["end",""],["content",""],["footer",""],["styleClass","mb-4"],["class","flex flex-col items-center justify-center p-12 bg-gray-50 rounded-lg mt-4",4,"ngIf"],["class","lab-schedule-container",4,"ngIf"],["header","Add Lab Schedule",3,"visibleChange","onHide","visible","modal","closable"],[3,"visibleChange","visible","header","modal","breakpoints","closable"],[1,"grid","grid-cols-12","gap-4","mb-4"],[1,"col-span-12"],[1,"block","font-bold","mb-2"],["pInputText","","type","text","placeholder","Enter subject name",1,"w-full",3,"ngModelChange","ngModel"],[1,"col-span-6"],["pInputText","","type","text","placeholder","e.g., CS101",1,"w-full",3,"ngModelChange","ngModel"],["pInputText","","type","text","placeholder","e.g., 3",1,"w-full",3,"ngModelChange","ngModel"],["placeholder","Enter number of students",1,"w-full",3,"ngModelChange","ngModel","min"],["header","Schedule Details",3,"visibleChange","visible","modal","closable"],["header","Edit Schedule",3,"visibleChange","visible","modal","closable"],[1,"flex","items-center","gap-2"],["label","New Schedule","icon","pi pi-plus","severity","secondary",3,"onClick",4,"ngIf"],["label","Print","icon","pi pi-print","severity","secondary","outlined",""],["label","New Schedule","icon","pi pi-plus","severity","secondary",3,"onClick"],[1,"flex","items-center","gap-4"],["class","flex items-center gap-2",4,"ngIf"],[1,"font-semibold"],["optionLabel","laboratoryName","placeholder","All Laboratories","styleClass","w-64","appendTo","body",3,"ngModelChange","onChange","ngModel","options","showClear"],["optionLabel","campusName","placeholder","All Campuses","styleClass","w-48","appendTo","body",3,"ngModelChange","onChange","ngModel","options","showClear"],[1,"flex","flex-col","items-center","justify-center","p-12","bg-gray-50","rounded-lg","mt-4"],[1,"pi","pi-calendar","text-6xl","text-gray-300","mb-4"],[1,"text-xl","font-semibold","text-gray-500","mb-2"],[1,"text-gray-400"],[1,"lab-schedule-container"],[1,"schedule-table-wrapper"],[1,"schedule-table"],[1,"time-column"],[4,"ngFor","ngForOf"],[1,"time-cell"],["class","schedule-cell",4,"ngFor","ngForOf"],[1,"schedule-cell"],["class","p-3 rounded cursor-pointer hover:opacity-80 transition-opacity text-white flex flex-col items-center justify-center relative",3,"ngClass","grid-row","min-height","click",4,"ngFor","ngForOf"],[1,"p-3","rounded","cursor-pointer","hover:opacity-80","transition-opacity","text-white","flex","flex-col","items-center","justify-center","relative",3,"click","ngClass"],[1,"text-sm","font-bold"],[1,"text-xs","mt-1"],[1,"text-xs","mt-1","font-semibold"],[1,"grid","grid-cols-12","gap-4","mt-2"],["optionLabel","laboratoryName","optionValue","laboratoryId","placeholder","Select laboratory","appendTo","body",1,"w-full",3,"ngModelChange","ngModel","options"],["optionLabel","firstName","optionValue","userId","placeholder","Select instructor","appendTo","body",1,"w-full",3,"ngModelChange","ngModel","options","showClear"],["placeholder","Select day","appendTo","body",1,"w-full",3,"ngModelChange","ngModel","options"],[1,"flex","gap-2"],["optionLabel","subjectName","optionValue","subjectId","placeholder","Select subject","appendTo","body",1,"flex-1",3,"ngModelChange","ngModel","options"],["icon","pi pi-plus","severity","secondary","pTooltip","Create new subject","tooltipPosition","top",3,"click"],["pInputText","","type","time",1,"w-full",3,"ngModelChange","ngModel"],[1,"flex","justify-end","gap-2","w-full"],["label","Cancel","icon","pi pi-times","severity","secondary","text","",3,"click"],["label","Save","icon","pi pi-check",3,"click"],["label","Create","icon","pi pi-check",3,"click"],["class","flex flex-col gap-4",4,"ngIf"],[1,"flex","flex-col","gap-4"],[1,"flex","items-center","gap-3","p-3","bg-gray-100","rounded-lg"],[1,"pi","pi-book","text-2xl","text-blue-500"],[1,"font-bold","text-lg"],[1,"text-gray-600"],[1,"flex","items-center","gap-3"],[1,"pi","pi-user","text-gray-500"],[1,"pi","pi-calendar","text-gray-500"],[1,"pi","pi-clock","text-gray-500"],[1,"pi","pi-building","text-gray-500"],[1,"flex","justify-between","w-full"],["label","Edit","icon","pi pi-pencil","severity","info",3,"click"],["label","Close","icon","pi pi-times","severity","secondary","text","",3,"click"],["label","Delete","icon","pi pi-trash","severity","danger",3,"click"],["class","grid grid-cols-12 gap-4 mt-2",4,"ngIf"],["optionLabel","subjectName","optionValue","subjectId","placeholder","Select subject","appendTo","body",1,"w-full",3,"ngModelChange","ngModel","options"],["label","Update","icon","pi pi-check",3,"click"]],template:function(e,n){if(e&1){let i=C();h(0,"p-toast"),r(1,"p-toolbar",4),b(2,vo,3,1,"ng-template",null,0,x)(4,wo,6,4,"ng-template",null,1,x),o(),b(6,Mo,6,0,"div",5)(7,Eo,6,0,"div",5)(8,No,23,1,"div",6),r(9,"p-dialog",7),S("visibleChange",function(g){return m(i),v(n.scheduleDialog,g)||(n.scheduleDialog=g),d(g)}),_("onHide",function(){return m(i),d(n.closeDialog())}),b(10,Do,27,11,"ng-template",null,2,x)(12,ko,3,0,"ng-template",null,3,x),o(),r(14,"p-dialog",8),S("visibleChange",function(g){return m(i),v(n.subjectDialog,g)||(n.subjectDialog=g),d(g)}),r(15,"div",9)(16,"div",10)(17,"label",11),l(18,"Subject Name *"),o(),r(19,"input",12),S("ngModelChange",function(g){return m(i),v(n.newSubject.subjectName,g)||(n.newSubject.subjectName=g),d(g)}),o()(),r(20,"div",13)(21,"label",11),l(22,"Subject Code *"),o(),r(23,"input",14),S("ngModelChange",function(g){return m(i),v(n.newSubject.subjectCode,g)||(n.newSubject.subjectCode=g),d(g)}),o()(),r(24,"div",13)(25,"label",11),l(26,"Units *"),o(),r(27,"input",15),S("ngModelChange",function(g){return m(i),v(n.newSubject.units,g)||(n.newSubject.units=g),d(g)}),o()(),r(28,"div",10)(29,"label",11),l(30,"Number of Students"),o(),r(31,"p-inputNumber",16),S("ngModelChange",function(g){return m(i),v(n.newSubject.numberOfStudents,g)||(n.newSubject.numberOfStudents=g),d(g)}),o()()(),b(32,Lo,3,0,"ng-template",null,3,x),o(),r(34,"p-dialog",17),S("visibleChange",function(g){return m(i),v(n.scheduleDetailsDialog,g)||(n.scheduleDetailsDialog=g),d(g)}),b(35,Ro,1,1,"ng-template",null,2,x)(37,Oo,5,0,"ng-template",null,3,x),o(),r(39,"p-dialog",18),S("visibleChange",function(g){return m(i),v(n.editScheduleDialog,g)||(n.editScheduleDialog=g),d(g)}),b(40,Ao,1,1,"ng-template",null,2,x)(42,Uo,3,0,"ng-template",null,3,x),o()}e&2&&(c(6),u("ngIf",!n.selectedLaboratory&&n.isSuperAdmin),c(),u("ngIf",!n.selectedLaboratory&&!n.isSuperAdmin),c(),u("ngIf",n.selectedLaboratory),c(),it(E(30,mi)),y("visible",n.scheduleDialog),u("modal",!0)("closable",!0),c(5),it(E(31,bo)),y("visible",n.subjectDialog),u("header","Create New Subject")("modal",!0)("breakpoints",E(32,Co))("closable",!0),c(5),y("ngModel",n.newSubject.subjectName),c(4),y("ngModel",n.newSubject.subjectCode),c(4),y("ngModel",n.newSubject.units),c(4),y("ngModel",n.newSubject.numberOfStudents),u("min",0),c(3),it(E(33,xo)),y("visible",n.scheduleDetailsDialog),u("modal",!0)("closable",!0),c(5),it(E(34,mi)),y("visible",n.editScheduleDialog),u("modal",!0)("closable",!0))},dependencies:[P,Wn,pt,Te,R,L,Y,D,k,N,V,dt,W,j,B,O,A,Q,ve,J,G,se,ut,Ft,Ut,he,ye,jt,Zn,Wt,Ne],styles:[".lab-schedule-container[_ngcontent-%COMP%]{padding:1.5rem;background:#f3f4f6;border-radius:.375rem}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-title[_ngcontent-%COMP%]{font-size:1.875rem;font-weight:700;margin-bottom:1.5rem;color:#1f2937}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-table-wrapper[_ngcontent-%COMP%]{overflow-x:auto;background:#fff;border-radius:.375rem;box-shadow:0 1px 3px #0000001a}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]{width:100%;display:grid;grid-template-columns:120px repeat(7,1fr);grid-auto-rows:60px;gap:0;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%], .lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:contents}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:var(--primary-color);color:var(--primary-contrast-color);padding:1rem;text-align:center;font-weight:600;font-size:.875rem;border:1px solid #e5e7eb;position:sticky;top:0;z-index:10}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child{min-width:120px}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%], .lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:contents}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:0;border:1px solid #e5e7eb;position:relative;vertical-align:top}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.time-cell[_ngcontent-%COMP%]{background-color:#f9fafb;font-weight:600;font-size:.8125rem;color:#374151;border-right:2px solid #d1d5db;display:flex;align-items:center;justify-content:center;position:sticky;left:0;z-index:5}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.schedule-cell[_ngcontent-%COMP%]{background-color:#fafafa;overflow:visible;position:relative;padding:2px;display:grid;grid-auto-rows:60px;grid-auto-flow:row;align-content:start}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.schedule-cell[_ngcontent-%COMP%]   .schedule-block[_ngcontent-%COMP%]{width:calc(100% - 4px);padding:.5rem;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;font-size:.75rem;font-weight:600;color:#fff;cursor:pointer;transition:opacity .2s ease;border:1px solid rgba(0,0,0,.1);box-sizing:border-box;border-radius:.375rem;position:relative;z-index:20;box-shadow:0 2px 8px #00000026}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.schedule-cell[_ngcontent-%COMP%]   .schedule-block[_ngcontent-%COMP%]:hover{opacity:.9;z-index:25;box-shadow:0 4px 12px #00000040}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.schedule-cell[_ngcontent-%COMP%]   .schedule-block[_ngcontent-%COMP%]   .block-title[_ngcontent-%COMP%]{font-weight:700;margin-bottom:.125rem}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.schedule-cell[_ngcontent-%COMP%]   .schedule-block[_ngcontent-%COMP%]   .block-info[_ngcontent-%COMP%]{font-size:.65rem;opacity:.95}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.schedule-cell.bg-green-500[_ngcontent-%COMP%]{background-color:#10b981}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.schedule-cell.bg-pink-500[_ngcontent-%COMP%]{background-color:#ec4899}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.schedule-cell.bg-gray-700[_ngcontent-%COMP%]{background-color:#374151}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.schedule-cell.bg-blue-600[_ngcontent-%COMP%]{background-color:#2563eb}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.schedule-cell.bg-cyan-500[_ngcontent-%COMP%]{background-color:#06b6d4}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.schedule-cell.bg-yellow-500[_ngcontent-%COMP%]{background-color:#eab308;color:#1f2937}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.schedule-cell.bg-yellow-500[_ngcontent-%COMP%]   .block-info[_ngcontent-%COMP%]{color:#1f2937}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.schedule-cell.bg-indigo-600[_ngcontent-%COMP%]{background-color:#4f46e5}@media (max-width: 1024px){.lab-schedule-container[_ngcontent-%COMP%]{padding:1rem}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]{font-size:.8125rem}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.75rem .5rem;font-size:.8125rem}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.375rem;height:50px}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.time-cell[_ngcontent-%COMP%]{min-width:100px;font-size:.75rem}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.schedule-cell[_ngcontent-%COMP%]   .schedule-block[_ngcontent-%COMP%]{font-size:.65rem}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.schedule-cell[_ngcontent-%COMP%]   .schedule-block[_ngcontent-%COMP%]   .block-info[_ngcontent-%COMP%]{font-size:.6rem}}@media (max-width: 768px){.lab-schedule-container[_ngcontent-%COMP%]{padding:.75rem}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-title[_ngcontent-%COMP%]{font-size:1.5rem;margin-bottom:1rem}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.5rem .25rem;font-size:.75rem}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.25rem;height:40px}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.time-cell[_ngcontent-%COMP%]{min-width:80px;font-size:.7rem;padding:.25rem}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.schedule-cell[_ngcontent-%COMP%]   .schedule-block[_ngcontent-%COMP%]{font-size:.6rem;padding:.125rem .25rem}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.schedule-cell[_ngcontent-%COMP%]   .schedule-block[_ngcontent-%COMP%]   .block-title[_ngcontent-%COMP%]{margin-bottom:0}.lab-schedule-container[_ngcontent-%COMP%]   .schedule-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.schedule-cell[_ngcontent-%COMP%]   .schedule-block[_ngcontent-%COMP%]   .block-info[_ngcontent-%COMP%]{display:none}}"]})};var di=Ee(Pe());var jo=["dt"],Wo=()=>({width:"500px"}),$o=()=>[],ui=()=>[10,20,30];function qo(a,t){if(a&1&&(r(0,"div",15)(1,"span",16),l(2),o()()),a&2){let e=p(2);c(2),ke("Assets in ",e.selectedLaboratoryData.laboratoryName," (",(e.selectedLaboratoryData.assets==null?null:e.selectedLaboratoryData.assets.length)||0,")")}}function Ho(a,t){if(a&1){let e=C();r(0,"div",15)(1,"p-button",17),_("onClick",function(){m(e);let i=p(2);return d(i.deleteSelectedAssets())}),o(),r(2,"p-button",18),_("onClick",function(){m(e);let i=p(2);return d(i.exportAssetsCSV())}),o()()}if(a&2){let e=p(2);c(),u("disabled",!e.selectedAssets.length)}}function zo(a,t){a&1&&(r(0,"tr")(1,"th",19),h(2,"p-tableHeaderCheckbox"),o(),r(3,"th",20),l(4,"Asset "),h(5,"p-sortIcon",21),o(),r(6,"th"),l(7,"Property #"),o(),r(8,"th"),l(9,"Category"),o(),r(10,"th"),l(11,"Issued To"),o(),r(12,"th",22),l(13,"QR Code"),o()())}function Yo(a,t){if(a&1&&h(0,"img",29),a&2){let e=p(2).$implicit;u("src",e.qrCode,Vn)}}function Qo(a,t){if(a&1&&(r(0,"span",30),l(1),o()),a&2){let e=p(2).$implicit;c(),K(" ",e.qrCode," ")}}function Go(a,t){if(a&1&&(r(0,"div",26),b(1,Yo,1,1,"img",27)(2,Qo,2,1,"span",28),o()),a&2){let e=p().$implicit,n=p(2);c(),u("ngIf",n.isBase64Image(e.qrCode)),c(),u("ngIf",!n.isBase64Image(e.qrCode))}}function Jo(a,t){a&1&&(r(0,"span",31),l(1,"N/A"),o())}function Ko(a,t){if(a&1&&(r(0,"tr")(1,"td",19),h(2,"p-tableCheckbox",23),o(),r(3,"td"),l(4),o(),r(5,"td"),l(6),o(),r(7,"td"),h(8,"p-tag",23),o(),r(9,"td"),l(10),o(),r(11,"td"),b(12,Go,3,2,"div",24)(13,Jo,2,0,"span",25),o(),h(14,"td"),o()),a&2){let e=t.$implicit;c(2),u("value",e),c(2),f(e.assetName),c(2),f(e.propertyNumber),c(2),u("value",e.category||"N/A"),c(2),f(e.issuedTo),c(2),u("ngIf",e.qrCode),c(),u("ngIf",!e.qrCode)}}function Xo(a,t){a&1&&(r(0,"tr")(1,"td",32),l(2,"No assets in this laboratory"),o()())}function Zo(a,t){if(a&1){let e=C();r(0,"div",9)(1,"p-toolbar",10),b(2,qo,3,2,"ng-template",null,2,x)(4,Ho,3,1,"ng-template",null,3,x),o(),r(6,"p-table",11,4),S("selectionChange",function(i){m(e);let s=p();return v(s.selectedAssets,i)||(s.selectedAssets=i),d(i)}),b(8,zo,14,0,"ng-template",12)(9,Ko,15,7,"ng-template",13)(10,Xo,3,0,"ng-template",14),o()()}if(a&2){let e=p();c(6),u("value",e.selectedLaboratoryData.assets||E(8,$o))("rows",10)("paginator",!0)("rowsPerPageOptions",E(9,ui))("loading",e.loading)("rowHover",!0),y("selection",e.selectedAssets),u("showCurrentPageReport",!0)}}function ea(a,t){if(a&1){let e=C();r(0,"div",15)(1,"p-button",35),_("onClick",function(){m(e);let i=p(2);return d(i.openNew())}),o(),r(2,"p-button",17),_("onClick",function(){m(e);let i=p(2);return d(i.deleteSelected())}),o()()}if(a&2){let e=p(2);c(2),u("disabled",!e.selectedLabs.length)}}function ta(a,t){if(a&1){let e=C();r(0,"div",15)(1,"p-button",18),_("onClick",function(){m(e);let i=p(2);return d(i.exportCSV())}),o(),r(2,"p-iconfield"),h(3,"p-inputicon",36),r(4,"input",37),S("ngModelChange",function(i){m(e);let s=p(2);return v(s.searchValue,i)||(s.searchValue=i),d(i)}),_("input",function(){m(e);let i=p(2);return d(i.filter())}),o()()()}if(a&2){let e=p(2);c(4),y("ngModel",e.searchValue)}}function na(a,t){a&1&&(r(0,"tr")(1,"th",19),h(2,"p-tableHeaderCheckbox"),o(),r(3,"th"),l(4,"ID"),o(),r(5,"th",38),l(6,"Laboratory Name "),h(7,"p-sortIcon",39),o(),r(8,"th"),l(9,"Campus"),o(),r(10,"th",40),l(11,"Actions"),o()())}function ia(a,t){if(a&1){let e=C();r(0,"tr")(1,"td",19),h(2,"p-tableCheckbox",23),o(),r(3,"td"),l(4),o(),r(5,"td"),l(6),o(),r(7,"td"),l(8),o(),r(9,"td")(10,"div",41)(11,"p-button",42),_("onClick",function(){let i=m(e).$implicit,s=p(2);return d(s.edit(i))}),o(),r(12,"p-button",43),_("onClick",function(){let i=m(e).$implicit,s=p(2);return d(s.delete(i))}),o()()()()}if(a&2){let e=t.$implicit;c(2),u("value",e),c(2),f(e.laboratoryId),c(2),f(e.laboratoryName),c(2),f(e.campus==null?null:e.campus.campusName),c(3),u("rounded",!0)("text",!0),c(),u("rounded",!0)("text",!0)}}function ra(a,t){a&1&&(r(0,"tr")(1,"td",44),l(2,"No laboratories found"),o()())}function oa(a,t){if(a&1){let e=C();r(0,"div")(1,"p-toolbar",33),b(2,ea,3,1,"ng-template",null,2,x)(4,ta,5,1,"ng-template",null,3,x),o(),r(6,"p-table",34,5),S("selectionChange",function(i){m(e);let s=p();return v(s.selectedLabs,i)||(s.selectedLabs=i),d(i)}),_("selectionChange",function(i){m(e);let s=p();return d(s.onSelectionChange(i))}),b(8,na,12,0,"ng-template",12)(9,ia,13,8,"ng-template",13)(10,ra,3,0,"ng-template",14),o()()}if(a&2){let e=p();c(6),u("value",e.laboratories)("rows",10)("paginator",!0)("rowsPerPageOptions",E(8,ui))("loading",e.loading)("rowHover",!0),y("selection",e.selectedLabs),u("showCurrentPageReport",!0)}}function aa(a,t){if(a&1){let e=C();r(0,"div",45)(1,"div",46)(2,"label",47),l(3,"Laboratory Name *"),o(),r(4,"input",48),S("ngModelChange",function(i){m(e);let s=p();return v(s.newLab.laboratoryName,i)||(s.newLab.laboratoryName=i),d(i)}),o()(),r(5,"div",46)(6,"label",47),l(7,"Laboratory Location *"),o(),r(8,"input",49),S("ngModelChange",function(i){m(e);let s=p();return v(s.newLab.laboratoryLocation,i)||(s.newLab.laboratoryLocation=i),d(i)}),o()()()}if(a&2){let e=p();c(4),y("ngModel",e.newLab.laboratoryName),c(4),y("ngModel",e.newLab.laboratoryLocation)}}function la(a,t){if(a&1){let e=C();r(0,"div",50)(1,"p-button",51),_("click",function(){m(e);let i=p();return d(i.closeDialog())}),o(),r(2,"p-button",52),_("click",function(){m(e);let i=p();return d(i.saveLab())}),o()()}}var It=class a{constructor(t,e,n){this.messageService=t;this.http=e;this.route=n}dt;laboratories=[];filteredLaboratories=[];selectedLabs=[];selectedAssets=[];searchValue="";loading=!0;selectedLaboratoryId=null;selectedLaboratoryData=null;labDialog=!1;newLab=this.getEmptyLab();apiUrl=`${re.apiUrl}/laboratories`;ngOnInit(){this.route.paramMap.subscribe(t=>{let e=t.get("id");e?(this.selectedLaboratoryId=e,this.loadLaboratories(e)):this.loadLaboratories()})}getEmptyLab(){return{laboratoryId:"",laboratoryName:"",laboratoryLocation:"",campus:null}}loadLaboratories(t){this.loading=!0,this.http.get(this.apiUrl).subscribe({next:e=>{if(e&&e.length>0,console.table(e),this.laboratories=e||[],t){let n=this.laboratories.filter(i=>i.laboratoryId===t);n.length>0?(this.selectedLaboratoryData=n[0],this.filteredLaboratories=n):(console.warn("\u26A0\uFE0F Laboratory not found with ID:",t),this.filteredLaboratories=[])}else this.filteredLaboratories=[...this.laboratories];this.loading=!1},error:e=>{console.error("\u274C Error loading laboratories:",e),console.error("Error status:",e?.status),console.error("Error message:",e?.message),console.error("Error details:",e?.error),this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load laboratories: "+e?.message}),this.loading=!1}})}filter(){this.filteredLaboratories=this.laboratories.filter(t=>t.laboratoryName?.toLowerCase().includes(this.searchValue.toLowerCase())||t.laboratoryId?.toLowerCase().includes(this.searchValue.toLowerCase())||t.campus?.campusName?.toLowerCase().includes(this.searchValue.toLowerCase()))}onSelectionChange(t){}openNew(){this.newLab=this.getEmptyLab(),this.labDialog=!0}closeDialog(){this.labDialog=!1,this.newLab=this.getEmptyLab()}saveLab(){if(!this.newLab.laboratoryName||!this.newLab.laboratoryLocation){this.messageService.add({severity:"warn",summary:"Validation",detail:"Laboratory Name and Location are required"});return}let t={laboratoryName:this.newLab.laboratoryName,laboratoryLocation:this.newLab.laboratoryLocation};this.http.post(this.apiUrl,t).subscribe({next:e=>{di.default.fire({title:"Good job!",text:"Laboratory created successfully!",icon:"success"}),this.closeDialog(),this.loadLaboratories()},error:e=>{console.error("\u274C Error creating laboratory:",e),this.messageService.add({severity:"error",summary:"Error",detail:"Failed to create laboratory: "+(e?.error?.message||e?.message)})}})}view(t){this.messageService.add({severity:"info",summary:"View Laboratory",detail:`Viewing: ${t.laboratoryName}`})}edit(t){this.newLab=kt({},t),this.labDialog=!0}delete(t){this.messageService.add({severity:"warn",summary:"Delete Laboratory",detail:`Delete: ${t.laboratoryName}?`})}deleteSelected(){!this.selectedLabs||this.selectedLabs.length===0||this.messageService.add({severity:"warn",summary:"Delete",detail:`Delete ${this.selectedLabs.length} laboratory(ies)?`})}exportCSV(){let t=`Laboratory ID,Laboratory Name,Campus
`;this.laboratories.forEach(s=>{t+=`${s.laboratoryId},${s.laboratoryName},${s.campus?.campusName}
`});let e=new Blob([t],{type:"text/csv"}),n=window.URL.createObjectURL(e),i=document.createElement("a");i.href=n,i.download="laboratories.csv",i.click(),window.URL.revokeObjectURL(n)}isBase64Image(t){return t?.startsWith("data:image")||t?.startsWith("http")}deleteSelectedAssets(){!this.selectedAssets||this.selectedAssets.length===0||this.messageService.add({severity:"warn",summary:"Delete",detail:`Delete ${this.selectedAssets.length} asset(s)?`})}exportAssetsCSV(){let t=this.selectedLaboratoryData?.assets||[],e=`Asset Name,Property #,Category,Issued To
`;t.forEach(g=>{e+=`${g.assetName},${g.propertyNumber},${g.category||"N/A"},${g.issuedTo}
`});let n=new Blob([e],{type:"text/csv"}),i=window.URL.createObjectURL(n),s=document.createElement("a");s.href=i,s.download=`${this.selectedLaboratoryData?.laboratoryName||"laboratory"}_assets.csv`,s.click(),window.URL.revokeObjectURL(i)}static \u0275fac=function(e){return new(e||a)(w(M),w(Ie),w($n))};static \u0275cmp=I({type:a,selectors:[["app-laboratories"]],viewQuery:function(e,n){if(e&1&&Be(jo,5),e&2){let i;Ae(i=Ue())&&(n.dt=i.first)}},features:[F([M])],decls:8,vars:8,consts:[["content",""],["footer",""],["start",""],["end",""],["dtAssets",""],["dt",""],["class","mb-4",4,"ngIf"],[4,"ngIf"],["header","Laboratory",3,"visibleChange","onHide","visible","modal","closable"],[1,"mb-4"],["styleClass","mb-4 mt-4"],["dataKey","assetId","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} assets",3,"selectionChange","value","rows","paginator","rowsPerPageOptions","loading","rowHover","selection","showCurrentPageReport"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"flex","items-center","gap-2"],[1,"text-lg","font-semibold"],["label","Delete Selected","icon","pi pi-trash","severity","secondary","outlined","",3,"onClick","disabled"],["label","Export","icon","pi pi-upload","severity","secondary",3,"onClick"],[2,"width","3rem"],["pSortableColumn","assetName"],["field","assetName"],[2,"width","5rem"],[3,"value"],["class","inline-block",4,"ngIf"],["class","text-gray-400",4,"ngIf"],[1,"inline-block"],["alt","QR Code","class","w-14 h-14 rounded-lg border-2 border-gray-300 cursor-pointer hover:shadow-lg hover:scale-110 transition-all","pTooltip","Click to view QR Code",3,"src",4,"ngIf"],["class","text-sm bg-blue-100 px-2 py-1 rounded cursor-pointer hover:bg-blue-200 transition-colors","pTooltip","Click to copy QR Code",4,"ngIf"],["alt","QR Code","pTooltip","Click to view QR Code",1,"w-14","h-14","rounded-lg","border-2","border-gray-300","cursor-pointer","hover:shadow-lg","hover:scale-110","transition-all",3,"src"],["pTooltip","Click to copy QR Code",1,"text-sm","bg-blue-100","px-2","py-1","rounded","cursor-pointer","hover:bg-blue-200","transition-colors"],[1,"text-gray-400"],["colspan","7",1,"text-center","py-5"],["styleClass","mb-4"],["dataKey","laboratoryId","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} laboratories",3,"selectionChange","value","rows","paginator","rowsPerPageOptions","loading","rowHover","selection","showCurrentPageReport"],["label","New","icon","pi pi-plus","severity","secondary",3,"onClick"],["styleClass","pi pi-search"],["pInputText","","type","text","placeholder","Search laboratories...",3,"ngModelChange","input","ngModel"],["pSortableColumn","laboratoryName"],["field","laboratoryName"],[2,"width","6rem"],[1,"flex","gap-2"],["icon","pi pi-pencil","severity","secondary",3,"onClick","rounded","text"],["icon","pi pi-trash","severity","danger",3,"onClick","rounded","text"],["colspan","5",1,"text-center","py-5"],[1,"grid","grid-cols-12","gap-4","mt-2"],[1,"col-span-12"],[1,"block","font-bold","mb-2"],["pInputText","","placeholder","Enter laboratory name",1,"w-full",3,"ngModelChange","ngModel"],["pInputText","","placeholder","Enter laboratory location",1,"w-full",3,"ngModelChange","ngModel"],[1,"flex","justify-end","gap-2","w-full"],["label","Cancel","icon","pi pi-times","severity","secondary","text","",3,"click"],["label","Save","icon","pi pi-check",3,"click"]],template:function(e,n){if(e&1){let i=C();h(0,"p-toast"),b(1,Zo,11,10,"div",6)(2,oa,11,9,"div",7),r(3,"p-dialog",8),S("visibleChange",function(g){return m(i),v(n.labDialog,g)||(n.labDialog=g),d(g)}),_("onHide",function(){return m(i),d(n.closeDialog())}),b(4,aa,9,2,"ng-template",null,0,x)(6,la,3,0,"ng-template",null,1,x),o()}e&2&&(c(),u("ngIf",n.selectedLaboratoryId&&n.selectedLaboratoryData),c(),u("ngIf",!n.selectedLaboratoryId),c(),it(E(7,Wo)),y("visible",n.labDialog),u("modal",!0)("closable",!0))},dependencies:[P,Te,R,U,$,q,H,ee,te,L,Y,D,k,N,V,dt,W,j,B,O,A,Q,ve,Ve,J,Z,G,X,se,ut,Ft,Ut,he,jt,Wt],encapsulation:2})};var sa=()=>["Active","Inactive","All"];function ca(a,t){a&1&&(r(0,"h2",17),l(1,"Asset Report"),o())}function pa(a,t){if(a&1){let e=C();r(0,"p-button",18),_("onClick",function(){m(e);let i=p();return d(i.exportToCSV())}),o(),r(1,"p-button",19),_("onClick",function(){m(e);let i=p();return d(i.printReport())}),o()}}function ma(a,t){if(a&1){let e=C();r(0,"div",20)(1,"div",21)(2,"label",22),l(3,"Category Filter"),o(),r(4,"p-select",23),S("ngModelChange",function(i){m(e);let s=p();return v(s.selectedCategory,i)||(s.selectedCategory=i),d(i)}),_("onChange",function(){m(e);let i=p();return d(i.filterAssets())}),o()(),r(5,"div",21)(6,"label",22),l(7,"Status Filter"),o(),r(8,"p-select",24),S("ngModelChange",function(i){m(e);let s=p();return v(s.selectedStatus,i)||(s.selectedStatus=i),d(i)}),_("onChange",function(){m(e);let i=p();return d(i.filterAssets())}),o()(),r(9,"div",25)(10,"p-button",26),_("onClick",function(){m(e);let i=p();return d(i.clearFilters())}),o()()()}if(a&2){let e=p();c(4),y("ngModel",e.selectedCategory),u("options",e.categories)("showClear",!0),c(4),y("ngModel",e.selectedStatus),u("options",E(6,sa))("showClear",!0)}}function da(a,t){a&1&&(r(0,"tr")(1,"th",27),l(2,"Asset Name "),h(3,"p-sortIcon",28),o(),r(4,"th",27),l(5,"Category "),h(6,"p-sortIcon",29),o(),r(7,"th",27),l(8,"Property No. "),h(9,"p-sortIcon",30),o(),r(10,"th"),l(11,"Issued To"),o(),r(12,"th"),l(13,"Status"),o(),r(14,"th"),l(15,"Location"),o()())}function ua(a,t){if(a&1&&(r(0,"tr")(1,"td"),l(2),o(),r(3,"td"),l(4),o(),r(5,"td"),l(6),o(),r(7,"td"),l(8),o(),r(9,"td"),h(10,"p-tag",31),o(),r(11,"td"),l(12),o()()),a&2){let e=t.$implicit;c(2),f(e.assetName||e.AssetName||"N/A"),c(2),f(e.category||e.Category||"N/A"),c(2),f(e.propertyNumber||e.PropertyNo||"N/A"),c(2),f(e.issuedTo||e.IssuedTo||"N/A"),c(2),u("value",e.Status_id==="1"?"Active":"Inactive")("severity",e.Status_id==="1"?"success":"secondary"),c(2),f(e.foundCluster||e.FoundCluster||"N/A")}}function ga(a,t){a&1&&(r(0,"tr")(1,"td",32),l(2,"No assets found matching the selected filters."),o()())}function _a(a,t){a&1&&(r(0,"h3",33),l(1,"Assets by Category"),o())}function fa(a,t){a&1&&(r(0,"tr")(1,"th"),l(2,"Category"),o(),r(3,"th"),l(4,"Count"),o(),r(5,"th"),l(6,"Percentage"),o()())}function ha(a,t){if(a&1&&(r(0,"tr")(1,"td"),l(2),o(),r(3,"td"),l(4),o(),r(5,"td"),l(6),o()()),a&2){let e=t.$implicit,n=p();c(2),f(e.category||"Uncategorized"),c(2),f(e.count),c(2),K("",(e.count/n.assets.length*100).toFixed(2),"%")}}var an=class a{constructor(t,e){this.assetService=t;this.messageService=e}assets=[];filteredAssets=[];categories=[];selectedCategory="";selectedStatus="";ngOnInit(){this.loadAssets()}loadAssets(){this.assetService.getAssets().subscribe({next:t=>{this.assets=t,this.filteredAssets=t,this.extractCategories()},error:t=>{console.error("\u274C Error loading assets:",t),this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load assets"})}})}extractCategories(){let t=new Set(this.assets.map(e=>e.category||e.Category).filter(e=>e));this.categories=Array.from(t).map(e=>({category:e}))}filterAssets(){this.filteredAssets=this.assets.filter(t=>{let e=!this.selectedCategory||(t.category||t.Category)===this.selectedCategory,n=!this.selectedStatus||(this.selectedStatus==="Active"?t.Status_id==="1":t.Status_id!=="1");return e&&n})}clearFilters(){this.selectedCategory="",this.selectedStatus="",this.filteredAssets=this.assets}getActiveAssetsCount(){return this.assets.filter(t=>t.Status_id==="1").length}getCategoriesCount(){return new Set(this.assets.map(t=>t.category||t.Category)).size}getCategoryBreakdown(){let t={};return this.assets.forEach(e=>{let n=e.category||e.Category||"Uncategorized";t[n]=(t[n]||0)+1}),Object.entries(t).map(([e,n])=>({category:e,count:n}))}exportToCSV(){let t=["Asset Name","Category","Property Number","Issued To","Status","Location"],e=this.filteredAssets.map(T=>[T.assetName||T.AssetName,T.category||T.Category,T.propertyNumber||T.PropertyNo,T.issuedTo||T.IssuedTo,T.Status_id==="1"?"Active":"Inactive",T.foundCluster||T.FoundCluster]),n=t.join(",")+`
`;e.forEach(T=>{n+=T.map(le=>`"${le||""}"`).join(",")+`
`});let i=new Blob([n],{type:"text/csv"}),s=window.URL.createObjectURL(i),g=document.createElement("a");g.href=s,g.download=`asset-report-${new Date().toISOString().split("T")[0]}.csv`,g.click(),window.URL.revokeObjectURL(s),this.messageService.add({severity:"success",summary:"Exported",detail:"Asset report exported to CSV"})}printReport(){window.print()}static \u0275fac=function(e){return new(e||a)(w(Me),w(M))};static \u0275cmp=I({type:a,selectors:[["app-asset-report"]],features:[F([M])],decls:40,vars:7,consts:[["start",""],["end",""],["header",""],["body",""],["emptymessage",""],["styleClass","mb-4"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","mb-6"],[1,"p-4","bg-blue-50","rounded-lg"],[1,"text-gray-600","text-sm"],[1,"text-3xl","font-bold","text-blue-600"],[1,"p-4","bg-green-50","rounded-lg"],[1,"text-3xl","font-bold","text-green-600"],[1,"p-4","bg-orange-50","rounded-lg"],[1,"text-3xl","font-bold","text-orange-600"],[1,"mb-4"],["responsiveLayout","scroll",3,"value","paginator","rows"],[3,"value"],[1,"text-2xl","font-bold"],["label","Export to CSV","icon","pi pi-download","severity","success",3,"onClick"],["label","Print","icon","pi pi-print","severity","info",1,"ml-2",3,"onClick"],[1,"flex","gap-4","p-4"],[1,"flex-1"],[1,"block","text-sm","font-medium","mb-2"],["optionLabel","category","optionValue","category","placeholder","All Categories",3,"ngModelChange","onChange","ngModel","options","showClear"],["placeholder","All Status",3,"ngModelChange","onChange","ngModel","options","showClear"],[1,"flex","items-end"],["label","Clear Filters","icon","pi pi-times","severity","secondary",3,"onClick"],["pSortableColumn",""],["field","assetName"],["field","category"],["field","propertyNumber"],[3,"value","severity"],["colspan","6",1,"text-center","p-4"],[1,"text-lg","font-bold","p-4"]],template:function(e,n){e&1&&(h(0,"p-toast"),r(1,"p-toolbar",5),b(2,ca,2,0,"ng-template",null,0,x)(4,pa,2,0,"ng-template",null,1,x),o(),r(6,"div",6)(7,"div",7)(8,"p",8),l(9,"Total Assets"),o(),r(10,"p",9),l(11),o()(),r(12,"div",10)(13,"p",8),l(14,"Active Assets"),o(),r(15,"p",11),l(16),o()(),r(17,"div",12)(18,"p",8),l(19,"By Category"),o(),r(20,"p",13),l(21),o()()(),r(22,"p-card",14),b(23,ma,11,7,"ng-template",null,2,x),r(25,"p-table",15),b(26,da,16,0,"ng-template",null,2,x)(28,ua,13,7,"ng-template",null,3,x)(30,ga,3,0,"ng-template",null,4,x),o()(),r(32,"p-card"),b(33,_a,2,0,"ng-template",null,2,x),r(35,"p-table",16),b(36,fa,7,0,"ng-template",null,2,x)(38,ha,7,3,"ng-template",null,3,x),o()()),e&2&&(c(11),f(n.assets.length),c(5),f(n.getActiveAssetsCount()),c(5),f(n.getCategoriesCount()),c(4),u("value",n.filteredAssets)("paginator",!0)("rows",10),c(10),u("value",n.getCategoryBreakdown()))},dependencies:[P,L,D,k,N,V,R,U,q,H,he,ye,A,z,ht,W,j,B,O,ve,Ve,Ne],styles:["[_nghost-%COMP%]     .p-card{box-shadow:0 1px 3px #0000001a}"]})};var ba=()=>["Pending","Approved","Completed","All"],Ca=()=>["Urgent","High","Normal","Low","All"];function xa(a,t){a&1&&(r(0,"h2",20),l(1,"Maintenance Report"),o())}function ya(a,t){if(a&1){let e=C();r(0,"p-button",21),_("onClick",function(){m(e);let i=p();return d(i.exportToCSV())}),o(),r(1,"p-button",22),_("onClick",function(){m(e);let i=p();return d(i.printReport())}),o()}}function va(a,t){if(a&1){let e=C();r(0,"div",23)(1,"div",24)(2,"label",25),l(3,"Status Filter"),o(),r(4,"p-select",26),S("ngModelChange",function(i){m(e);let s=p();return v(s.selectedStatus,i)||(s.selectedStatus=i),d(i)}),_("onChange",function(){m(e);let i=p();return d(i.filterRequests())}),o()(),r(5,"div",24)(6,"label",25),l(7,"Priority Filter"),o(),r(8,"p-select",27),S("ngModelChange",function(i){m(e);let s=p();return v(s.selectedPriority,i)||(s.selectedPriority=i),d(i)}),_("onChange",function(){m(e);let i=p();return d(i.filterRequests())}),o()(),r(9,"div",28)(10,"p-button",29),_("onClick",function(){m(e);let i=p();return d(i.clearFilters())}),o()()()}if(a&2){let e=p();c(4),y("ngModel",e.selectedStatus),u("options",E(4,ba)),c(4),y("ngModel",e.selectedPriority),u("options",E(5,Ca))}}function Sa(a,t){a&1&&(r(0,"tr")(1,"th",30),l(2,"Request Name "),h(3,"p-sortIcon",31),o(),r(4,"th",30),l(5,"Type "),h(6,"p-sortIcon",32),o(),r(7,"th"),l(8,"Priority"),o(),r(9,"th"),l(10,"Status"),o(),r(11,"th"),l(12,"Service"),o(),r(13,"th",30),l(14,"Date "),h(15,"p-sortIcon",33),o()())}function wa(a,t){if(a&1&&(r(0,"tr")(1,"td"),l(2),o(),r(3,"td"),l(4),o(),r(5,"td"),h(6,"p-tag",34),o(),r(7,"td"),h(8,"p-tag",34),o(),r(9,"td"),l(10),o(),r(11,"td"),l(12),o()()),a&2){let e=t.$implicit,n=p();c(2),f(e.maintenanceName||"N/A"),c(2),f(e.maintenanceTypeName||"N/A"),c(2),u("value",n.getPriorityLabel(e.priorityLevelName))("severity",n.getPrioritySeverity(e.priorityLevelName)),c(2),u("value",e.requestStatusName||"Pending")("severity",n.getStatusSeverity(e.requestStatusName)),c(2),f(e.serviceMaintenanceName||"N/A"),c(2),f(n.formatDate(e.createdDate))}}function Ma(a,t){a&1&&(r(0,"tr")(1,"td",35),l(2,"No maintenance requests found."),o()())}function Ea(a,t){a&1&&(r(0,"h3",36),l(1,"Requests by Status"),o())}function Ta(a,t){a&1&&(r(0,"tr")(1,"th"),l(2,"Status"),o(),r(3,"th"),l(4,"Count"),o(),r(5,"th"),l(6,"Percentage"),o()())}function Ia(a,t){if(a&1&&(r(0,"tr")(1,"td"),l(2),o(),r(3,"td"),l(4),o(),r(5,"td"),l(6),o()()),a&2){let e=t.$implicit,n=p();c(2),f(e.status),c(2),f(e.count),c(2),K("",(e.count/n.maintenanceRequests.length*100).toFixed(2),"%")}}function Pa(a,t){a&1&&(r(0,"h3",36),l(1,"Requests by Priority"),o())}function Na(a,t){a&1&&(r(0,"tr")(1,"th"),l(2,"Priority"),o(),r(3,"th"),l(4,"Count"),o(),r(5,"th"),l(6,"Percentage"),o()())}function Da(a,t){if(a&1&&(r(0,"tr")(1,"td"),l(2),o(),r(3,"td"),l(4),o(),r(5,"td"),l(6),o()()),a&2){let e=t.$implicit,n=p();c(2),f(e.priority),c(2),f(e.count),c(2),K("",(e.count/n.maintenanceRequests.length*100).toFixed(2),"%")}}var ln=class a{constructor(t,e){this.maintenanceService=t;this.messageService=e}maintenanceRequests=[];filteredRequests=[];selectedStatus="All";selectedPriority="All";ngOnInit(){this.loadMaintenanceRequests()}loadMaintenanceRequests(){this.maintenanceService.getMaintenanceRequests().subscribe({next:t=>{this.maintenanceRequests=t,this.filteredRequests=t},error:t=>{console.error("\u274C Error loading maintenance requests:",t),this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load maintenance requests"})}})}filterRequests(){this.filteredRequests=this.maintenanceRequests.filter(t=>{let e=this.selectedStatus==="All"||(t.requestStatusName||"Pending")===this.selectedStatus,n=this.selectedPriority==="All"||(t.priorityLevelName||"Normal")===this.selectedPriority;return e&&n})}clearFilters(){this.selectedStatus="All",this.selectedPriority="All",this.filteredRequests=this.maintenanceRequests}getPendingCount(){return this.maintenanceRequests.filter(t=>(t.requestStatusName||"Pending")==="Pending").length}getApprovedCount(){return this.maintenanceRequests.filter(t=>t.requestStatusName==="Approved").length}getCompletedCount(){return this.maintenanceRequests.filter(t=>t.requestStatusName==="Completed").length}getStatusSeverity(t){return{Pending:"warn",Approved:"info",Completed:"success"}[t]||"secondary"}getPrioritySeverity(t){return{Urgent:"danger",High:"warn",Normal:"info",Low:"success"}[t]||"secondary"}getPriorityLabel(t){return t||"Normal"}getStatusBreakdown(){let t={};return this.maintenanceRequests.forEach(e=>{let n=e.requestStatusName||"Pending";t[n]=(t[n]||0)+1}),Object.entries(t).map(([e,n])=>({status:e,count:n}))}getPriorityBreakdown(){let t={};return this.maintenanceRequests.forEach(e=>{let n=e.priorityLevelName||"Normal";t[n]=(t[n]||0)+1}),Object.entries(t).map(([e,n])=>({priority:e,count:n}))}formatDate(t){return t?new Date(t).toLocaleDateString():"N/A"}exportToCSV(){let t=["Request Name","Type","Priority","Status","Service","Date"],e=this.filteredRequests.map(T=>[T.maintenanceName||"N/A",T.maintenanceTypeName||"N/A",T.priorityLevelName||"Normal",T.requestStatusName||"Pending",T.serviceMaintenanceName||"N/A",this.formatDate(T.createdDate)]),n=t.join(",")+`
`;e.forEach(T=>{n+=T.map(le=>`"${le}"`).join(",")+`
`});let i=new Blob([n],{type:"text/csv"}),s=window.URL.createObjectURL(i),g=document.createElement("a");g.href=s,g.download=`maintenance-report-${new Date().toISOString().split("T")[0]}.csv`,g.click(),window.URL.revokeObjectURL(s),this.messageService.add({severity:"success",summary:"Exported",detail:"Maintenance report exported to CSV"})}printReport(){window.print()}static \u0275fac=function(e){return new(e||a)(w(We),w(M))};static \u0275cmp=I({type:a,selectors:[["app-maintenance-report"]],features:[F([M])],decls:54,vars:9,consts:[["start",""],["end",""],["header",""],["body",""],["emptymessage",""],["styleClass","mb-4"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","mb-6"],[1,"p-4","bg-blue-50","rounded-lg"],[1,"text-gray-600","text-sm"],[1,"text-3xl","font-bold","text-blue-600"],[1,"p-4","bg-yellow-50","rounded-lg"],[1,"text-3xl","font-bold","text-yellow-600"],[1,"p-4","bg-green-50","rounded-lg"],[1,"text-3xl","font-bold","text-green-600"],[1,"p-4","bg-purple-50","rounded-lg"],[1,"text-3xl","font-bold","text-purple-600"],[1,"mb-4"],["responsiveLayout","scroll",3,"value","paginator","rows"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[3,"value"],[1,"text-2xl","font-bold"],["label","Export to CSV","icon","pi pi-download","severity","success",3,"onClick"],["label","Print","icon","pi pi-print","severity","info",1,"ml-2",3,"onClick"],[1,"flex","gap-4","p-4","flex-wrap"],[1,"flex-1","min-w-[200px]"],[1,"block","text-sm","font-medium","mb-2"],["placeholder","All Status",3,"ngModelChange","onChange","ngModel","options"],["placeholder","All Priorities",3,"ngModelChange","onChange","ngModel","options"],[1,"flex","items-end"],["label","Clear Filters","icon","pi pi-times","severity","secondary",3,"onClick"],["pSortableColumn",""],["field","maintenanceName"],["field","maintenanceTypeName"],["field","createdDate"],[3,"value","severity"],["colspan","6",1,"text-center","p-4"],[1,"text-lg","font-bold","p-4"]],template:function(e,n){e&1&&(h(0,"p-toast"),r(1,"p-toolbar",5),b(2,xa,2,0,"ng-template",null,0,x)(4,ya,2,0,"ng-template",null,1,x),o(),r(6,"div",6)(7,"div",7)(8,"p",8),l(9,"Total Requests"),o(),r(10,"p",9),l(11),o()(),r(12,"div",10)(13,"p",8),l(14,"Pending"),o(),r(15,"p",11),l(16),o()(),r(17,"div",12)(18,"p",8),l(19,"Approved"),o(),r(20,"p",13),l(21),o()(),r(22,"div",14)(23,"p",8),l(24,"Completed"),o(),r(25,"p",15),l(26),o()()(),r(27,"p-card",16),b(28,va,11,6,"ng-template",null,2,x),r(30,"p-table",17),b(31,Sa,16,0,"ng-template",null,2,x)(33,wa,13,8,"ng-template",null,3,x)(35,Ma,3,0,"ng-template",null,4,x),o()(),r(37,"div",18)(38,"p-card"),b(39,Ea,2,0,"ng-template",null,2,x),r(41,"p-table",19),b(42,Ta,7,0,"ng-template",null,2,x)(44,Ia,7,3,"ng-template",null,3,x),o()(),r(46,"p-card"),b(47,Pa,2,0,"ng-template",null,2,x),r(49,"p-table",19),b(50,Na,7,0,"ng-template",null,2,x)(52,Da,7,3,"ng-template",null,3,x),o()()()),e&2&&(c(11),f(n.maintenanceRequests.length),c(5),f(n.getPendingCount()),c(5),f(n.getApprovedCount()),c(5),f(n.getCompletedCount()),c(4),u("value",n.filteredRequests)("paginator",!0)("rows",10),c(11),u("value",n.getStatusBreakdown()),c(8),u("value",n.getPriorityBreakdown()))},dependencies:[P,L,D,k,N,V,R,U,q,H,he,ye,z,ht,W,j,B,O,ve,Ve,Ne],styles:["[_nghost-%COMP%]     .p-card{box-shadow:0 1px 3px #0000001a}"]})};var ka=()=>["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday","All"];function La(a,t){a&1&&(r(0,"h2",18),l(1,"Lab Schedule Report"),o())}function Va(a,t){if(a&1){let e=C();r(0,"p-button",19),_("onClick",function(){m(e);let i=p();return d(i.exportToCSV())}),o(),r(1,"p-button",20),_("onClick",function(){m(e);let i=p();return d(i.printReport())}),o()}}function Ra(a,t){if(a&1){let e=C();r(0,"div",21)(1,"div",22)(2,"label",23),l(3,"Laboratory Filter"),o(),r(4,"p-select",24),S("ngModelChange",function(i){m(e);let s=p();return v(s.selectedLaboratory,i)||(s.selectedLaboratory=i),d(i)}),_("onChange",function(){m(e);let i=p();return d(i.filterSchedules())}),o()(),r(5,"div",22)(6,"label",23),l(7,"Day Filter"),o(),r(8,"p-select",25),S("ngModelChange",function(i){m(e);let s=p();return v(s.selectedDay,i)||(s.selectedDay=i),d(i)}),_("onChange",function(){m(e);let i=p();return d(i.filterSchedules())}),o()(),r(9,"div",26)(10,"p-button",27),_("onClick",function(){m(e);let i=p();return d(i.clearFilters())}),o()()()}if(a&2){let e=p();c(4),y("ngModel",e.selectedLaboratory),u("options",e.laboratories)("showClear",!0),c(4),y("ngModel",e.selectedDay),u("options",E(5,ka))}}function Oa(a,t){a&1&&(r(0,"tr")(1,"th",28),l(2,"Laboratory "),h(3,"p-sortIcon",29),o(),r(4,"th",28),l(5,"Day "),h(6,"p-sortIcon",30),o(),r(7,"th",28),l(8,"Start Time "),h(9,"p-sortIcon",31),o(),r(10,"th",28),l(11,"End Time "),h(12,"p-sortIcon",32),o(),r(13,"th"),l(14,"Instructor"),o(),r(15,"th"),l(16,"Subject"),o()())}function Ba(a,t){if(a&1&&(r(0,"tr")(1,"td"),l(2),o(),r(3,"td"),l(4),o(),r(5,"td"),l(6),o(),r(7,"td"),l(8),o(),r(9,"td"),l(10),o(),r(11,"td"),l(12),o()()),a&2){let e=t.$implicit,n=p();c(2),f(e.laboratoryName||"N/A"),c(2),f(n.formatDay(e.dayOfWeek)),c(2),f(e.startTime||"N/A"),c(2),f(e.endTime||"N/A"),c(2),f(e.instructorName||"N/A"),c(2),f(e.subjectName||"N/A")}}function Aa(a,t){a&1&&(r(0,"tr")(1,"td",33),l(2,"No schedules found matching the selected filters."),o()())}function Ua(a,t){a&1&&(r(0,"h3",34),l(1,"Schedules by Laboratory"),o())}function Fa(a,t){a&1&&(r(0,"tr")(1,"th"),l(2,"Laboratory"),o(),r(3,"th"),l(4,"Schedules"),o(),r(5,"th"),l(6,"Percentage"),o()())}function ja(a,t){if(a&1&&(r(0,"tr")(1,"td"),l(2),o(),r(3,"td"),l(4),o(),r(5,"td"),l(6),o()()),a&2){let e=t.$implicit,n=p();c(2),f(e.laboratory),c(2),f(e.count),c(2),K("",(e.count/n.schedules.length*100).toFixed(2),"%")}}function Wa(a,t){a&1&&(r(0,"h3",34),l(1,"Schedules by Day"),o())}function $a(a,t){a&1&&(r(0,"tr")(1,"th"),l(2,"Day"),o(),r(3,"th"),l(4,"Schedules"),o(),r(5,"th"),l(6,"Percentage"),o()())}function qa(a,t){if(a&1&&(r(0,"tr")(1,"td"),l(2),o(),r(3,"td"),l(4),o(),r(5,"td"),l(6),o()()),a&2){let e=t.$implicit,n=p();c(2),f(e.day),c(2),f(e.count),c(2),K("",(e.count/n.schedules.length*100).toFixed(2),"%")}}var sn=class a{constructor(t,e){this.http=t;this.messageService=e}schedules=[];filteredSchedules=[];laboratories=[];selectedLaboratory="";selectedDay="";daysOfWeek=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];ngOnInit(){this.loadLaboratories(),this.loadSchedules()}loadLaboratories(){this.http.get(`${re.apiUrl}/laboratories`).subscribe({next:t=>{this.laboratories=t},error:t=>{console.error("\u274C Error loading laboratories:",t)}})}loadSchedules(){this.http.get(`${re.apiUrl}/schedules`).subscribe({next:t=>{this.schedules=t,this.filteredSchedules=t},error:t=>{console.error("\u274C Error loading schedules:",t),this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load schedules"})}})}filterSchedules(){this.filteredSchedules=this.schedules.filter(t=>{let e=!this.selectedLaboratory||t.laboratoryId===this.selectedLaboratory,n=!this.selectedDay||this.formatDay(t.dayOfWeek)===this.selectedDay;return e&&n})}clearFilters(){this.selectedLaboratory="",this.selectedDay="",this.filteredSchedules=this.schedules}formatDay(t){return this.daysOfWeek[t]||`Day ${t}`}getLaboratoriesCount(){return new Set(this.schedules.map(t=>t.laboratoryId)).size}getInstructorsCount(){return new Set(this.schedules.map(t=>t.instructorId)).size}getLaboratoryBreakdown(){let t={};return this.schedules.forEach(e=>{let n=e.laboratoryId,i=e.laboratoryName||`Lab ${n}`;t[n]||(t[n]={laboratory:i,count:0}),t[n].count++}),Object.values(t)}getDayBreakdown(){let t={};return this.schedules.forEach(e=>{let n=this.formatDay(e.dayOfWeek);t[n]=(t[n]||0)+1}),Object.entries(t).map(([e,n])=>({day:e,count:n}))}exportToCSV(){let t=["Laboratory","Day","Start Time","End Time","Instructor","Subject"],e=this.filteredSchedules.map(T=>[T.laboratoryName||"N/A",this.formatDay(T.dayOfWeek),T.startTime||"N/A",T.endTime||"N/A",T.instructorName||"N/A",T.subjectName||"N/A"]),n=t.join(",")+`
`;e.forEach(T=>{n+=T.map(le=>`"${le}"`).join(",")+`
`});let i=new Blob([n],{type:"text/csv"}),s=window.URL.createObjectURL(i),g=document.createElement("a");g.href=s,g.download=`schedule-report-${new Date().toISOString().split("T")[0]}.csv`,g.click(),window.URL.revokeObjectURL(s),this.messageService.add({severity:"success",summary:"Exported",detail:"Schedule report exported to CSV"})}printReport(){window.print()}static \u0275fac=function(e){return new(e||a)(w(Ie),w(M))};static \u0275cmp=I({type:a,selectors:[["app-schedule-report"]],features:[F([M])],decls:49,vars:8,consts:[["start",""],["end",""],["header",""],["body",""],["emptymessage",""],["styleClass","mb-4"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4","mb-6"],[1,"p-4","bg-blue-50","rounded-lg"],[1,"text-gray-600","text-sm"],[1,"text-3xl","font-bold","text-blue-600"],[1,"p-4","bg-green-50","rounded-lg"],[1,"text-3xl","font-bold","text-green-600"],[1,"p-4","bg-orange-50","rounded-lg"],[1,"text-3xl","font-bold","text-orange-600"],[1,"mb-4"],["responsiveLayout","scroll",3,"value","paginator","rows"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[3,"value"],[1,"text-2xl","font-bold"],["label","Export to CSV","icon","pi pi-download","severity","success",3,"onClick"],["label","Print","icon","pi pi-print","severity","info",1,"ml-2",3,"onClick"],[1,"flex","gap-4","p-4","flex-wrap"],[1,"flex-1","min-w-[200px]"],[1,"block","text-sm","font-medium","mb-2"],["optionLabel","laboratoryName","optionValue","laboratoryId","placeholder","All Laboratories",3,"ngModelChange","onChange","ngModel","options","showClear"],["placeholder","All Days",3,"ngModelChange","onChange","ngModel","options"],[1,"flex","items-end"],["label","Clear Filters","icon","pi pi-times","severity","secondary",3,"onClick"],["pSortableColumn",""],["field","laboratoryName"],["field","dayOfWeek"],["field","startTime"],["field","endTime"],["colspan","6",1,"text-center","p-4"],[1,"text-lg","font-bold","p-4"]],template:function(e,n){e&1&&(h(0,"p-toast"),r(1,"p-toolbar",5),b(2,La,2,0,"ng-template",null,0,x)(4,Va,2,0,"ng-template",null,1,x),o(),r(6,"div",6)(7,"div",7)(8,"p",8),l(9,"Total Schedules"),o(),r(10,"p",9),l(11),o()(),r(12,"div",10)(13,"p",8),l(14,"Laboratories"),o(),r(15,"p",11),l(16),o()(),r(17,"div",12)(18,"p",8),l(19,"Instructors"),o(),r(20,"p",13),l(21),o()()(),r(22,"p-card",14),b(23,Ra,11,6,"ng-template",null,2,x),r(25,"p-table",15),b(26,Oa,17,0,"ng-template",null,2,x)(28,Ba,13,6,"ng-template",null,3,x)(30,Aa,3,0,"ng-template",null,4,x),o()(),r(32,"div",16)(33,"p-card"),b(34,Ua,2,0,"ng-template",null,2,x),r(36,"p-table",17),b(37,Fa,7,0,"ng-template",null,2,x)(39,ja,7,3,"ng-template",null,3,x),o()(),r(41,"p-card"),b(42,Wa,2,0,"ng-template",null,2,x),r(44,"p-table",17),b(45,$a,7,0,"ng-template",null,2,x)(47,qa,7,3,"ng-template",null,3,x),o()()()),e&2&&(c(11),f(n.schedules.length),c(5),f(n.getLaboratoriesCount()),c(5),f(n.getInstructorsCount()),c(4),u("value",n.filteredSchedules)("paginator",!0)("rows",15),c(11),u("value",n.getLaboratoryBreakdown()),c(8),u("value",n.getDayBreakdown()))},dependencies:[P,L,D,k,N,V,R,U,q,H,he,ye,z,ht,W,j,B,O,Ne],styles:["[_nghost-%COMP%]     .p-card{box-shadow:0 1px 3px #0000001a}"]})};function Ha(a,t){a&1&&(h(0,"i",7),r(1,"span"),l(2,"Asset Report"),o())}function za(a,t){a&1&&(h(0,"i",8),r(1,"span"),l(2,"Maintenance Report"),o())}function Ya(a,t){a&1&&(h(0,"i",9),r(1,"span"),l(2,"Schedule Report"),o())}var cn=class a{constructor(t){this.router=t}static \u0275fac=function(e){return new(e||a)(w(qn))};static \u0275cmp=I({type:a,selectors:[["app-reports"]],decls:23,vars:0,consts:[["header",""],[1,"mb-6"],[1,"text-3xl","font-bold","mb-4"],[1,"text-gray-600"],["value","assets"],["value","maintenance"],["value","schedule"],[1,"pi","pi-box","mr-2"],[1,"pi","pi-wrench","mr-2"],[1,"pi","pi-calendar","mr-2"]],template:function(e,n){e&1&&(r(0,"div",1)(1,"h1",2),l(2,"Reports & Analytics"),o(),r(3,"p",3),l(4,"Access comprehensive reports and analytics for asset management, maintenance, and scheduling."),o()(),r(5,"p-tabs")(6,"p-tablist")(7,"p-tab",4),b(8,Ha,3,0,"ng-template",null,0,x),o(),r(10,"p-tab",5),b(11,za,3,0,"ng-template",null,0,x),o(),r(13,"p-tab",6),b(14,Ya,3,0,"ng-template",null,0,x),o()(),r(16,"p-tabpanels")(17,"p-tabpanel",4),h(18,"app-asset-report"),o(),r(19,"p-tabpanel",5),h(20,"app-maintenance-report"),o(),r(21,"p-tabpanel",6),h(22,"app-schedule-report"),o()()())},dependencies:[P,Hn,N,Ge,li,ai,oi,ii,ri,z,an,ln,sn],styles:["[_nghost-%COMP%]{display:block;padding:1rem}"]})};var _i=`
    .p-progressspinner {
        position: relative;
        margin: 0 auto;
        width: 100px;
        height: 100px;
        display: inline-block;
    }

    .p-progressspinner::before {
        content: '';
        display: block;
        padding-top: 100%;
    }

    .p-progressspinner-spin {
        height: 100%;
        transform-origin: center center;
        width: 100%;
        position: absolute;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        margin: auto;
        animation: p-progressspinner-rotate 2s linear infinite;
    }

    .p-progressspinner-circle {
        stroke-dasharray: 89, 200;
        stroke-dashoffset: 0;
        stroke: dt('progressspinner.colorOne');
        animation:
            p-progressspinner-dash 1.5s ease-in-out infinite,
            p-progressspinner-color 6s ease-in-out infinite;
        stroke-linecap: round;
    }

    @keyframes p-progressspinner-rotate {
        100% {
            transform: rotate(360deg);
        }
    }
    @keyframes p-progressspinner-dash {
        0% {
            stroke-dasharray: 1, 200;
            stroke-dashoffset: 0;
        }
        50% {
            stroke-dasharray: 89, 200;
            stroke-dashoffset: -35px;
        }
        100% {
            stroke-dasharray: 89, 200;
            stroke-dashoffset: -124px;
        }
    }
    @keyframes p-progressspinner-color {
        100%,
        0% {
            stroke: dt('progressspinner.color.one');
        }
        40% {
            stroke: dt('progressspinner.color.two');
        }
        66% {
            stroke: dt('progressspinner.color.three');
        }
        80%,
        90% {
            stroke: dt('progressspinner.color.four');
        }
    }
`;var Qa={root:()=>["p-progressspinner"],spin:"p-progressspinner-spin",circle:"p-progressspinner-circle"},fi=(()=>{class a extends zn{name="progressspinner";style=_i;classes=Qa;static \u0275fac=(()=>{let e;return function(i){return(e||(e=fn(a)))(i||a)}})();static \u0275prov=Lt({token:a,factory:a.\u0275fac})}return a})();var hi=new Dn("PROGRESSSPINNER_INSTANCE"),ot=(()=>{class a extends Kn{$pcProgressSpinner=Vt(hi,{optional:!0,skipSelf:!0})??void 0;bindDirectiveInstance=Vt(wt,{self:!0});styleClass;strokeWidth="2";fill="none";animationDuration="2s";ariaLabel;onAfterViewChecked(){this.bindDirectiveInstance.setAttrs(this.ptms(["host","root"]))}_componentStyle=Vt(fi);static \u0275fac=(()=>{let e;return function(i){return(e||(e=fn(a)))(i||a)}})();static \u0275cmp=I({type:a,selectors:[["p-progressSpinner"],["p-progress-spinner"],["p-progressspinner"]],hostVars:5,hostBindings:function(n,i){n&2&&(hn("aria-label",i.ariaLabel)("role","progressbar")("aria-busy",!0),Ot(i.cn(i.cx("root"),i.styleClass)))},inputs:{styleClass:"styleClass",strokeWidth:"strokeWidth",fill:"fill",animationDuration:"animationDuration",ariaLabel:"ariaLabel"},features:[F([fi,{provide:hi,useExisting:a},{provide:Jn,useExisting:a}]),Bn([wt]),ct],decls:2,vars:10,consts:[["viewBox","25 25 50 50",3,"pBind"],["cx","50","cy","50","r","20","stroke-miterlimit","10",3,"pBind"]],template:function(n,i){n&1&&(Ln(),r(0,"svg",0),h(1,"circle",1),o()),n&2&&(Ot(i.cx("spin")),Rt("animation-duration",i.animationDuration),u("pBind",i.ptm("spin")),c(),Ot(i.cx("circle")),u("pBind",i.ptm("circle")),hn("fill",i.fill)("stroke-width",i.strokeWidth))},dependencies:[P,Bt,wt],encapsulation:2,changeDetection:0})}return a})(),yt=(()=>{class a{static \u0275fac=function(n){return new(n||a)};static \u0275mod=Rn({type:a});static \u0275inj=Nn({imports:[ot,Bt,Bt]})}return a})();var tt=class a{constructor(t){this.http=t}baseApiUrl=re.apiUrl;getAssetReportData(){let t=`${this.baseApiUrl}/reports/assets`;return this.http.get(t)}getAssetReportCSV(){return this.http.get(`${this.baseApiUrl}/reports/assets/export`,{responseType:"blob"})}getMaintenanceReportData(){let t=`${this.baseApiUrl}/reports/maintenance`;return this.http.get(t)}getMaintenanceReportCSV(){return this.http.get(`${this.baseApiUrl}/reports/maintenance/export`,{responseType:"blob"})}getScheduleReportData(){let t=`${this.baseApiUrl}/reports/schedules`;return this.http.get(t)}getScheduleReportCSV(){return this.http.get(`${this.baseApiUrl}/reports/schedules/export`,{responseType:"blob"})}getAssetReportFiltered(t){let e=`${this.baseApiUrl}/reports/assets/filter`,n=new URLSearchParams;return t.category&&n.append("category",t.category),t.status&&n.append("status",t.status),t.location&&n.append("location",t.location),n.toString()&&(e+="?"+n.toString()),this.http.get(e)}getMaintenanceReportFiltered(t){let e=`${this.baseApiUrl}/reports/maintenance/filter`,n=new URLSearchParams;return t.status&&n.append("status",t.status),t.priority&&n.append("priority",t.priority),t.dateFrom&&n.append("dateFrom",t.dateFrom),t.dateTo&&n.append("dateTo",t.dateTo),n.toString()&&(e+="?"+n.toString()),this.http.get(e)}getScheduleReportFiltered(t){let e=`${this.baseApiUrl}/reports/schedules/filter`,n=new URLSearchParams;return t.laboratory&&n.append("laboratory",t.laboratory),t.day&&n.append("day",t.day),t.dateFrom&&n.append("dateFrom",t.dateFrom),t.dateTo&&n.append("dateTo",t.dateTo),n.toString()&&(e+="?"+n.toString()),this.http.get(e)}getDashboardSummary(){let t=`${this.baseApiUrl}/reports/dashboard-summary`;return this.http.get(t)}getDailyPreventiveReport(t,e){let n=`${this.baseApiUrl}/reports/preventive-maintenance/daily?date=${t}&laboratoryId=${e}`;return this.http.get(n)}getMonthlyPreventiveReport(t,e,n){let i=`${this.baseApiUrl}/reports/preventive-maintenance/monthly?month=${t}&year=${e}&laboratoryId=${n}`;return this.http.get(i)}getDailyCorrectiveReport(t,e){let n=`${this.baseApiUrl}/reports/corrective-maintenance/daily?date=${t}`;return e&&(n+=`&priorityLevelId=${e}`),this.http.get(n)}getMonthlyCorrectiveReport(t,e,n){let i=`${this.baseApiUrl}/reports/corrective-maintenance/monthly?month=${t}&year=${e}`;return n&&(i+=`&priorityLevelId=${n}`),this.http.get(i)}getDailyCalibrationReport(t){let e=`${this.baseApiUrl}/reports/calibration-maintenance/daily?date=${t}`;return this.http.get(e)}getMonthlyCalibrationReport(t,e){let n=`${this.baseApiUrl}/reports/calibration-maintenance/monthly?month=${t}&year=${e}`;return this.http.get(n)}static \u0275fac=function(e){return new(e||a)(kn(Ie))};static \u0275prov=Lt({token:a,factory:a.\u0275fac,providedIn:"root"})};var xi=()=>[10,20,30],Ga=()=>({"min-width":"60rem"}),Ja=()=>({"min-width":"80rem"});function Ka(a,t){if(a&1){let e=C();r(0,"div",7)(1,"label",19),l(2,"Date"),o(),r(3,"p-datepicker",20),S("ngModelChange",function(i){m(e);let s=p();return v(s.selectedDate,i)||(s.selectedDate=i),d(i)}),o()()}if(a&2){let e=p();c(3),y("ngModel",e.selectedDate)}}function Xa(a,t){if(a&1){let e=C();r(0,"div",7)(1,"label",21),l(2,"Month"),o(),r(3,"p-select",22),S("ngModelChange",function(i){m(e);let s=p();return v(s.selectedMonth,i)||(s.selectedMonth=i),d(i)}),o()()}if(a&2){let e=p();c(3),y("ngModel",e.selectedMonth),u("options",e.months)}}function Za(a,t){if(a&1){let e=C();r(0,"div",7)(1,"label",23),l(2,"Year"),o(),r(3,"p-select",24),S("ngModelChange",function(i){m(e);let s=p();return v(s.selectedYear,i)||(s.selectedYear=i),d(i)}),o()()}if(a&2){let e=p();c(3),y("ngModel",e.selectedYear),u("options",e.years)}}function el(a,t){if(a&1&&h(0,"p-message",25),a&2){let e=p();u("text",e.errorMessage)}}function tl(a,t){a&1&&(r(0,"div",26),h(1,"p-progressSpinner"),o())}function nl(a,t){a&1&&(r(0,"span",36),l(1,"Daily Report Details"),o())}function il(a,t){if(a&1){let e=C();r(0,"p-button",37),_("onClick",function(){m(e);let i=p(2);return d(i.exportCSV())}),o()}}function rl(a,t){a&1&&(r(0,"tr")(1,"th",38),l(2,"Machine/Equipment/Instrument"),o(),r(3,"th",39),l(4,"Action Taken"),o(),r(5,"th",39),l(6,"Observation"),o()())}function ol(a,t){if(a&1&&(r(0,"tr")(1,"td"),l(2),o(),r(3,"td"),l(4),o(),r(5,"td"),l(6),o()()),a&2){let e=t.$implicit;c(2),f(e.machineEquipmentInstrument||"N/A"),c(2),f(e.actionTaken||"N/A"),c(2),f(e.observation||"N/A")}}function al(a,t){a&1&&(r(0,"tr")(1,"td",40),l(2,"No records found."),o()())}function ll(a,t){if(a&1&&(r(0,"div",27)(1,"div",28)(2,"h3",29),l(3),o(),r(4,"p")(5,"strong"),l(6,"Date:"),o(),l(7),o(),r(8,"p")(9,"strong"),l(10,"Performed By:"),o(),l(11),o(),r(12,"p")(13,"strong"),l(14,"Assisted By:"),o(),l(15),o(),r(16,"p",30)(17,"strong"),l(18,"Recommendations:"),o()(),r(19,"p",5),l(20),o()(),r(21,"p-toolbar",31),b(22,nl,2,0,"ng-template",null,0,x)(24,il,1,0,"ng-template",null,1,x),o(),r(26,"p-table",32),b(27,rl,7,0,"ng-template",33)(28,ol,7,3,"ng-template",34)(29,al,3,0,"ng-template",35),o()()),a&2){let e=p();c(3),f(e.reportData.laboratoryName),c(4),K(" ",e.formatDate(e.reportData.date)),c(4),K(" ",e.reportData.performedBy||"N/A"),c(4),K(" ",e.reportData.assistedBy||"N/A"),c(5),f(e.reportData.recommendations||"No recommendations provided"),c(6),u("value",e.reportData.records)("rows",10)("paginator",!0)("rowsPerPageOptions",E(10,xi))("tableStyle",E(11,Ga))}}function sl(a,t){a&1&&(r(0,"span",36),l(1,"Monthly Report Details"),o())}function cl(a,t){if(a&1){let e=C();r(0,"p-button",37),_("onClick",function(){m(e);let i=p(2);return d(i.exportCSV())}),o()}}function pl(a,t){a&1&&(r(0,"tr")(1,"th"),l(2,"Date"),o(),r(3,"th"),l(4,"Equipment"),o(),r(5,"th"),l(6,"Serial Number"),o(),r(7,"th"),l(8,"Observations"),o(),r(9,"th"),l(10,"Action Taken"),o(),r(11,"th"),l(12,"Remarks"),o()())}function ml(a,t){if(a&1&&(r(0,"tr")(1,"td"),l(2),Fe(3,"date"),o(),r(4,"td"),l(5),o(),r(6,"td"),l(7),o(),r(8,"td"),l(9),o(),r(10,"td"),l(11),o(),r(12,"td"),l(13),o()()),a&2){let e=t.$implicit;c(2),f(je(3,6,e.date,"mediumDate")),c(3),f(e.machineEquipmentInstrument||"N/A"),c(2),f(e.serialNumber||"N/A"),c(2),f(e.observations||"N/A"),c(2),f(e.actionTaken||"N/A"),c(2),f(e.remarks||"N/A")}}function dl(a,t){a&1&&(r(0,"tr")(1,"td",41),l(2,"No records found."),o()())}function ul(a,t){if(a&1&&(r(0,"div",27)(1,"div",28)(2,"h3",29),l(3),o(),r(4,"p")(5,"strong"),l(6,"Period:"),o(),l(7),o(),r(8,"p")(9,"strong"),l(10,"Campus:"),o(),l(11),o(),r(12,"p")(13,"strong"),l(14,"Total Records:"),o(),l(15),o()(),r(16,"p-toolbar",31),b(17,sl,2,0,"ng-template",null,0,x)(19,cl,1,0,"ng-template",null,1,x),o(),r(21,"p-table",32),b(22,pl,13,0,"ng-template",33)(23,ml,14,9,"ng-template",34)(24,dl,3,0,"ng-template",35),o()()),a&2){let e=p();c(3),f(e.reportData.laboratoryName),c(4),ke(" ",e.getMonthName(e.reportData.month)," ",e.reportData.year),c(4),K(" ",e.reportData.campusName||"N/A"),c(4),K(" ",e.reportData.totalRecords||0),c(6),u("value",e.reportData.records)("rows",10)("paginator",!0)("rowsPerPageOptions",E(10,xi))("tableStyle",E(11,Ja))}}function gl(a,t){a&1&&(r(0,"div",42),h(1,"i",43),r(2,"p"),l(3,'Select filters and click "Generate Report" to view data.'),o()())}var pn=class a{constructor(t,e){this.reportService=t;this.http=e;let n=new Date().getFullYear();for(let i=2020;i<=n+5;i++)this.years.push(i)}reportType="daily";selectedDate=new Date;selectedMonth=new Date().getMonth()+1;selectedYear=new Date().getFullYear();laboratoryId="";reportData=null;isLoading=!1;errorMessage="";laboratories=[];reportTypes=[{label:"Daily Report",value:"daily"},{label:"Monthly Report",value:"monthly"}];months=[{label:"January",value:1},{label:"February",value:2},{label:"March",value:3},{label:"April",value:4},{label:"May",value:5},{label:"June",value:6},{label:"July",value:7},{label:"August",value:8},{label:"September",value:9},{label:"October",value:10},{label:"November",value:11},{label:"December",value:12}];years=[];ngOnInit(){this.loadLaboratories()}loadLaboratories(){let t=`${re.apiUrl}/laboratories`;this.http.get(t).subscribe({next:e=>{this.laboratories=e},error:e=>{console.error("\u274C Error loading laboratories:",e)}})}onReportTypeChange(){this.reportData=null,this.errorMessage=""}isFormValid(){return this.laboratoryId.trim().length>0}generateReport(){if(this.isLoading=!0,this.errorMessage="",this.reportData=null,this.reportType==="daily"){let t=this.formatDateToString(this.selectedDate);this.reportService.getDailyPreventiveReport(t,this.laboratoryId).subscribe({next:e=>{this.reportData=e,this.isLoading=!1},error:e=>{this.errorMessage=e.error?.message||"Failed to generate daily report",this.isLoading=!1,console.error("\u274C Error loading daily report:",e)}})}else this.reportService.getMonthlyPreventiveReport(this.selectedMonth,this.selectedYear,this.laboratoryId).subscribe({next:t=>{this.reportData=t,this.isLoading=!1},error:t=>{this.errorMessage=t.error?.message||"Failed to generate monthly report",this.isLoading=!1,console.error("\u274C Error loading monthly report:",t)}})}formatDateToString(t){let e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0");return`${e}-${n}-${i}`}formatDate(t){return new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}getMonthName(t){let e=this.months.find(n=>n.value===t);return e?e.label:"Unknown"}exportCSV(){if(!this.reportData||!this.reportData.records){console.warn("No data to export");return}let t="",e="";this.reportType==="daily"?(t=`Machine/Equipment,Action Taken,Observation
`,t+=this.reportData.records.map(g=>`"${g.machineEquipmentInstrument}","${g.actionTaken}","${g.observation}"`).join(`
`),e=`preventive-daily-${this.formatDateToString(this.selectedDate)}.csv`):(t=`Date,Equipment,Serial Number,Observations,Action Taken,Remarks
`,t+=this.reportData.records.map(g=>`"${new Date(g.date).toISOString().split("T")[0]}","${g.machineEquipmentInstrument}","${g.serialNumber}","${g.observations}","${g.actionTaken}","${g.remarks}"`).join(`
`),e=`preventive-monthly-${this.selectedYear}-${this.selectedMonth}.csv`);let n=new Blob([t],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a"),s=URL.createObjectURL(n);i.setAttribute("href",s),i.setAttribute("download",e),i.click(),URL.revokeObjectURL(s)}static \u0275fac=function(e){return new(e||a)(w(tt),w(Ie))};static \u0275cmp=I({type:a,selectors:[["app-preventive-report"]],decls:26,vars:15,consts:[["start",""],["end",""],[1,"card"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-2xl","font-bold","mb-1"],[1,"text-muted-color"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","mb-4","p-4","bg-surface-50","dark:bg-surface-800","rounded"],[1,"flex","flex-col","gap-2"],["for","reportType",1,"font-semibold"],["optionLabel","label","optionValue","value","placeholder","Select report type",3,"ngModelChange","onChange","ngModel","options"],["class","flex flex-col gap-2",4,"ngIf"],["for","laboratoryId",1,"font-semibold"],["optionLabel","laboratoryName","optionValue","laboratoryId","placeholder","Select laboratory",3,"ngModelChange","ngModel","options","filter"],[1,"flex","items-end"],["label","Generate Report","icon","pi pi-chart-bar",3,"onClick","disabled","loading"],["severity","error","styleClass","mb-4 w-full",3,"text",4,"ngIf"],["class","flex justify-center items-center py-8",4,"ngIf"],["class","mt-4",4,"ngIf"],["class","text-center py-8 text-muted-color",4,"ngIf"],["for","selectedDate",1,"font-semibold"],["inputId","selectedDate","placeholder","Select date","dateFormat","yy-mm-dd",3,"ngModelChange","ngModel"],["for","selectedMonth",1,"font-semibold"],["optionLabel","label","optionValue","value","placeholder","Select month",3,"ngModelChange","ngModel","options"],["for","selectedYear",1,"font-semibold"],["placeholder","Select year",3,"ngModelChange","ngModel","options"],["severity","error","styleClass","mb-4 w-full",3,"text"],[1,"flex","justify-center","items-center","py-8"],[1,"mt-4"],[1,"mb-4","p-4","bg-surface-100","dark:bg-surface-700","rounded"],[1,"text-xl","font-bold","mb-2"],[1,"mt-2"],["styleClass","mb-2"],[3,"value","rows","paginator","rowsPerPageOptions","tableStyle"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"font-semibold"],["label","Export CSV","icon","pi pi-upload","size","small",3,"onClick"],[2,"width","30%"],[2,"width","35%"],["colspan","3",1,"text-center","py-4"],["colspan","6",1,"text-center","py-4"],[1,"text-center","py-8","text-muted-color"],[1,"pi","pi-info-circle","text-4xl","mb-3"]],template:function(e,n){e&1&&(r(0,"div",2)(1,"div",3)(2,"div")(3,"h2",4),l(4,"Preventive Maintenance Report"),o(),r(5,"p",5),l(6,"Generate daily or monthly preventive maintenance reports by laboratory."),o()()(),r(7,"div",6)(8,"div",7)(9,"label",8),l(10,"Report Type"),o(),r(11,"p-select",9),S("ngModelChange",function(s){return v(n.reportType,s)||(n.reportType=s),s}),_("onChange",function(){return n.onReportTypeChange()}),o()(),b(12,Ka,4,1,"div",10)(13,Xa,4,2,"div",10)(14,Za,4,2,"div",10),r(15,"div",7)(16,"label",11),l(17,"Laboratory"),o(),r(18,"p-select",12),S("ngModelChange",function(s){return v(n.laboratoryId,s)||(n.laboratoryId=s),s}),o()(),r(19,"div",13)(20,"p-button",14),_("onClick",function(){return n.generateReport()}),o()()(),b(21,el,1,1,"p-message",15)(22,tl,2,0,"div",16)(23,ll,30,12,"div",17)(24,ul,25,12,"div",17)(25,gl,4,0,"div",18),o()),e&2&&(c(11),y("ngModel",n.reportType),u("options",n.reportTypes),c(),u("ngIf",n.reportType==="daily"),c(),u("ngIf",n.reportType==="monthly"),c(),u("ngIf",n.reportType==="monthly"),c(4),y("ngModel",n.laboratoryId),u("options",n.laboratories)("filter",!0),c(2),u("disabled",!n.isFormValid()||n.isLoading)("loading",n.isLoading),c(),u("ngIf",n.errorMessage),c(),u("ngIf",n.isLoading),c(),u("ngIf",n.reportData&&n.reportType==="daily"&&!n.isLoading),c(),u("ngIf",n.reportData&&n.reportType==="monthly"&&!n.isLoading),c(),u("ngIf",!n.reportData&&!n.isLoading&&!n.errorMessage))},dependencies:[P,Te,L,D,k,B,O,$,N,V,Ne,gt,R,U,Ge,ve,he,ye,A,yt,ot,ft,_t,z,mt],encapsulation:2})};var yi=()=>[10,20,30],_l=()=>({"min-width":"90rem"}),fl=()=>({"min-width":"100rem"});function hl(a,t){if(a&1){let e=C();r(0,"div",7)(1,"label",19),l(2,"Date"),o(),r(3,"p-datepicker",20),S("ngModelChange",function(i){m(e);let s=p();return v(s.selectedDate,i)||(s.selectedDate=i),d(i)}),o()()}if(a&2){let e=p();c(3),y("ngModel",e.selectedDate)}}function bl(a,t){if(a&1){let e=C();r(0,"div",7)(1,"label",21),l(2,"Month"),o(),r(3,"p-select",22),S("ngModelChange",function(i){m(e);let s=p();return v(s.selectedMonth,i)||(s.selectedMonth=i),d(i)}),o()()}if(a&2){let e=p();c(3),y("ngModel",e.selectedMonth),u("options",e.months)}}function Cl(a,t){if(a&1){let e=C();r(0,"div",7)(1,"label",23),l(2,"Year"),o(),r(3,"p-select",24),S("ngModelChange",function(i){m(e);let s=p();return v(s.selectedYear,i)||(s.selectedYear=i),d(i)}),o()()}if(a&2){let e=p();c(3),y("ngModel",e.selectedYear),u("options",e.years)}}function xl(a,t){if(a&1&&h(0,"p-message",25),a&2){let e=p();u("text",e.errorMessage)}}function yl(a,t){a&1&&(r(0,"div",26),h(1,"p-progressSpinner"),o())}function vl(a,t){a&1&&(r(0,"span",35),l(1,"Daily Report Details"),o())}function Sl(a,t){if(a&1){let e=C();r(0,"p-button",36),_("onClick",function(){m(e);let i=p(2);return d(i.exportCSV())}),o()}}function wl(a,t){a&1&&(r(0,"tr")(1,"th"),l(2,"Date"),o(),r(3,"th"),l(4,"Equipment"),o(),r(5,"th"),l(6,"Serial No."),o(),r(7,"th"),l(8,"Laboratory"),o(),r(9,"th"),l(10,"Problem"),o(),r(11,"th"),l(12,"Action Taken"),o(),r(13,"th"),l(14,"Parts Replaced"),o(),r(15,"th"),l(16,"Completed By"),o(),r(17,"th"),l(18,"Priority"),o(),r(19,"th"),l(20,"Downtime"),o()())}function Ml(a,t){if(a&1&&(r(0,"tr")(1,"td"),l(2),Fe(3,"date"),o(),r(4,"td"),l(5),o(),r(6,"td"),l(7),o(),r(8,"td"),l(9),o(),r(10,"td"),l(11),o(),r(12,"td"),l(13),o(),r(14,"td"),l(15),o(),r(16,"td"),l(17),o(),r(18,"td"),h(19,"p-tag",37),o(),r(20,"td"),l(21),o()()),a&2){let e=t.$implicit,n=p(2);c(2),f(je(3,11,e.date,"shortDate")),c(3),f(e.equipmentName||"N/A"),c(2),f(e.serialNumber||"N/A"),c(2),f(e.laboratoryLocation||"N/A"),c(2),f(e.problemReported||"N/A"),c(2),f(e.actionTaken||"N/A"),c(2),f(e.partsReplaced||"None"),c(2),f(e.completedBy||"N/A"),c(2),u("value",e.priorityLevel)("severity",n.getPrioritySeverity(e.priorityLevel)),c(2),f(e.downtime||"N/A")}}function El(a,t){a&1&&(r(0,"tr")(1,"td",38),l(2,"No records found."),o()())}function Tl(a,t){if(a&1&&(r(0,"div",27)(1,"div",28)(2,"h3",29),l(3,"Daily Corrective Maintenance Report"),o(),r(4,"p")(5,"strong"),l(6,"Date:"),o(),l(7),o(),r(8,"p")(9,"strong"),l(10,"Total Records:"),o(),l(11),o()(),r(12,"p-toolbar",30),b(13,vl,2,0,"ng-template",null,0,x)(15,Sl,1,0,"ng-template",null,1,x),o(),r(17,"p-table",31),b(18,wl,21,0,"ng-template",32)(19,Ml,22,14,"ng-template",33)(20,El,3,0,"ng-template",34),o()()),a&2){let e=p();c(7),K(" ",e.formatDate(e.selectedDate)),c(4),K(" ",(e.reportData.records==null?null:e.reportData.records.length)||0),c(6),u("value",e.reportData.records)("rows",10)("paginator",!0)("rowsPerPageOptions",E(7,yi))("tableStyle",E(8,_l))}}function Il(a,t){if(a&1&&(r(0,"p")(1,"strong"),l(2,"Generated:"),o(),l(3),Fe(4,"date"),o()),a&2){let e=p(2);c(3),K(" ",je(4,1,e.reportData.generatedDate,"medium"))}}function Pl(a,t){if(a&1&&(r(0,"div",43)(1,"div",44)(2,"h4",45),l(3,"Total Repairs"),o(),r(4,"p",46),l(5),o()(),r(6,"div",47)(7,"h4",48),l(8,"Completed"),o(),r(9,"p",49),l(10),o()(),r(11,"div",50)(12,"h4",51),l(13,"Avg Downtime"),o(),r(14,"p",52),l(15),o()(),r(16,"div",53)(17,"h4",54),l(18,"Completion Rate"),o(),r(19,"p",55),l(20),o()()()),a&2){let e=p(2);c(5),f(e.reportData.summary.totalRepairs),c(5),f(e.reportData.summary.completedRepairs),c(5),K("",e.reportData.summary.averageDowntimeHours,"h"),c(5),K("",e.getCompletionRate(),"%")}}function Nl(a,t){if(a&1&&(r(0,"div",60)(1,"p",61),l(2),o(),r(3,"p",62),l(4),o()()),a&2){let e=t.$implicit;c(2),f(e.priorityLevel),c(2),f(e.count)}}function Dl(a,t){if(a&1&&(r(0,"div",56)(1,"h4",57),l(2,"Breakdown by Priority"),o(),r(3,"div",58),b(4,Nl,5,2,"div",59),o()()),a&2){let e=p(2);c(4),u("ngForOf",e.reportData.summary.byPriority)}}function kl(a,t){if(a&1&&(r(0,"div",60)(1,"p",61),l(2),o(),r(3,"p",62),l(4),o()()),a&2){let e=t.$implicit;c(2),f(e.laboratoryName),c(2),f(e.count)}}function Ll(a,t){if(a&1&&(r(0,"div",56)(1,"h4",57),l(2,"Breakdown by Laboratory"),o(),r(3,"div",58),b(4,kl,5,2,"div",59),o()()),a&2){let e=p(2);c(4),u("ngForOf",e.reportData.summary.byLaboratory)}}function Vl(a,t){a&1&&(r(0,"span",35),l(1,"Detailed Records"),o())}function Rl(a,t){if(a&1){let e=C();r(0,"p-button",36),_("onClick",function(){m(e);let i=p(2);return d(i.exportCSV())}),o()}}function Ol(a,t){a&1&&(r(0,"tr")(1,"th"),l(2,"Date"),o(),r(3,"th"),l(4,"Equipment"),o(),r(5,"th"),l(6,"Serial No."),o(),r(7,"th"),l(8,"Laboratory"),o(),r(9,"th"),l(10,"Problem"),o(),r(11,"th"),l(12,"Action Taken"),o(),r(13,"th"),l(14,"Parts Replaced"),o(),r(15,"th"),l(16,"Remarks"),o(),r(17,"th"),l(18,"Completed By"),o(),r(19,"th"),l(20,"Priority"),o(),r(21,"th"),l(22,"Downtime"),o()())}function Bl(a,t){if(a&1&&(r(0,"tr")(1,"td"),l(2),Fe(3,"date"),o(),r(4,"td"),l(5),o(),r(6,"td"),l(7),o(),r(8,"td"),l(9),o(),r(10,"td"),l(11),o(),r(12,"td"),l(13),o(),r(14,"td"),l(15),o(),r(16,"td"),l(17),o(),r(18,"td"),l(19),o(),r(20,"td"),h(21,"p-tag",37),o(),r(22,"td"),l(23),o()()),a&2){let e=t.$implicit,n=p(2);c(2),f(je(3,12,e.date,"shortDate")),c(3),f(e.equipmentName||"N/A"),c(2),f(e.serialNumber||"N/A"),c(2),f(e.laboratoryLocation||"N/A"),c(2),f(e.problemReported||"N/A"),c(2),f(e.actionTaken||"N/A"),c(2),f(e.partsReplaced||"None"),c(2),f(e.remarks||"N/A"),c(2),f(e.completedBy||"N/A"),c(2),u("value",e.priorityLevel)("severity",n.getPrioritySeverity(e.priorityLevel)),c(2),f(e.downtime||"N/A")}}function Al(a,t){a&1&&(r(0,"tr")(1,"td",63),l(2,"No records found."),o()())}function Ul(a,t){if(a&1&&(r(0,"div",27)(1,"div",28)(2,"h3",29),l(3),o(),r(4,"div",39)(5,"div")(6,"p")(7,"strong"),l(8,"Period:"),o(),l(9),o(),r(10,"p")(11,"strong"),l(12,"Campus:"),o(),l(13),o(),b(14,Il,5,4,"p",40),o(),r(15,"div")(16,"p")(17,"strong"),l(18,"Total Records:"),o(),l(19),o()()()(),b(20,Pl,21,4,"div",41)(21,Dl,5,1,"div",42)(22,Ll,5,1,"div",42),r(23,"p-toolbar",30),b(24,Vl,2,0,"ng-template",null,0,x)(26,Rl,1,0,"ng-template",null,1,x),o(),r(28,"p-table",31),b(29,Ol,23,0,"ng-template",32)(30,Bl,24,15,"ng-template",33)(31,Al,3,0,"ng-template",34),o()()),a&2){let e=p();c(3),f(e.reportData.reportTitle||"Monthly Corrective Maintenance Report"),c(6),ke(" ",e.getMonthName(e.reportData.reportMonth||e.selectedMonth)," ",e.reportData.reportYear||e.selectedYear),c(4),K(" ",e.reportData.campusName||"N/A"),c(),u("ngIf",e.reportData.generatedDate),c(5),K(" ",e.reportData.totalRecords||(e.reportData.records==null?null:e.reportData.records.length)||0),c(),u("ngIf",e.reportData.summary),c(),u("ngIf",e.reportData.summary==null?null:e.reportData.summary.byPriority),c(),u("ngIf",e.reportData.summary==null?null:e.reportData.summary.byLaboratory),c(6),u("value",e.reportData.records)("rows",10)("paginator",!0)("rowsPerPageOptions",E(14,yi))("tableStyle",E(15,fl))}}function Fl(a,t){a&1&&(r(0,"div",64),h(1,"i",65),r(2,"p"),l(3,'Select filters and click "Generate Report" to view data.'),o()())}var mn=class a{constructor(t,e){this.reportService=t;this.http=e;let n=new Date().getFullYear();for(let i=2020;i<=n+5;i++)this.years.push(i)}reportType="daily";selectedDate=new Date;selectedMonth=new Date().getMonth()+1;selectedYear=new Date().getFullYear();priorityLevelId="";reportData=null;isLoading=!1;errorMessage="";priorityLevels=[];reportTypes=[{label:"Daily Report",value:"daily"},{label:"Monthly Report",value:"monthly"}];months=[{label:"January",value:1},{label:"February",value:2},{label:"March",value:3},{label:"April",value:4},{label:"May",value:5},{label:"June",value:6},{label:"July",value:7},{label:"August",value:8},{label:"September",value:9},{label:"October",value:10},{label:"November",value:11},{label:"December",value:12}];years=[];ngOnInit(){this.loadPriorityLevels()}loadPriorityLevels(){let t=`${re.apiUrl}/maintenance/priority-levels`;this.http.get(t).subscribe({next:e=>{this.priorityLevels=e},error:e=>{console.error("\u274C Error loading priority levels:",e)}})}onReportTypeChange(){this.reportData=null,this.errorMessage=""}generateReport(){if(this.isLoading=!0,this.errorMessage="",this.reportData=null,this.reportType==="daily"){let t=this.formatDateToString(this.selectedDate);this.reportService.getDailyCorrectiveReport(t,this.priorityLevelId||void 0).subscribe({next:e=>{this.reportData=e,this.isLoading=!1},error:e=>{this.errorMessage=e.error?.message||"Failed to generate daily report",this.isLoading=!1,console.error("\u274C Error loading daily report:",e)}})}else this.reportService.getMonthlyCorrectiveReport(this.selectedMonth,this.selectedYear,this.priorityLevelId||void 0).subscribe({next:t=>{this.reportData=t,this.isLoading=!1},error:t=>{this.errorMessage=t.error?.message||"Failed to generate monthly report",this.isLoading=!1,console.error("\u274C Error loading monthly report:",t)}})}formatDateToString(t){let e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0");return`${e}-${n}-${i}`}formatDate(t){return new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}getMonthName(t){let e=this.months.find(n=>n.value===t);return e?e.label:"Unknown"}getCompletionRate(){if(!this.reportData?.summary)return 0;let{totalRepairs:t,completedRepairs:e}=this.reportData.summary;return t===0?0:Math.round(e/t*100)}getPrioritySeverity(t){let e=t?.toLowerCase()||"";return e.includes("high")||e.includes("critical")||e.includes("urgent")?"danger":e.includes("medium")||e.includes("moderate")?"warn":e.includes("low")?"success":"secondary"}exportCSV(){if(!this.reportData||!this.reportData.records){console.warn("No data to export");return}let t="",e="";this.reportType==="daily"?(t=`Date,Equipment,Serial No,Laboratory,Problem,Action Taken,Parts Replaced,Completed By,Priority,Downtime
`,t+=this.reportData.records.map(g=>`"${new Date(g.date).toISOString().split("T")[0]}","${g.equipmentName}","${g.serialNumber}","${g.laboratoryLocation}","${g.problemReported}","${g.actionTaken}","${g.partsReplaced}","${g.completedBy}","${g.priorityLevel}","${g.downtime}"`).join(`
`),e=`corrective-daily-${this.formatDateToString(this.selectedDate)}.csv`):(t=`Date,Equipment,Serial No,Laboratory,Problem,Action Taken,Parts Replaced,Remarks,Completed By,Requested By,Priority,Downtime
`,t+=this.reportData.records.map(g=>`"${new Date(g.date).toISOString().split("T")[0]}","${g.equipmentName}","${g.serialNumber}","${g.laboratoryLocation}","${g.problemReported}","${g.actionTaken}","${g.partsReplaced}","${g.remarks}","${g.completedBy}","${g.requestedBy}","${g.priorityLevel}","${g.downtime}"`).join(`
`),e=`corrective-monthly-${this.selectedYear}-${this.selectedMonth}.csv`);let n=new Blob([t],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a"),s=URL.createObjectURL(n);i.setAttribute("href",s),i.setAttribute("download",e),i.click(),URL.revokeObjectURL(s)}static \u0275fac=function(e){return new(e||a)(w(tt),w(Ie))};static \u0275cmp=I({type:a,selectors:[["app-corrective-report"]],decls:26,vars:16,consts:[["start",""],["end",""],[1,"card"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-2xl","font-bold","mb-1"],[1,"text-muted-color"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","mb-4","p-4","bg-surface-50","dark:bg-surface-800","rounded"],[1,"flex","flex-col","gap-2"],["for","reportType",1,"font-semibold"],["optionLabel","label","optionValue","value","placeholder","Select report type",3,"ngModelChange","onChange","ngModel","options"],["class","flex flex-col gap-2",4,"ngIf"],["for","priorityLevelId",1,"font-semibold"],["optionLabel","priorityLevelName","optionValue","priorityLevelId","placeholder","All Priorities",3,"ngModelChange","ngModel","options","filter","showClear"],[1,"flex","items-end"],["label","Generate Report","icon","pi pi-chart-bar",3,"onClick","disabled","loading"],["severity","error","styleClass","mb-4 w-full",3,"text",4,"ngIf"],["class","flex justify-center items-center py-8",4,"ngIf"],["class","mt-4",4,"ngIf"],["class","text-center py-8 text-muted-color",4,"ngIf"],["for","selectedDate",1,"font-semibold"],["inputId","selectedDate","placeholder","Select date","dateFormat","yy-mm-dd",3,"ngModelChange","ngModel"],["for","selectedMonth",1,"font-semibold"],["optionLabel","label","optionValue","value","placeholder","Select month",3,"ngModelChange","ngModel","options"],["for","selectedYear",1,"font-semibold"],["placeholder","Select year",3,"ngModelChange","ngModel","options"],["severity","error","styleClass","mb-4 w-full",3,"text"],[1,"flex","justify-center","items-center","py-8"],[1,"mt-4"],[1,"mb-4","p-4","bg-surface-100","dark:bg-surface-700","rounded"],[1,"text-xl","font-bold","mb-2"],["styleClass","mb-2"],[3,"value","rows","paginator","rowsPerPageOptions","tableStyle"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"font-semibold"],["label","Export CSV","icon","pi pi-upload","size","small",3,"onClick"],[3,"value","severity"],["colspan","10",1,"text-center","py-4"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-2"],[4,"ngIf"],["class","grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",4,"ngIf"],["class","mb-4",4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","mb-4"],[1,"p-4","bg-blue-50","dark:bg-blue-900","rounded"],[1,"text-sm","font-semibold","text-blue-700","dark:text-blue-300"],[1,"text-2xl","font-bold","text-blue-900","dark:text-blue-100"],[1,"p-4","bg-green-50","dark:bg-green-900","rounded"],[1,"text-sm","font-semibold","text-green-700","dark:text-green-300"],[1,"text-2xl","font-bold","text-green-900","dark:text-green-100"],[1,"p-4","bg-orange-50","dark:bg-orange-900","rounded"],[1,"text-sm","font-semibold","text-orange-700","dark:text-orange-300"],[1,"text-2xl","font-bold","text-orange-900","dark:text-orange-100"],[1,"p-4","bg-purple-50","dark:bg-purple-900","rounded"],[1,"text-sm","font-semibold","text-purple-700","dark:text-purple-300"],[1,"text-2xl","font-bold","text-purple-900","dark:text-purple-100"],[1,"mb-4"],[1,"font-semibold","mb-2"],[1,"grid","grid-cols-2","md:grid-cols-4","gap-2"],["class","p-3 bg-surface-50 dark:bg-surface-800 rounded",4,"ngFor","ngForOf"],[1,"p-3","bg-surface-50","dark:bg-surface-800","rounded"],[1,"text-sm","text-muted-color"],[1,"text-lg","font-bold"],["colspan","11",1,"text-center","py-4"],[1,"text-center","py-8","text-muted-color"],[1,"pi","pi-info-circle","text-4xl","mb-3"]],template:function(e,n){e&1&&(r(0,"div",2)(1,"div",3)(2,"div")(3,"h2",4),l(4,"Corrective Maintenance Report"),o(),r(5,"p",5),l(6,"Generate daily or monthly corrective maintenance reports with priority filtering."),o()()(),r(7,"div",6)(8,"div",7)(9,"label",8),l(10,"Report Type"),o(),r(11,"p-select",9),S("ngModelChange",function(s){return v(n.reportType,s)||(n.reportType=s),s}),_("onChange",function(){return n.onReportTypeChange()}),o()(),b(12,hl,4,1,"div",10)(13,bl,4,2,"div",10)(14,Cl,4,2,"div",10),r(15,"div",7)(16,"label",11),l(17,"Priority Level (Optional)"),o(),r(18,"p-select",12),S("ngModelChange",function(s){return v(n.priorityLevelId,s)||(n.priorityLevelId=s),s}),o()(),r(19,"div",13)(20,"p-button",14),_("onClick",function(){return n.generateReport()}),o()()(),b(21,xl,1,1,"p-message",15)(22,yl,2,0,"div",16)(23,Tl,21,9,"div",17)(24,Ul,32,16,"div",17)(25,Fl,4,0,"div",18),o()),e&2&&(c(11),y("ngModel",n.reportType),u("options",n.reportTypes),c(),u("ngIf",n.reportType==="daily"),c(),u("ngIf",n.reportType==="monthly"),c(),u("ngIf",n.reportType==="monthly"),c(4),y("ngModel",n.priorityLevelId),u("options",n.priorityLevels)("filter",!0)("showClear",!0),c(2),u("disabled",n.isLoading)("loading",n.isLoading),c(),u("ngIf",n.errorMessage),c(),u("ngIf",n.isLoading),c(),u("ngIf",n.reportData&&n.reportType==="daily"&&!n.isLoading),c(),u("ngIf",n.reportData&&n.reportType==="monthly"&&!n.isLoading),c(),u("ngIf",!n.reportData&&!n.isLoading&&!n.errorMessage))},dependencies:[P,pt,Te,L,D,k,B,O,$,N,V,Ne,gt,R,U,Ge,ve,Ve,he,ye,A,yt,ot,ft,_t,z,mt],encapsulation:2})};var vi=()=>[10,20,30],jl=()=>({"min-width":"80rem"}),Wl=()=>({"min-width":"90rem"});function $l(a,t){if(a&1){let e=C();r(0,"div",7)(1,"label",17),l(2,"Date"),o(),r(3,"p-datepicker",18),S("ngModelChange",function(i){m(e);let s=p();return v(s.selectedDate,i)||(s.selectedDate=i),d(i)}),o()()}if(a&2){let e=p();c(3),y("ngModel",e.selectedDate)}}function ql(a,t){if(a&1){let e=C();r(0,"div",7)(1,"label",19),l(2,"Month"),o(),r(3,"p-select",20),S("ngModelChange",function(i){m(e);let s=p();return v(s.selectedMonth,i)||(s.selectedMonth=i),d(i)}),o()()}if(a&2){let e=p();c(3),y("ngModel",e.selectedMonth),u("options",e.months)}}function Hl(a,t){if(a&1){let e=C();r(0,"div",7)(1,"label",21),l(2,"Year"),o(),r(3,"p-select",22),S("ngModelChange",function(i){m(e);let s=p();return v(s.selectedYear,i)||(s.selectedYear=i),d(i)}),o()()}if(a&2){let e=p();c(3),y("ngModel",e.selectedYear),u("options",e.years)}}function zl(a,t){if(a&1&&h(0,"p-message",23),a&2){let e=p();u("text",e.errorMessage)}}function Yl(a,t){a&1&&(r(0,"div",24),h(1,"p-progressSpinner"),o())}function Ql(a,t){a&1&&(r(0,"span",33),l(1,"Daily Report Details"),o())}function Gl(a,t){if(a&1){let e=C();r(0,"p-button",34),_("onClick",function(){m(e);let i=p(2);return d(i.exportCSV())}),o()}}function Jl(a,t){a&1&&(r(0,"tr")(1,"th"),l(2,"Date"),o(),r(3,"th"),l(4,"Equipment Name"),o(),r(5,"th"),l(6,"Serial Number"),o(),r(7,"th"),l(8,"Calibration Type"),o(),r(9,"th"),l(10,"Result"),o(),r(11,"th"),l(12,"Performed By"),o(),r(13,"th"),l(14,"Remarks"),o()())}function Kl(a,t){if(a&1&&(r(0,"tr")(1,"td"),l(2),Fe(3,"date"),o(),r(4,"td"),l(5),o(),r(6,"td"),l(7),o(),r(8,"td"),l(9),o(),r(10,"td"),h(11,"p-tag",35),o(),r(12,"td"),l(13),o(),r(14,"td"),l(15),o()()),a&2){let e=t.$implicit,n=p(2);c(2),f(je(3,8,e.date,"shortDate")),c(3),f(e.equipmentName||"N/A"),c(2),f(e.serialNumber||"N/A"),c(2),f(e.calibrationType||"N/A"),c(2),u("value",e.result)("severity",n.getResultSeverity(e.result)),c(2),f(e.performedBy||"N/A"),c(2),f(e.remarks||"N/A")}}function Xl(a,t){a&1&&(r(0,"tr")(1,"td",36),l(2,"No records found."),o()())}function Zl(a,t){if(a&1&&(r(0,"div",25)(1,"div",26)(2,"h3",27),l(3,"Daily Calibration Report"),o(),r(4,"p")(5,"strong"),l(6,"Date:"),o(),l(7),o(),r(8,"p")(9,"strong"),l(10,"Total Records:"),o(),l(11),o()(),r(12,"p-toolbar",28),b(13,Ql,2,0,"ng-template",null,0,x)(15,Gl,1,0,"ng-template",null,1,x),o(),r(17,"p-table",29),b(18,Jl,15,0,"ng-template",30)(19,Kl,16,11,"ng-template",31)(20,Xl,3,0,"ng-template",32),o()()),a&2){let e=p();c(7),K(" ",e.formatDate(e.selectedDate)),c(4),K(" ",(e.reportData.records==null?null:e.reportData.records.length)||0),c(6),u("value",e.reportData.records)("rows",10)("paginator",!0)("rowsPerPageOptions",E(7,vi))("tableStyle",E(8,jl))}}function es(a,t){a&1&&(r(0,"span",33),l(1,"Monthly Report Details"),o())}function ts(a,t){if(a&1){let e=C();r(0,"p-button",34),_("onClick",function(){m(e);let i=p(2);return d(i.exportCSV())}),o()}}function ns(a,t){a&1&&(r(0,"tr")(1,"th"),l(2,"Date"),o(),r(3,"th"),l(4,"Equipment Name"),o(),r(5,"th"),l(6,"Serial Number"),o(),r(7,"th"),l(8,"Calibration Type"),o(),r(9,"th"),l(10,"Result"),o(),r(11,"th"),l(12,"Performed By"),o(),r(13,"th"),l(14,"Next Calibration"),o(),r(15,"th"),l(16,"Remarks"),o()())}function is(a,t){if(a&1&&(r(0,"tr")(1,"td"),l(2),Fe(3,"date"),o(),r(4,"td"),l(5),o(),r(6,"td"),l(7),o(),r(8,"td"),l(9),o(),r(10,"td"),h(11,"p-tag",35),o(),r(12,"td"),l(13),o(),r(14,"td"),l(15),Fe(16,"date"),o(),r(17,"td"),l(18),o()()),a&2){let e=t.$implicit,n=p(2);c(2),f(je(3,9,e.date,"shortDate")),c(3),f(e.equipmentName||"N/A"),c(2),f(e.serialNumber||"N/A"),c(2),f(e.calibrationType||"N/A"),c(2),u("value",e.result)("severity",n.getResultSeverity(e.result)),c(2),f(e.performedBy||"N/A"),c(2),f(je(16,12,e.nextCalibrationDate,"shortDate")),c(3),f(e.remarks||"N/A")}}function rs(a,t){a&1&&(r(0,"tr")(1,"td",37),l(2,"No records found."),o()())}function os(a,t){if(a&1&&(r(0,"div",25)(1,"div",26)(2,"h3",27),l(3,"Monthly Calibration Report"),o(),r(4,"p")(5,"strong"),l(6,"Period:"),o(),l(7),o(),r(8,"p")(9,"strong"),l(10,"Total Records:"),o(),l(11),o()(),r(12,"p-toolbar",28),b(13,es,2,0,"ng-template",null,0,x)(15,ts,1,0,"ng-template",null,1,x),o(),r(17,"p-table",29),b(18,ns,17,0,"ng-template",30)(19,is,19,15,"ng-template",31)(20,rs,3,0,"ng-template",32),o()()),a&2){let e=p();c(7),ke(" ",e.getMonthName(e.selectedMonth)," ",e.selectedYear),c(4),K(" ",(e.reportData.records==null?null:e.reportData.records.length)||0),c(6),u("value",e.reportData.records)("rows",10)("paginator",!0)("rowsPerPageOptions",E(8,vi))("tableStyle",E(9,Wl))}}function as(a,t){a&1&&(r(0,"div",38),h(1,"i",39),r(2,"p"),l(3,'Select filters and click "Generate Report" to view data.'),o()())}var dn=class a{constructor(t){this.reportService=t;let e=new Date().getFullYear();for(let n=2020;n<=e+5;n++)this.years.push(n)}reportType="daily";selectedDate=new Date;selectedMonth=new Date().getMonth()+1;selectedYear=new Date().getFullYear();reportData=null;isLoading=!1;errorMessage="";reportTypes=[{label:"Daily Report",value:"daily"},{label:"Monthly Report",value:"monthly"}];months=[{label:"January",value:1},{label:"February",value:2},{label:"March",value:3},{label:"April",value:4},{label:"May",value:5},{label:"June",value:6},{label:"July",value:7},{label:"August",value:8},{label:"September",value:9},{label:"October",value:10},{label:"November",value:11},{label:"December",value:12}];years=[];ngOnInit(){}onReportTypeChange(){this.reportData=null,this.errorMessage=""}generateReport(){if(this.isLoading=!0,this.errorMessage="",this.reportData=null,this.reportType==="daily"){let t=this.formatDateToString(this.selectedDate);this.reportService.getDailyCalibrationReport(t).subscribe({next:e=>{this.reportData=e,this.isLoading=!1},error:e=>{this.errorMessage=e.error?.message||"Failed to generate daily calibration report",this.isLoading=!1,console.error("\u274C Error loading daily calibration report:",e)}})}else this.reportService.getMonthlyCalibrationReport(this.selectedMonth,this.selectedYear).subscribe({next:t=>{this.reportData=t,this.isLoading=!1},error:t=>{this.errorMessage=t.error?.message||"Failed to generate monthly calibration report",this.isLoading=!1,console.error("\u274C Error loading monthly calibration report:",t)}})}formatDateToString(t){let e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0");return`${e}-${n}-${i}`}formatDate(t){return new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}getMonthName(t){let e=this.months.find(n=>n.value===t);return e?e.label:"Unknown"}getResultSeverity(t){let e=t?.toLowerCase()||"";return e.includes("pass")||e.includes("success")||e.includes("calibrated")?"success":e.includes("fail")||e.includes("reject")?"danger":e.includes("pending")||e.includes("scheduled")?"warn":"secondary"}exportCSV(){if(!this.reportData||!this.reportData.records){console.warn("No data to export");return}let t="",e="";this.reportType==="daily"?(t=`Date,Equipment Name,Serial Number,Calibration Type,Result,Performed By,Remarks
`,t+=this.reportData.records.map(g=>`"${new Date(g.date).toISOString().split("T")[0]}","${g.equipmentName}","${g.serialNumber}","${g.calibrationType}","${g.result}","${g.performedBy}","${g.remarks}"`).join(`
`),e=`calibration-daily-${this.formatDateToString(this.selectedDate)}.csv`):(t=`Date,Equipment Name,Serial Number,Calibration Type,Result,Performed By,Next Calibration,Remarks
`,t+=this.reportData.records.map(g=>{let T=new Date(g.date).toISOString().split("T")[0],le=g.nextCalibrationDate?new Date(g.nextCalibrationDate).toISOString().split("T")[0]:"N/A";return`"${T}","${g.equipmentName}","${g.serialNumber}","${g.calibrationType}","${g.result}","${g.performedBy}","${le}","${g.remarks}"`}).join(`
`),e=`calibration-monthly-${this.selectedYear}-${this.selectedMonth}.csv`);let n=new Blob([t],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a"),s=URL.createObjectURL(n);i.setAttribute("href",s),i.setAttribute("download",e),i.click(),URL.revokeObjectURL(s)}static \u0275fac=function(e){return new(e||a)(w(tt))};static \u0275cmp=I({type:a,selectors:[["app-calibration-report"]],decls:22,vars:12,consts:[["start",""],["end",""],[1,"card"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-2xl","font-bold","mb-1"],[1,"text-muted-color"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","mb-4","p-4","bg-surface-50","dark:bg-surface-800","rounded"],[1,"flex","flex-col","gap-2"],["for","reportType",1,"font-semibold"],["optionLabel","label","optionValue","value","placeholder","Select report type",3,"ngModelChange","onChange","ngModel","options"],["class","flex flex-col gap-2",4,"ngIf"],[1,"flex","items-end"],["label","Generate Report","icon","pi pi-chart-bar",3,"onClick","disabled","loading"],["severity","error","styleClass","mb-4 w-full",3,"text",4,"ngIf"],["class","flex justify-center items-center py-8",4,"ngIf"],["class","mt-4",4,"ngIf"],["class","text-center py-8 text-muted-color",4,"ngIf"],["for","selectedDate",1,"font-semibold"],["inputId","selectedDate","placeholder","Select date","dateFormat","yy-mm-dd",3,"ngModelChange","ngModel"],["for","selectedMonth",1,"font-semibold"],["optionLabel","label","optionValue","value","placeholder","Select month",3,"ngModelChange","ngModel","options"],["for","selectedYear",1,"font-semibold"],["placeholder","Select year",3,"ngModelChange","ngModel","options"],["severity","error","styleClass","mb-4 w-full",3,"text"],[1,"flex","justify-center","items-center","py-8"],[1,"mt-4"],[1,"mb-4","p-4","bg-surface-100","dark:bg-surface-700","rounded"],[1,"text-xl","font-bold","mb-2"],["styleClass","mb-2"],[3,"value","rows","paginator","rowsPerPageOptions","tableStyle"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"font-semibold"],["label","Export CSV","icon","pi pi-upload","size","small",3,"onClick"],[3,"value","severity"],["colspan","7",1,"text-center","py-4"],["colspan","8",1,"text-center","py-4"],[1,"text-center","py-8","text-muted-color"],[1,"pi","pi-info-circle","text-4xl","mb-3"]],template:function(e,n){e&1&&(r(0,"div",2)(1,"div",3)(2,"div")(3,"h2",4),l(4,"Calibration Report"),o(),r(5,"p",5),l(6,"Generate daily or monthly calibration reports for equipment maintenance."),o()()(),r(7,"div",6)(8,"div",7)(9,"label",8),l(10,"Report Type"),o(),r(11,"p-select",9),S("ngModelChange",function(s){return v(n.reportType,s)||(n.reportType=s),s}),_("onChange",function(){return n.onReportTypeChange()}),o()(),b(12,$l,4,1,"div",10)(13,ql,4,2,"div",10)(14,Hl,4,2,"div",10),r(15,"div",11)(16,"p-button",12),_("onClick",function(){return n.generateReport()}),o()()(),b(17,zl,1,1,"p-message",13)(18,Yl,2,0,"div",14)(19,Zl,21,9,"div",15)(20,os,21,10,"div",15)(21,as,4,0,"div",16),o()),e&2&&(c(11),y("ngModel",n.reportType),u("options",n.reportTypes),c(),u("ngIf",n.reportType==="daily"),c(),u("ngIf",n.reportType==="monthly"),c(),u("ngIf",n.reportType==="monthly"),c(2),u("disabled",n.isLoading)("loading",n.isLoading),c(),u("ngIf",n.errorMessage),c(),u("ngIf",n.isLoading),c(),u("ngIf",n.reportData&&n.reportType==="daily"&&!n.isLoading),c(),u("ngIf",n.reportData&&n.reportType==="monthly"&&!n.isLoading),c(),u("ngIf",!n.reportData&&!n.isLoading&&!n.errorMessage))},dependencies:[P,Te,L,D,k,B,O,$,N,V,Ne,gt,R,U,Ge,ve,Ve,he,ye,A,yt,ot,ft,_t,z,mt],encapsulation:2})};function ls(a,t){a&1&&(r(0,"div",13),h(1,"i",14),r(2,"span",15),l(3,"Master Plan"),o()())}function ss(a,t){if(a&1&&(r(0,"option",23),l(1),o()),a&2){let e=t.$implicit;u("value",e),c(),f(e)}}function cs(a,t){if(a&1&&(r(0,"option",23),l(1),o()),a&2){let e=t.$implicit;u("value",e.laboratoryId),c(),f(e.laboratoryName)}}function ps(a,t){if(a&1&&(r(0,"option",23),l(1),o()),a&2){let e=t.$implicit;u("value",e),c(),f(e)}}function ms(a,t){if(a&1){let e=C();r(0,"div",16)(1,"div",13)(2,"label",17),l(3,"Year:"),o(),r(4,"select",18),S("ngModelChange",function(i){m(e);let s=p();return v(s.selectedYear,i)||(s.selectedYear=i),d(i)}),_("ngModelChange",function(){m(e);let i=p();return d(i.onFilterChange())}),r(5,"option",19),l(6,"All Years"),o(),b(7,ss,2,2,"option",20),o()(),r(8,"div",13)(9,"label",17),l(10,"Laboratory:"),o(),r(11,"select",18),S("ngModelChange",function(i){m(e);let s=p();return v(s.selectedLaboratory,i)||(s.selectedLaboratory=i),d(i)}),_("ngModelChange",function(){m(e);let i=p();return d(i.onFilterChange())}),r(12,"option",19),l(13,"Select Laboratory"),o(),b(14,cs,2,2,"option",20),o()(),r(15,"div",13)(16,"label",17),l(17,"Category:"),o(),r(18,"select",18),S("ngModelChange",function(i){m(e);let s=p();return v(s.selectedCategory,i)||(s.selectedCategory=i),d(i)}),_("ngModelChange",function(){m(e);let i=p();return d(i.onFilterChange())}),r(19,"option",19),l(20,"All Categories"),o(),b(21,ps,2,2,"option",20),o()(),r(22,"div",13),h(23,"p-button",21)(24,"p-button",22),o()()}if(a&2){let e=p();c(4),y("ngModel",e.selectedYear),c(3),u("ngForOf",e.years),c(4),y("ngModel",e.selectedLaboratory),c(3),u("ngForOf",e.laboratories),c(4),y("ngModel",e.selectedCategory),c(3),u("ngForOf",e.categories),c(2),u("outlined",!0),c(),u("outlined",!0)}}function ds(a,t){a&1&&(r(0,"span",31),l(1,"Yes"),o())}function us(a,t){a&1&&(r(0,"span",32),l(1,"No"),o())}function gs(a,t){a&1&&(r(0,"span",32),l(1,"Yes"),o())}function _s(a,t){a&1&&(r(0,"span",31),l(1,"No"),o())}function fs(a,t){if(a&1&&(r(0,"tr")(1,"td"),l(2),o(),r(3,"td",25),l(4),o(),r(5,"td"),l(6),o(),r(7,"td"),l(8),o(),r(9,"td"),l(10),o(),r(11,"td",26),l(12),o(),r(13,"td"),b(14,ds,2,0,"span",27)(15,us,2,0,"span",28),o(),r(16,"td"),b(17,gs,2,0,"span",28)(18,_s,2,0,"span",27),o(),r(19,"td",29)(20,"span",30),l(21),o()(),r(22,"td",29)(23,"span",30),l(24),o()(),r(25,"td",29)(26,"span",30),l(27),o()(),r(28,"td",29)(29,"span",30),l(30),o()()()),a&2){let e=t.$implicit,n=p(2);c(2),f((e.equipment==null?null:e.equipment.assetId)||"N/A"),c(2),f((e.equipment==null?null:e.equipment.equipmentName)||(e.equipment==null?null:e.equipment.assetName)||"N/A"),c(2),f(e.quantity||1),c(2),f(n.formatDate(e.equipment==null?null:e.equipment.dateAcquired)),c(2),f((e.equipment==null?null:e.equipment.location)||"N/A"),c(2),f(n.formatPrice(e.equipment==null?null:e.equipment.price)),c(2),u("ngIf",e.isFunctional!==!1),c(),u("ngIf",e.isFunctional===!1),c(2),u("ngIf",e.isUnderRepair),c(),u("ngIf",!e.isUnderRepair),c(3),f(n.getScheduleText(e,"inventory")),c(3),f(n.getScheduleText(e,"preventive")),c(3),f(n.getScheduleText(e,"corrective")),c(3),f(n.getScheduleText(e,"calibration"))}}function hs(a,t){if(a&1&&(An(0),b(1,fs,31,14,"tr",24),Un()),a&2){let e=p();c(),u("ngForOf",e.equipmentList)}}function bs(a,t){a&1&&(r(0,"tr")(1,"td",33)(2,"div",34),h(3,"i",35),r(4,"p"),l(5,"No data available. Please select Year and Laboratory to view the master plan."),o()()()())}var un=class a{constructor(t){this.http=t}selectedYear="";selectedLaboratory="";selectedCategory="";laboratories=[];years=[];categories=["Software","Hardware"];masterPlanData=null;equipmentList=[];currentYear=new Date().getFullYear();ngOnInit(){this.generateYears(),this.loadLaboratories()}generateYears(){let t=[];for(let e=this.currentYear;e>=this.currentYear-10;e--)t.push(e.toString());this.years=t}onFilterChange(){this.selectedYear&&this.selectedLaboratory?this.fetchMasterPlanData():console.warn("\u26A0\uFE0F Both year and laboratory must be selected to fetch data")}fetchMasterPlanData(){let t=`${re.apiUrl}/reports/master-plan/annual`,e={year:this.selectedYear,laboratoryId:this.selectedLaboratory};this.http.get(t,{params:e}).subscribe({next:n=>{console.table(n),this.masterPlanData=n;let i=n.equipmentMaintenances||[];this.selectedCategory?this.equipmentList=i.filter(s=>s.equipment?.category===this.selectedCategory):this.equipmentList=i},error:n=>{console.error("\u274C Error fetching Master Plan data:",n)}})}loadLaboratories(){let t=`${re.apiUrl}/laboratories`;this.http.get(t).subscribe({next:e=>{this.laboratories=e||[]},error:e=>{console.error("\u274C Error loading laboratories:",e)}})}formatDate(t){if(!t)return"N/A";try{return new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return"N/A"}}formatPrice(t){if(!t)return"N/A";let e=typeof t=="string"?parseFloat(t):t;return isNaN(e)?"N/A":"\u20B1"+e.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}getScheduleText(t,e){if(!t||!t.monthlyData)return"-";let n=[],i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return t.monthlyData.forEach(s=>{if(s.maintenance&&s.maintenance[e]==="X"){let g=s.month-1;g>=0&&g<12&&n.push(i[g])}}),n.length===0?"-":n.length>3?n.slice(0,3).join(", ")+"...":n.join(", ")}static \u0275fac=function(e){return new(e||a)(w(Ie))};static \u0275cmp=I({type:a,selectors:[["app-masterplan"]],decls:44,vars:2,consts:[["start",""],["end",""],["emptyState",""],["styleClass","mb-4"],[1,"master-plan-container"],[1,"master-plan-table-wrapper"],[1,"table-scroll"],[1,"master-plan-table"],["colspan","8",1,"particulars-header"],["colspan","4",1,"schedule-header"],[1,"particulars-header"],[1,"schedule-header"],[4,"ngIf","ngIfElse"],[1,"flex","items-center","gap-2"],[1,"pi","pi-calendar","text-2xl",2,"color","#667eea"],[1,"text-xl","font-bold"],[1,"flex","items-center","gap-4"],[1,"font-semibold"],[1,"p-inputtext",2,"padding","8px 12px","border","1px solid #ccc","border-radius","4px",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["label","Print","icon","pi pi-print","severity","secondary",3,"outlined"],["label","Export","icon","pi pi-upload","severity","success",3,"outlined"],[3,"value"],[4,"ngFor","ngForOf"],[2,"text-align","left","padding-left","16px"],[2,"color","#2f855a","font-weight","600"],["class","functional-badge",4,"ngIf"],["class","repair-badge",4,"ngIf"],[1,"schedule-cell"],[1,"schedule-mark"],[1,"functional-badge"],[1,"repair-badge"],["colspan","12"],[1,"empty-state"],[1,"pi","pi-inbox"]],template:function(e,n){if(e&1&&(r(0,"p-toolbar",3),b(1,ls,4,0,"ng-template",null,0,x)(3,ms,25,8,"ng-template",null,1,x),o(),r(5,"div",4)(6,"div",5)(7,"div",6)(8,"table",7)(9,"thead")(10,"tr")(11,"th",8),l(12,"PARTICULARS"),o(),r(13,"th",9),l(14,"MAINTENANCE SCHEDULE"),o()(),r(15,"tr")(16,"th",10),l(17,"ID Number"),o(),r(18,"th",10),l(19,"Asset Name"),o(),r(20,"th",10),l(21,"Quantity"),o(),r(22,"th",10),l(23,"Date Acquired"),o(),r(24,"th",10),l(25,"Location"),o(),r(26,"th",10),l(27,"Price"),o(),r(28,"th",10),l(29,"Functional"),o(),r(30,"th",10),l(31,"Under Repair"),o(),r(32,"th",11),l(33,"Inventory Schedule"),o(),r(34,"th",11),l(35,"Preventive Maintenance"),o(),r(36,"th",11),l(37,"Corrective Maintenance"),o(),r(38,"th",11),l(39,"Calibration Schedule"),o()()(),r(40,"tbody"),b(41,hs,2,1,"ng-container",12)(42,bs,6,0,"ng-template",null,2,x),o()()()()()),e&2){let i=Fn(43);c(41),u("ngIf",n.equipmentList.length>0)("ngIfElse",i)}},dependencies:[P,pt,Te,B,O,N,V,dt,R,A,L,Qn,Gn,Yn,D,k],styles:["[_nghost-%COMP%]     .master-plan-container{padding:1rem}[_nghost-%COMP%]     .master-plan-table-wrapper{background:var(--surface-card);border-radius:12px;box-shadow:0 2px 8px #0000001a;overflow:hidden}[_nghost-%COMP%]     .table-scroll{overflow-x:auto;overflow-y:auto;max-height:calc(100vh - 250px)}[_nghost-%COMP%]     .table-scroll::-webkit-scrollbar{height:10px;width:8px}[_nghost-%COMP%]     .table-scroll::-webkit-scrollbar-track{background:#f1f1f1;border-radius:10px}[_nghost-%COMP%]     .table-scroll::-webkit-scrollbar-thumb{background:#888;border-radius:10px}[_nghost-%COMP%]     .table-scroll::-webkit-scrollbar-thumb:hover{background:#555}[_nghost-%COMP%]     .master-plan-table{width:100%;min-width:1800px;border-collapse:collapse;background:#fff}[_nghost-%COMP%]     .master-plan-table th, [_nghost-%COMP%]     .master-plan-table td{border:1px solid #e0e0e0;padding:10px 8px;text-align:center;font-size:.85rem;white-space:nowrap}[_nghost-%COMP%]     .master-plan-table th{background:var(--primary-color);font-weight:600;color:#fff;position:sticky;top:0;z-index:10}[_nghost-%COMP%]     .master-plan-table th.particulars-header{background:#3b82f6}[_nghost-%COMP%]     .master-plan-table th.schedule-header{background:#10b981}[_nghost-%COMP%]     .master-plan-table tbody tr:hover{background:#f0f9ff}[_nghost-%COMP%]     .master-plan-table tbody tr:nth-child(2n){background:#fafafa}[_nghost-%COMP%]     .master-plan-table tbody tr:nth-child(2n):hover{background:#f0f9ff}[_nghost-%COMP%]     .functional-badge{background:#c6f6d5;color:#276749;padding:4px 12px;border-radius:12px;font-weight:600}[_nghost-%COMP%]     .repair-badge{background:#fed7d7;color:#c53030;padding:4px 12px;border-radius:12px;font-weight:600}[_nghost-%COMP%]     .schedule-cell{background:#fffbeb;cursor:pointer;transition:all .2s}[_nghost-%COMP%]     .schedule-cell:hover{background:#fef3c7;box-shadow:inset 0 0 0 2px #f59e0b}[_nghost-%COMP%]     .schedule-mark{color:#059669;font-weight:700}[_nghost-%COMP%]     .empty-state{text-align:center;padding:3rem;color:#6b7280}[_nghost-%COMP%]     .empty-state i{font-size:3rem;color:#d1d5db;margin-bottom:1rem}"]})};var Cs=[{path:"users",component:$t},{path:"campuses",component:qt},{path:"departments",component:Ht},{path:"assetcategory",children:pi},{path:"maintenance/services",component:Xt},{path:"maintenance/status",component:en},{path:"maintenance/priority-level",component:tn},{path:"maintenance/types",component:nn},{path:"documentation",component:ei},{path:"crud",component:ti},{path:"requestmaintenance",component:ni},{path:"labschedule",component:on},{path:"laboratories",component:It},{path:"laboratory/:id",component:It},{path:"masterplan",component:un},{path:"reports",component:cn},{path:"reports/preventive",component:pn},{path:"reports/corrective",component:mn},{path:"reports/calibration",component:dn},{path:"**",redirectTo:"/notfound"}],A0=Cs;export{A0 as default,Cs as pageRoutes};
